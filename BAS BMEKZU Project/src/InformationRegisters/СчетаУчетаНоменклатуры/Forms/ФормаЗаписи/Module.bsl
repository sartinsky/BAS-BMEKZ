////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Ключ.Пустой() Тогда
		
		Если ЗначениеЗаполнено(Запись.Склад) Тогда
			Запись.ТипСклада	= Запись.Склад.ТипСклада;
		КонецЕсли;
		
	КонецЕсли;
	
	ВидимостьАналитикиУслуги();
	
	УправлениеФормой(ЭтаФорма);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙФОРМЫ

&НаКлиенте
Процедура СкладПриИзменении(Элемент)

	Склад	= Запись.Склад;
	Запись.ТипСклада	= ОбщегоНазначенияБПВызовСервера.ЗначениеРеквизитаОбъекта(Запись.Склад, "ТипСклада");
	
	УправлениеФормой(ЭтаФорма);

КонецПроцедуры

&НаКлиенте
Процедура СчетУчетаУслугиПриИзменении(Элемент)

	ВидимостьАналитикиУслуги()

КонецПроцедуры

&НаКлиенте
Процедура СчетУчетаТовараПриИзменении(Элемент)

	ВидимостьАналитикиУслуги();

КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// СЛУЖЕБНЫЕ ПРОЦЕДУРЫ И ФУНКЦИИ

&НаКлиентеНаСервереБезКонтекста
Процедура УправлениеФормой(Форма)

	Элементы	= Форма.Элементы;
	Запись		= Форма.Запись;
	
	Элементы.ТипСклада.Доступность = НЕ ЗначениеЗаполнено(Запись.Склад);

КонецПроцедуры

&НаСервере
Процедура ВидимостьАналитикиУслуги()

	Если ЗначениеЗаполнено(Запись.СчетУчетаБУ) Тогда
		
		СвойстваСчета	= БухгалтерскийУчетВызовСервераПовтИсп.ПолучитьСвойстваСчета(Запись.СчетУчетаБУ);
		
		ЭтоУслуга	= НЕ СвойстваСчета.Количественный;
		
	Иначе
		ЭтоУслуга	= Ложь;
	КонецЕсли;
	
	Если ЭтоУслуга Тогда
		Элементы.ГруппаСтраницыТовараИУслуги.ТекущаяСтраница	= Элементы.ГруппаСтраницаУслуги;
		Элементы.ГруппаСтраницаУслуги.ПодчиненныеЭлементы.ГруппаПоляСчетСубконто.ПодчиненныеЭлементы.СчетУчетаУслуги.АктивизироватьПоУмолчанию = Истина;    
		УстановитьЗаголовкиИДоступностьСубконто();
	Иначе
		Элементы.ГруппаСтраницыТовараИУслуги.ТекущаяСтраница	= Элементы.ГруппаСтраницаТовара;
		Элементы.ГруппаСтраницаТовара.ПодчиненныеЭлементы.СчетУчетаТовара.АктивизироватьПоУмолчанию = Истина;
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Процедура УстановитьЗаголовкиИДоступностьСубконто()

	ПоляФормы		= Новый Структура("Субконто1, Субконто2, Субконто3",
		"Субконто1", "Субконто2", "Субконто3");
	
	ЗаголовкиПолей	= Новый Структура("Субконто1, Субконто2, Субконто3",
		"ЗаголовокСубконто1", "ЗаголовокСубконто2", "ЗаголовокСубконто3"); 
		
	БухгалтерскийУчетКлиентСервер.ПриВыбореСчета(Запись.СчетУчетаБУ, ЭтаФорма, ПоляФормы, ЗаголовкиПолей);

КонецПроцедуры
