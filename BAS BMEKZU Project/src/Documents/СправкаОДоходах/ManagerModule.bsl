
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

#Область ДляВызоваИзДругихПодсистем

// СтандартныеПодсистемы.ВерсионированиеОбъектов

// Определяет настройки объекта для подсистемы ВерсионированиеОбъектов.
//
// Параметры:
//  Настройки - Структура - настройки подсистемы.
Процедура ПриОпределенииНастроекВерсионированияОбъектов(Настройки) Экспорт

КонецПроцедуры

// Конец СтандартныеПодсистемы.ВерсионированиеОбъектов

// СтандартныеПодсистемы.УправлениеДоступом

// См. УправлениеДоступомПереопределяемый.ПриЗаполненииСписковСОграничениемДоступа.
Процедура ПриЗаполненииОграниченияДоступа(Ограничение) Экспорт

	Ограничение.Текст =
	"РазрешитьЧтениеИзменение
	|ГДЕ
	|	ЗначениеРазрешено(Организация)
	|	И ЗначениеРазрешено(ФизЛицо)";

КонецПроцедуры

// Конец СтандартныеПодсистемы.УправлениеДоступом

#КонецОбласти

#КонецОбласти

#Область ПроцедурыИФункцииПечати

// Заполняет список команд печати.
// 
// Параметры:
//   КомандыПечати - ТаблицаЗначений - состав полей см. в функции УправлениеПечатью.СоздатьКоллекциюКомандПечати
//
Процедура ДобавитьКомандыПечати(КомандыПечати) Экспорт
	
	// Список перечислений

	КомандаПечати = КомандыПечати.Добавить();
	КомандаПечати.Идентификатор = "СправкаОДоходах";
	КомандаПечати.Представление = НСтр("ru='Справка о доходах';uk='Довідка про доходи'");
	//КомандаПечати.Обработчик    = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечати";
	
	// Список перечислений в Microsoft Word
	КомандаПечати = КомандыПечати.Добавить();
	КомандаПечати.Идентификатор = "СправкаОДоходах";
	КомандаПечати.Представление = НСтр("ru='Справка о доходах (Microsoft Word)';uk='Довідка про доходи (Microsoft Word'");
	КомандаПечати.Картинка = БиблиотекаКартинок.ФорматWord2007;
	КомандаПечати.ФорматСохранения = ТипФайлаТабличногоДокумента.DOCX;;
	//КомандаПечати.Обработчик    = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечати";
	
	// Реестр документов
	КомандаПечати = КомандыПечати.Добавить();
	КомандаПечати.Идентификатор  = "Реестр";
	КомандаПечати.Представление  = НСтр("ru='Реестр документов';uk='Реєстр документів'");
	КомандаПечати.ЗаголовокФормы = НСтр("ru='Реестр документов ""Справка о доходах""';uk='Реєстр документів ""Довідка про доходи""'");
	КомандаПечати.Обработчик     = "УправлениеПечатьюБПКлиент.ВыполнитьКомандуПечатиРеестраДокументов";
	КомандаПечати.СписокФорм     = "ФормаСписка";
	КомандаПечати.Порядок        = 100;
	
КонецПроцедуры

Процедура Печать(МассивОбъектов, ПараметрыПечати, КоллекцияПечатныхФорм, ОбъектыПечати, ПараметрыВывода) Экспорт
	
	Если МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Произвольная Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетПроизвольная"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТПРОИЗВОЛЬНАЯ";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетПроизвольная") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетПроизвольная", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьПроизвольная(МассивОбъектов, ОбъектыПечати, ПараметрыВывода),,,,Истина);
		КонецЕсли;
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.ДоходыИНалоги Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетДоходыИНалоги"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТДОХОДЫИНАЛОГИ";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетДоходыИНалоги") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетДоходыИНалоги", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьДОходыИНалоги(МассивОбъектов, ОбъектыПечати, ПараметрыВывода),,,,Истина);
		КонецЕсли;
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Безработица Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетБезработица"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТБЕЗРАБОТИЦА";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетБезработица") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетБезработица", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьБезработица(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Пенсия Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетПенсия"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТПЕНСИЯ";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетПенсия") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетПенсия", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьПенсия(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Соцстрах Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетСоцстрах"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТСОЦСТРАХ";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетСоцстрах") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетСоцстрах", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьСоцстрах(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Субсидия Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетСубсидия"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТСУБСИДИЯ";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетСубсидия") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетСубсидия", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьСубсидия(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Субсидия2015 Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетСубсидия2015"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТСУБСИДИЯ2015";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетСубсидия2015") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетСубсидия2015", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьСубсидия2015(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;	
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Соцстрах2015 Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетСоцстрах2015"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТСОЦСТРАХ2015";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетСоцстрах2015") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетСоцстрах2015", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьСоцстрах2015(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;	
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Соцстрах2023 Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетСоцстрах2023"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТСОЦСТРАХ2023";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетСоцстрах2023") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетСоцстрах2023", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьСоцстрах2023(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;	
	ИначеЕсли МассивОбъектов[0].ВидСправки = Перечисления.ВидыСправокОДоходах.Пенсия2015 Тогда
		КоллекцияПечатныхФорм[0].ИмяМакета = "МакетПенсия2015"; 
		КоллекцияПечатныхФорм[0].ИмяВРЕГ = "МАКЕТПЕНСИЯ2015";
		Если УправлениеПечатью.НужноПечататьМакет(КоллекцияПечатныхФорм, "МакетПенсия2015") Тогда
			УправлениеПечатью.ВывестиТабличныйДокументВКоллекцию(КоллекцияПечатныхФорм, "МакетПенсия2015", НСтр("ru='Справка о доходах';uk='Довідка про доходи'"), ПечатьПенсия2015(МассивОбъектов, ОбъектыПечати, ПараметрыВывода));
		КонецЕсли;	
	КонецЕсли;
	
КонецПроцедуры

Функция ПечатьПроизвольная(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетПроизвольная";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_МакетПроизвольная");
	
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		НазначениеСправки = Ссылка.НазначениеСправки;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		СписокСотрудников = Новый СписокЗначений;
		СписокСотрудников.Добавить(Сотрудник);
		СтрокаКадровыеДанные = "ДатаПриема, ДатаУвольнения";
		ДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, СписокСотрудников, СтрокаКадровыеДанные, Дата);
		
		Если НЕ ДанныеСотрудника[0].ДатаУвольнения = Дата('00010101') Тогда
			Дата = ДанныеСотрудника[0].ДатаУвольнения;	
		КонецЕсли;	
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);

		ТекстЗапроса =
		"ВЫБРАТЬ
		|	МИНИМУМ(Доходы.Период) КАК НачалоПериодаДоходов,
		|	МАКСИМУМ(КОНЕЦПЕРИОДА(Доходы.Период,МЕСЯЦ)) КАК ОкончаниеПериодаДоходов
		|ИЗ
		|	Документ.СправкаОДоходах.Доходы КАК Доходы
		|ГДЕ
		|	Доходы.Ссылка = &Ссылка";
		
		ЗапросПериодДоходов = Новый Запрос(ТекстЗапроса);
		ЗапросПериодДоходов.УстановитьПараметр("Ссылка", Ссылка);
		
		РезультатПериодДоходов = ЗапросПериодДоходов.Выполнить().Выбрать();
		РезультатПериодДоходов.Следующий();
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
		
		Если Сотрудник.ФизическоеЛицо.Пол = Перечисления.ПолФизическогоЛица.Женский Тогда
			ОбластьМакетаШапка.Параметры.он                     =НСтр("ru='она';uk='вона'",КодЯзыкаПечать);
			ТекстРаботал = НСтр("ru='работала';uk='працювала'",КодЯзыкаПечать);
		Иначе
			ОбластьМакетаШапка.Параметры.он                     =НСтр("ru='он';uk='він'",КодЯзыкаПечать);
			ТекстРаботал = НСтр("ru='работал';uk='працював'",КодЯзыкаПечать);
		КонецЕсли;	
		
		ТекстДоговор = "";
		
		Если ДанныеСотрудника[0].ДатаУвольнения = Дата('00010101') Тогда
			ТекстРаботает = НСтр("ru='работает в ';uk='працює в '",КодЯзыкаПечать) + Организация.НаименованиеПолное +НСтр("ru=' с ';uk=' з '",КодЯзыкаПечать) +
			Формат(ДанныеСотрудника[0].ДатаПриема, "ДЛФ=Д")+НСтр("ru='г.';uk='р.'",КодЯзыкаПечать) + ТекстДоговор + НСтр("ru='. В настоящий момент занимает должность ';uk='. На даний момент займає посаду '",КодЯзыкаПечать) + ДанныеФизЛица.Должность;
		Иначе
			ТекстРаботает = ТекстРаботал + " в  "+Организация.НаименованиеПолное +НСтр("ru=' с ';uk=' з '",КодЯзыкаПечать) +
			Формат(ДанныеСотрудника[0].ДатаПриема, "ДЛФ=Д")+ НСтр("ru='г.';uk='р.'",КодЯзыкаПечать) + " по " + Формат(ДанныеСотрудника[0].ДатаУвольнения, "ДЛФ=Д")+ НСтр("ru='г.';uk='р.'",КодЯзыкаПечать)  + ТекстДоговор + НСтр("ru=' на должности ';uk=' на посаді '",КодЯзыкаПечать) + ДанныеФизЛица.Должность;
		КонецЕсли;
		ОбластьМакетаШапка.Параметры.Номер						= Номер;
		
		ОбластьМакетаШапка.Параметры.Дата						= Формат(Ссылка.Дата, "ДЛФ=Д");
		
		ОбластьМакетаШапка.Параметры.ИдентификационныйКод		= Сотрудник.ФизическоеЛицо.КодПоДРФО;
		ОбластьМакетаШапка.Параметры.ТекстРаботает				= ТекстРаботает;
		
		ОбластьМакетаШапка.Параметры.СуммаДоход	= Формат(Доходы.Итог("СовокупныйДоход"),	"ЧЦ=10; ЧДЦ=2");
		ОбластьМакетаШапка.Параметры.ДатаНач			= Формат(МАКС(ДанныеСотрудника[0].ДатаПриема, Ссылка.ДатаНач), "ДЛФ=Д");
		Если ДанныеСотрудника[0].ДатаУвольнения = Дата('00010101') Тогда
			ОбластьМакетаШапка.Параметры.ДатаКон			= Формат(Ссылка.ДатаКон, "ДЛФ=Д"); 
		Иначе
			ОбластьМакетаШапка.Параметры.ДатаКон			= Формат(?(НЕ ЗначениеЗаполнено(Формат(ДанныеСотрудника[0].ДатаУвольнения, "ДЛФ=Д")), Ссылка.ДатаКон, МИН(ДанныеСотрудника[0].ДатаУвольнения,Ссылка.ДатаКон)), "ДЛФ=Д");
		КонецЕсли;	
		
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("СтрокаПериод"); // строка периода
		Для Каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Заполнить(СтрокаТЧ);
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период, "Л="+КодЯзыкаПечать+"; ДФ='ММММ ` гггг'");
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;			
		
		ОбластьМакета = Макет.ПолучитьОбласть("СтрокаИтого");
		ОбластьМакета.Параметры.СовокупныйДоход	= Формат(Доходы.Итог("СовокупныйДоход"),	"ЧЦ=10; ЧДЦ=2");
		ОбластьМакета.Параметры.Удержания		= Формат(Доходы.Итог("Удержания"),			"ЧЦ=10; ЧДЦ=2");
		ОбластьМакета.Параметры.СуммаКВыплате	= Формат(Доходы.Итог("СуммаКВыплате"),		"ЧЦ=10; ЧДЦ=2");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		ОбластьМакета.Параметры.НазначениеСправки	= НазначениеСправки;
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.ГлавныйБухгалтер.Наименование);
		ОбластьМакета.Параметры.Директор			= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.Руководитель.Наименование);
		
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;

КонецФункции 	

Функция ПечатьДоходыИНалоги(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетДоходыИНалоги";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_МакетДоходыИНалоги");
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		НазначениеСправки = Ссылка.НазначениеСправки;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		СписокСотрудников = Новый СписокЗначений;
		СписокСотрудников.Добавить(Сотрудник);
		СтрокаКадровыеДанные = "ДатаПриема, ДатаУвольнения";
		ДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, СписокСотрудников, СтрокаКадровыеДанные, Дата);
		
		Если НЕ ДанныеСотрудника[0].ДатаУвольнения = Дата('00010101') Тогда
			Дата = ДанныеСотрудника[0].ДатаУвольнения;	
		КонецЕсли;	
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		ТекстЗапроса =
		"ВЫБРАТЬ
		|	МИНИМУМ(Доходы.Период) КАК НачалоПериодаДоходов,
		|	МАКСИМУМ(КОНЕЦПЕРИОДА(Доходы.Период,МЕСЯЦ)) КАК ОкончаниеПериодаДоходов
		|ИЗ
		|	Документ.СправкаОДоходах.Доходы КАК Доходы
		|ГДЕ
		|	Доходы.Ссылка = &Ссылка";
		
		ЗапросПериодДоходов = Новый Запрос(ТекстЗапроса);
		ЗапросПериодДоходов.УстановитьПараметр("Ссылка", Ссылка);
		
		РезультатПериодДоходов = ЗапросПериодДоходов.Выполнить().Выбрать();
		РезультатПериодДоходов.Следующий();
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
		
		Если  Сотрудник.ФизическоеЛицо.Пол = Перечисления.ПолФизическогоЛица.Женский Тогда
			ОбластьМакетаШапка.Параметры.он                     =НСтр("ru='она';uk='вона'",КодЯзыкаПечать);
			ТекстРаботал = НСтр("ru='работала';uk='працювала'",КодЯзыкаПечать);
		Иначе
			ОбластьМакетаШапка.Параметры.он                     =НСтр("ru='он';uk='він'",КодЯзыкаПечать);
			ТекстРаботал = НСтр("ru='работал';uk='працював'",КодЯзыкаПечать);
		КонецЕсли;	
		
		ТекстДоговор = "";
		
		Если ДанныеСотрудника[0].ДатаУвольнения = Дата('00010101') Тогда
			ТекстРаботает = НСтр("ru='работает в ';uk='працює в '",КодЯзыкаПечать) + Организация.НаименованиеПолное +НСтр("ru=' с ';uk=' з '",КодЯзыкаПечать) +
			Формат(ДанныеСотрудника[0].ДатаПриема, "ДЛФ=Д")+НСтр("ru='г.';uk='р.'",КодЯзыкаПечать) + ТекстДоговор + НСтр("ru='. В настоящий момент занимает должность ';uk='. На даний момент займає посаду '",КодЯзыкаПечать) + ДанныеФизЛица.Должность;
		Иначе
			ТекстРаботает = ТекстРаботал + " в  "+Организация.НаименованиеПолное +НСтр("ru=' с ';uk=' з '",КодЯзыкаПечать) +
			Формат(ДанныеСотрудника[0].ДатаПриема, "ДЛФ=Д")+ НСтр("ru='г.';uk='р.'",КодЯзыкаПечать) + " по " + Формат(ДанныеСотрудника[0].ДатаУвольнения, "ДЛФ=Д")+ НСтр("ru='г.';uk='р.'",КодЯзыкаПечать)  + ТекстДоговор + НСтр("ru=' на должности ';uk=' на посаді '",КодЯзыкаПечать) + ДанныеФизЛица.Должность;
		КонецЕсли;
		ОбластьМакетаШапка.Параметры.Номер						= Номер;
		
		ОбластьМакетаШапка.Параметры.Дата						= Формат(Ссылка.Дата, "ДЛФ=Д");
		
		ОбластьМакетаШапка.Параметры.ИдентификационныйКод		= Сотрудник.ФизическоеЛицо.КодПоДРФО;
		ОбластьМакетаШапка.Параметры.ТекстРаботает				= ТекстРаботает;
		
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("СтрокаПериод"); 
		
		Для Каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Заполнить(СтрокаТЧ);
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период, "Л="+КодЯзыкаПечать+"; ДФ='ММММ ` гггг'");
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;		
		
		
		ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
		ТаблицаДоходы = Доходы.Выгрузить();
		
		ОбластьМакета.Параметры.ДатаНач			= Формат(МАКС(ДанныеСотрудника[0].ДатаПриема,РезультатПериодДоходов.НачалоПериодаДоходов), "ДЛФ=Д");
		Если ДанныеСотрудника[0].ДатаУвольнения = Дата('00010101') Тогда
			ОбластьМакета.Параметры.ДатаКон			= Формат(РезультатПериодДоходов.ОкончаниеПериодаДоходов, "ДЛФ=Д"); 
		Иначе
			ОбластьМакета.Параметры.ДатаКон			= Формат(?(НЕ ЗначениеЗаполнено(Формат(ДанныеСотрудника[0].ДатаУвольнения, "ДЛФ=Д")),РезультатПериодДоходов.ОкончаниеПериодаДоходов,МИН(ДанныеСотрудника[0].ДатаУвольнения,РезультатПериодДоходов.ОкончаниеПериодаДоходов)), "ДЛФ=Д");
		КонецЕсли;	
		
		ОбластьМакета.Параметры.ДоходНДФЛИтог = ТаблицаДоходы.Итог("ДоходНДФЛ");
		ОбластьМакета.Параметры.НДФЛИтог = ТаблицаДоходы.Итог("НДФЛ");
		ОбластьМакета.Параметры.ВыплаченоИтог = ТаблицаДоходы.Итог("Выплачено");
		ОбластьМакета.Параметры.ДоходВоенныйСборИтог = ТаблицаДоходы.Итог("ДоходВоенныйСбор");
		ОбластьМакета.Параметры.ВоенныйСборИтог = ТаблицаДоходы.Итог("ВоенныйСбор");
		ОбластьМакета.Параметры.ДоходЗаВычетомНДФЛИтог = ТаблицаДоходы.Итог("ДоходЗаВычетомНДФЛ");

		
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		ОбластьМакета.Параметры.НазначениеСправки	= НазначениеСправки;
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.ГлавныйБухгалтер.Наименование);
		ОбластьМакета.Параметры.Директор			= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.Руководитель.Наименование);
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции // ПечатьПроизвольная	

Функция ПечатьБезработица(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетБезработица";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетБезработица");
	
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		НазначениеСправки = Ссылка.НазначениеСправки;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		СписокСотрудников = Новый СписокЗначений;
		СписокСотрудников.Добавить(Сотрудник);
		СтрокаКадровыеДанные = "ДатаПриема, ДатаУвольнения, ТекущийВидЗанятости";
		ДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, СписокСотрудников, СтрокаКадровыеДанные, Дата);
		
		Если НЕ ДанныеСотрудника[0].ДатаУвольнения = Дата('00010101') Тогда
			Дата = ДанныеСотрудника[0].ДатаУвольнения;	
		КонецЕсли;	
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
		ОбластьМакетаШапка.Параметры.Организация = Организация.НаименованиеПолное;
		
		СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация, Дата);
		Адрес = СведенияОбОрганизации.ЮридическийАдрес;
		Если ЗначениеЗаполнено(Адрес) Тогда
			ОбластьМакетаШапка.Параметры.Организация = ОбластьМакетаШапка.Параметры.Организация + ", "+Адрес;
		Конецесли;			
		
		ОбластьМакетаШапка.Параметры.Номер						= Номер;
		ОбластьМакетаШапка.Параметры.Дата						= Формат(Дата, "ДЛФ=Д");
		ОбластьМакетаШапка.Параметры.ДРФО		= Сотрудник.ФизическоеЛицо.КодПоДРФО;
		
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка"); // строка периода
		Для Каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период,	"ДФ=""ММММ ` гггг""; Л=""uk""");
			Если СтрокаТЧ.КалендарныеДни > 0 Тогда
				ОбластьМакета.Параметры.Месяц			= Формат(СтрокаТЧ.Период,	"ДФ=""ММММ""; Л=""uk""");
			Иначе
				ОбластьМакета.Параметры.Месяц			= "";
			КонецЕсли;	
			ОбластьМакета.Параметры.КалендарныеДни	= Строка(СтрокаТЧ.КалендарныеДни);
			ОбластьМакета.Параметры.ВсегоОблагаемое	= СтрокаТЧ.ВсегоОблагаемое;
			ОбластьМакета.Параметры.РезультатВсего	= СтрокаТЧ.РезультатВсего;
			ОбластьМакета.Параметры.РезультатВзносы	= СтрокаТЧ.РезультатВзносы;
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;			
		
		ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
		ОбластьМакета.Параметры.КалендарныеДни	= Доходы.Итог("КалендарныеДни");
		ОбластьМакета.Параметры.ВсегоОблагаемое	= Доходы.Итог("ВсегоОблагаемое");
		ОбластьМакета.Параметры.РезультатВсего	= Доходы.Итог("РезультатВсего");
		ОбластьМакета.Параметры.РезультатВзносы	= Доходы.Итог("РезультатВзносы");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		Если  Доходы.Итог("КалендарныеДни") <> 0 Тогда
			Результат1 = Доходы.Итог("РезультатВсего")/Доходы.Итог("КалендарныеДни");
			Результат2 = СтрокаТЧ.Предел/30.44;
			Если Результат2 = 0 Тогда
				Результат = Результат1;
			Иначе
				Результат = Мин(Результат1,Результат2);
			КонецЕсли;	
		Иначе
			Результат = 0;
		КонецЕсли;	
		
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		Если ДанныеСотрудника[0].ТекущийВидЗанятости = Перечисления.ВидыЗанятости.Совместительство Тогда
			ОбластьМакета.Параметры.ДатаУвольнения	= ДанныеСотрудника[0].ДатаУвольнения;
		КонецЕсли;
		
		ОбластьМакета.Параметры.Результат =  ОбщегоНазначенияБПВызовСервера.СформироватьСуммуПрописью(Результат, Константы.ВалютаРегламентированногоУчета.Получить(),"uk")+"  ( "+Формат(Цел(Результат),"ЧЦ=10; ЧДЦ=0; ЧН=0; ЧГ=")+" грн. "+Формат((Результат-Цел(Результат))*100,"ЧЦ=2; ЧДЦ=0; ЧН=00; ЧВН=")+" коп.)";
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ОтветственныеЛица.ГлавныйБухгалтер;
		ОбластьМакета.Параметры.Руководитель			= ОтветственныеЛица.Руководитель;
		ТабличныйДокумент.Вывести(ОбластьМакета);

		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;

КонецФункции 	

Функция ПечатьПенсия(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетПенсия";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетПенсия");
	
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
		Результат = Доходы.Итог("РезультатВсего");
		ОбластьМакетаШапка.Параметры.Результат	= ОбщегоНазначенияБПВызовСервера.СформироватьСуммуПрописью(Результат, Константы.ВалютаРегламентированногоУчета.Получить(), "uk");
		
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Таблица|ПерваяКолонка");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		Год = 0;
		Итог = 0;
		ОбластьКолонка = Макет.ПолучитьОбласть("Таблица|Колонка");
		ТЧДоходы = Доходы.Выгрузить();
		ТЧДоходы.Сортировать("Период");
		Для каждого СтрокаТЧ Из ТЧДоходы Цикл
			Если Год(СтрокаТЧ.Период) <> Год Тогда
				Если Год > 0 Тогда
					ОбластьКолонка.Параметры.Итог = Итог;
					ТабличныйДокумент.Присоединить(ОбластьКолонка);
				КонецЕсли;
				Год = Год(СтрокаТЧ.Период);
				Итог = 0;
				ОбластьКолонка = Макет.ПолучитьОбласть("Таблица|Колонка");
				ОбластьКолонка.Параметры.Год = Строка(Год)+" р.";
				ОбластьКолонка.Параметры.Январь = 0;
				ОбластьКолонка.Параметры.Февраль = 0;
				ОбластьКолонка.Параметры.Март = 0;
				ОбластьКолонка.Параметры.Апрель = 0;
				ОбластьКолонка.Параметры.Май = 0;
				ОбластьКолонка.Параметры.Июнь = 0;
				ОбластьКолонка.Параметры.Июль = 0;
				ОбластьКолонка.Параметры.Август = 0;
				ОбластьКолонка.Параметры.Сентябрь = 0;
				ОбластьКолонка.Параметры.Октябрь = 0;
				ОбластьКолонка.Параметры.Ноябрь = 0;
				ОбластьКолонка.Параметры.Декабрь = 0;
			КонецЕсли;	
			Если Месяц(СтрокаТЧ.Период) = 1 Тогда
				ОбластьКолонка.Параметры.Январь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 2 Тогда
				ОбластьКолонка.Параметры.Февраль = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 3 Тогда
				ОбластьКолонка.Параметры.Март = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 4 Тогда
				ОбластьКолонка.Параметры.Апрель = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 5 Тогда
				ОбластьКолонка.Параметры.Май = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 6 Тогда
				ОбластьКолонка.Параметры.Июнь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 7 Тогда
				ОбластьКолонка.Параметры.Июль = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 8 Тогда
				ОбластьКолонка.Параметры.Август = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 9 Тогда
				ОбластьКолонка.Параметры.Сентябрь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 10 Тогда
				ОбластьКолонка.Параметры.Октябрь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 11 Тогда
				ОбластьКолонка.Параметры.Ноябрь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 12 Тогда
				ОбластьКолонка.Параметры.Декабрь = СтрокаТЧ.РезультатВсего;
			КонецЕсли;	
			Итог = Итог + СтрокаТЧ.РезультатВсего;	
		КонецЦикла;
		
		ОбластьКолонка.Параметры.Итог = Итог;
		ТабличныйДокумент.Присоединить(ОбластьКолонка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ОтветственныеЛица.ГлавныйБухгалтер;
		ОбластьМакета.Параметры.Руководитель			= ОтветственныеЛица.Руководитель;
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции 	

Функция ПечатьСоцстрах(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетСоцстрах";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетСоцстрах");
	
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
	
		СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация, Дата);
		ОбластьМакетаШапка.Параметры.Организация = СведенияОбОрганизации.ПолноеНаименование;
	
		ОбластьМакетаШапка.Параметры.Номер			= Номер;
		ОбластьМакетаШапка.Параметры.Дата			= Формат(Дата, "ДЛФ=Д");
		ОбластьМакетаШапка.Параметры.ДРФО			= Сотрудник.ФизическоеЛицо.КодПоДРФО;
			
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		
		Для каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период,	"ДФ=""ММММ ` гггг""; Л=""uk""");
			ОбластьМакета.Параметры.ОтработаноДней	= СтрокаТЧ.ОтработаноДней;
			ОбластьМакета.Параметры.РезультатОсновное	= СтрокаТЧ.РезультатОсновное;
			ОбластьМакета.Параметры.РезультатСовместительство	= СтрокаТЧ.РезультатСовместительство;
			ОбластьМакета.Параметры.РезультатВсего	= СтрокаТЧ.РезультатВсего;
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;	
		
		ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
		ОбластьМакета.Параметры.ОтработаноДней	= Доходы.Итог("ОтработаноДней");
		ОбластьМакета.Параметры.РезультатОсновное	= Доходы.Итог("РезультатОсновное");
		ОбластьМакета.Параметры.РезультатСовместительство	= Доходы.Итог("РезультатСовместительство");
		ОбластьМакета.Параметры.РезультатВсего	= Доходы.Итог("РезультатВсего");
		ТабличныйДокумент.Вывести(ОбластьМакета);
	
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		Если  Доходы.Итог("ОтработаноДней") <> 0 Тогда
			Результат = Доходы.Итог("РезультатВсего")/Доходы.Итог("ОтработаноДней");
		Иначе
			Результат = 0;
		КонецЕсли;	
	
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ОтветственныеЛица.ГлавныйБухгалтер;
		ОбластьМакета.Параметры.Руководитель			= ОтветственныеЛица.Руководитель;
		ОбластьМакета.Параметры.Результат	= ОбщегоНазначенияБПВызовСервера.СформироватьСуммуПрописью(Результат, Константы.ВалютаРегламентированногоУчета.Получить(), "uk")+"  ( "+Формат(Цел(Результат),"ЧЦ=10; ЧДЦ=0; ЧН=0; ЧГ=")+" грн. "+Формат((Результат-Цел(Результат))*100,"ЧЦ=2; ЧДЦ=0; ЧН=00; ЧВН=")+" коп.)";

		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;

КонецФункции 	

Функция ПечатьСубсидия(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетСубсидия";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетСубсидия");
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		СписокСотрудников = Новый СписокЗначений;
		СписокСотрудников.Добавить(Сотрудник);
		СтрокаКадровыеДанные = "ТекущийВидЗанятости";
		ДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, СписокСотрудников, СтрокаКадровыеДанные, Дата);
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
		ОбластьМакетаШапка.Параметры.Должность = ДанныеФизЛица.Должность;
		Если ДанныеСотрудника[0].ТекущийВидЗанятости = Перечисления.ВидыЗанятости.ОсновноеМестоРаботы Тогда
			ОбластьМакетаШапка.Параметры.ВидЗанятости = "основне";
		Иначе
			ОбластьМакетаШапка.Параметры.ВидЗанятости = "за сумісництвом";
		КонецЕсли;	
		
		СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация, Дата);

		ОбластьМакетаШапка.Параметры.ФЛП = ?(Организация.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо,СведенияОбОрганизации.ПолноеНаименование,"");
		ОбластьМакетаШапка.Параметры.Организация = ?(Организация.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо,СведенияОбОрганизации.ПолноеНаименование,"");
		ОбластьМакетаШапка.Параметры.Организация_ФЛП = СведенияОбОрганизации.ПолноеНаименование;
		ОбластьМакетаШапка.Параметры.Адрес = СведенияОбОрганизации.ЮридическийАдрес;
		ОбластьМакетаШапка.Параметры.Телефон = СведенияОбОрганизации.Телефоны;
		ОбластьМакетаШапка.Параметры.ЕДРПОУ = ?(Организация.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо,СведенияОбОрганизации.КодПоЕДРПОУ,СведенияОбОрганизации.КодПоДРФО);
		
		ОбластьМакетаШапка.Параметры.ДРФО			= Сотрудник.ФизическоеЛицо.КодПоДРФО;
				
		Срез = РегистрыСведений.КодыОрганизации.СрезПоследних(Дата, НОВЫЙ Структура("Организация",Организация));
		Если Срез.Количество() > 0 тогда
			ОбластьМакетаШапка.Параметры.ГНА = Срез[0].НалоговаяИнспекция;
		КонецЕсли;	
			
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		Для каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Заполнить(СтрокаТЧ);
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период,	"ДФ=""ММММ ` гггг""; Л=""uk""");
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;		
		
		//Итоги
		ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
		ОбластьМакета.Параметры.НачисленоЗП	= Доходы.Итог("НачисленоЗП");
		ОбластьМакета.Параметры.НачисленоПрочее	= Доходы.Итог("НачисленоПрочее");
		ОбластьМакета.Параметры.Алименты	= Доходы.Итог("Алименты");
	    ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		Результат = Доходы.Итог("НачисленоЗП")+Доходы.Итог("НачисленоПрочее")-Доходы.Итог("Алименты");
		ОбластьМакета.Параметры.ПериодС = Формат(Доходы[0].Период,	"ДФ=""ММММ гггг""; Л=""uk""");
		ОбластьМакета.Параметры.ПериодПо = Формат(СтрокаТЧ.Период,	"ДФ=""ММММ гггг""; Л=""uk""");
		ОбластьМакета.Параметры.ДолжностьРуководителя	= ОтветственныеЛица.РуководительДолжность;
		ОбластьМакета.Параметры.Дата	= Дата;
		ОбластьМакета.Параметры.Номер	= Номер;
		ОбластьМакета.Параметры.Результат	= ОбщегоНазначенияБПВызовСервера.СформироватьСуммуПрописью(Результат, Константы.ВалютаРегламентированногоУчета.Получить(), "uk");
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ОтветственныеЛица.ГлавныйБухгалтер;
		ОбластьМакета.Параметры.Руководитель			= ОтветственныеЛица.Руководитель;

		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;

КонецФункции 	

Функция ПечатьСубсидия2015(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетСубсидия2015";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетСубсидия2015");
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		СписокСотрудников = Новый СписокЗначений;
		СписокСотрудников.Добавить(Сотрудник);
		СтрокаКадровыеДанные = "ТекущийВидЗанятости";
		ДанныеСотрудника = КадровыйУчет.КадровыеДанныеСотрудников(Истина, СписокСотрудников, СтрокаКадровыеДанные, Дата);
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
		ОбластьМакетаШапка.Параметры.Должность = ДанныеФизЛица.Должность;
		Если ДанныеСотрудника[0].ТекущийВидЗанятости = Перечисления.ВидыЗанятости.ОсновноеМестоРаботы Тогда
			ОбластьМакетаШапка.Параметры.ВидЗанятости = "основне";
		Иначе
			ОбластьМакетаШапка.Параметры.ВидЗанятости = "за сумісництвом";
		КонецЕсли;	
		
		СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация, Дата);

		ОбластьМакетаШапка.Параметры.ФЛП = ?(Организация.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо,СведенияОбОрганизации.ПолноеНаименование,"");
		ОбластьМакетаШапка.Параметры.Организация = ?(Организация.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо,СведенияОбОрганизации.ПолноеНаименование,"");
		ОбластьМакетаШапка.Параметры.Организация_ФЛП = СведенияОбОрганизации.ПолноеНаименование;
		ОбластьМакетаШапка.Параметры.Адрес = СведенияОбОрганизации.ЮридическийАдрес;
		ОбластьМакетаШапка.Параметры.Телефон = СведенияОбОрганизации.Телефоны;
		ОбластьМакетаШапка.Параметры.ЕДРПОУ = ?(Организация.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо,СведенияОбОрганизации.КодПоЕДРПОУ,СведенияОбОрганизации.КодПоДРФО);
		
		ОбластьМакетаШапка.Параметры.ДРФО			= Сотрудник.ФизическоеЛицо.КодПоДРФО;
			
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		Для каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Заполнить(СтрокаТЧ);
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период,	"ДФ=""ММММ ` гггг""; Л=""uk""");
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;		
		
		//Итоги
		ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
		ОбластьМакета.Параметры.НачисленоЗП	= Доходы.Итог("НачисленоЗП");
		ОбластьМакета.Параметры.НачисленоПрочее	= Доходы.Итог("НачисленоПрочее");
		ОбластьМакета.Параметры.Алименты	= Доходы.Итог("Алименты");
		ОбластьМакета.Параметры.НДФЛ	= Доходы.Итог("НДФЛ");
		ОбластьМакета.Параметры.НДФЛПрочее	= Доходы.Итог("НДФЛПрочее");
	    ТабличныйДокумент.Вывести(ОбластьМакета);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		Результат = Доходы.Итог("НачисленоЗП")+Доходы.Итог("НачисленоПрочее")-Доходы.Итог("Алименты")-Доходы.Итог("НДФЛ")-Доходы.Итог("НДФЛПрочее");
		ОбластьМакета.Параметры.ПериодС = Формат(Доходы[0].Период,	"ДФ=""ММММ гггг""; Л=""uk""");
		ОбластьМакета.Параметры.ПериодПо = Формат(СтрокаТЧ.Период,	"ДФ=""ММММ гггг""; Л=""uk""");
		ОбластьМакета.Параметры.ДолжностьРуководителя	= ОтветственныеЛица.РуководительДолжность;
		ОбластьМакета.Параметры.Дата	= Дата;
		ОбластьМакета.Параметры.Номер	= Номер;
		ОбластьМакета.Параметры.Результат	= ОбщегоНазначенияБПВызовСервера.СформироватьСуммуПрописью(Результат, Константы.ВалютаРегламентированногоУчета.Получить(), "uk");
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.ГлавныйБухгалтер.Наименование);
		ОбластьМакета.Параметры.Руководитель		= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.Руководитель.Наименование);


		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;

КонецФункции 	

Функция ПечатьСоцстрах2015(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетСоцстрах2015";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетСоцстрах2015");
	
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
	
		СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация, Дата);
		ОбластьМакетаШапка.Параметры.Организация = СведенияОбОрганизации.ПолноеНаименование;
	
		ОбластьМакетаШапка.Параметры.Номер			= Номер;
		ОбластьМакетаШапка.Параметры.Дата			= Формат(Дата, "ДЛФ=Д");
		ОбластьМакетаШапка.Параметры.ДРФО			= Сотрудник.ФизическоеЛицо.КодПоДРФО;
			
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		
		Для каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период,	"ДФ=""ММММ ` гггг""; Л=""uk""");
			ОбластьМакета.Параметры.КалендарныеДни	= СтрокаТЧ.КалендарныеДни;
			ОбластьМакета.Параметры.РезультатВсего	= СтрокаТЧ.РезультатВсего;
			ОбластьМакета.Параметры.РезультатВзносы	= СтрокаТЧ.РезультатВзносы;
			ОбластьМакета.Параметры.СтавкаВзносов	= СтрокаТЧ.СтавкаВзносов;
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;	
		
		ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
		ОбластьМакета.Параметры.КалендарныеДни	= Доходы.Итог("КалендарныеДни");
		ОбластьМакета.Параметры.РезультатВсего	= Доходы.Итог("РезультатВсего");
		ОбластьМакета.Параметры.РезультатВзносы	= Доходы.Итог("РезультатВзносы");
		ТабличныйДокумент.Вывести(ОбластьМакета);
	
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
	
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.ГлавныйБухгалтер.Наименование);
		ОбластьМакета.Параметры.Руководитель		= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.Руководитель.Наименование);

		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;

КонецФункции 	

Функция ПечатьСоцстрах2023(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетСоцстрах2023";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетСоцстрах2023");
	
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
	
		СведенияОбОрганизации = БухгалтерскийУчетПереопределяемый.СведенияОЮрФизЛице(Организация, Дата);
		ОбластьМакетаШапка.Параметры.Организация = СведенияОбОрганизации.ПолноеНаименование;
	
		ОбластьМакетаШапка.Параметры.Номер			= Номер;
		ОбластьМакетаШапка.Параметры.Дата			= Формат(Дата, "ДЛФ=Д");
		ОбластьМакетаШапка.Параметры.ДРФО			= Сотрудник.ФизическоеЛицо.КодПоДРФО;
			
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Строка");
		
		Для каждого СтрокаТЧ Из Доходы Цикл
			ОбластьМакета.Параметры.Период			= Формат(СтрокаТЧ.Период,	"ДФ=""ММММ ` гггг""; Л=""uk""");
			ОбластьМакета.Параметры.КалендарныеДни	= СтрокаТЧ.КалендарныеДни;
			ОбластьМакета.Параметры.РезультатВсего	= СтрокаТЧ.РезультатВсего;
			ОбластьМакета.Параметры.РезультатВзносы	= СтрокаТЧ.РезультатВзносы;
			ОбластьМакета.Параметры.СтавкаВзносов	= СтрокаТЧ.СтавкаВзносов;
			ТабличныйДокумент.Вывести(ОбластьМакета);
		КонецЦикла;	
		
		ОбластьМакета = Макет.ПолучитьОбласть("Итоги");
		ОбластьМакета.Параметры.КалендарныеДни	= Доходы.Итог("КалендарныеДни");
		ОбластьМакета.Параметры.РезультатВсего	= Доходы.Итог("РезультатВсего");
		ОбластьМакета.Параметры.РезультатВзносы	= Доходы.Итог("РезультатВзносы");
		ТабличныйДокумент.Вывести(ОбластьМакета);
	
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
	
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.ГлавныйБухгалтер.Наименование);
		ОбластьМакета.Параметры.Руководитель		= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.Руководитель.Наименование);

		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;

КонецФункции 	

Функция ПечатьПенсия2015(МассивОбъектов, ОбъектыПечати, ПараметрыВывода)
	
	ТабличныйДокумент = Новый ТабличныйДокумент;   
	ТабличныйДокумент.ИмяПараметровПечати = "ПАРАМЕТРЫ_ПЕЧАТИ_СправкаОДоходах_МакетПенсия2015";
	
	Макет = УправлениеПечатью.МакетПечатнойФормы("Документ.СправкаОДоходах.ПФ_MXL_UK_МакетПенсия2015");
	
	
	Для Каждого Ссылка Из МассивОбъектов Цикл
		
		Организация = Ссылка.Организация;
		Сотрудник = Ссылка.Сотрудник;
		Дата = Ссылка.Дата;
		Номер = Ссылка.Номер;
		Доходы = Ссылка.Доходы;
		
		ТабличныйДокумент.ОриентацияСтраницы = ОриентацияСтраницы.Портрет;
		// Запомним номер строки, с которой начали выводить текущий документ.
		НомерСтрокиНачало = ТабличныйДокумент.ВысотаТаблицы + 1;
		
		ДанныеФизЛица = ОбщегоНазначенияБПВызовСервера.ДанныеФизЛица(Организация, Сотрудник.ФизическоеЛицо, Дата);
		ОтветственныеЛица = ОтветственныеЛицаБП.ОтветственныеЛица(Организация, Дата);
		
		КодЯзыкаПечать = ПараметрыВывода.КодЯзыкаДляМногоязычныхПечатныхФорм;
		Макет.КодЯзыкаМакета = КодЯзыкаПечать;
		
		ОбластьМакетаШапка = Макет.ПолучитьОбласть("Шапка");
		ОбластьМакетаШапка.Параметры.Физлицо = ДанныеФизЛица.Фамилия +" "+ДанныеФизЛица.Имя+" "+ДанныеФизЛица.Отчество;
		Результат = Доходы.Итог("РезультатВсего");
		ОбластьМакетаШапка.Параметры.Результат	= ОбщегоНазначенияБПВызовСервера.СформироватьСуммуПрописью(Результат, Константы.ВалютаРегламентированногоУчета.Получить(), "uk");
		
		ТабличныйДокумент.Вывести(ОбластьМакетаШапка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Таблица|ПерваяКолонка");
		ТабличныйДокумент.Вывести(ОбластьМакета);
		Год = 0;
		Итог = 0;
		ОбластьКолонка = Макет.ПолучитьОбласть("Таблица|Колонка");
		ТЧДоходы = Доходы.Выгрузить();
		ТЧДоходы.Сортировать("Период");
		Для каждого СтрокаТЧ Из ТЧДоходы Цикл
			Если Год(СтрокаТЧ.Период) <> Год Тогда
				Если Год > 0 Тогда
					ОбластьКолонка.Параметры.Итог = Итог;
					ТабличныйДокумент.Присоединить(ОбластьКолонка);
				КонецЕсли;
				Год = Год(СтрокаТЧ.Период);
				Итог = 0;
				ОбластьКолонка = Макет.ПолучитьОбласть("Таблица|Колонка");
				ОбластьКолонка.Параметры.Год = Строка(Год)+" р.";
				ОбластьКолонка.Параметры.Январь = 0;
				ОбластьКолонка.Параметры.Февраль = 0;
				ОбластьКолонка.Параметры.Март = 0;
				ОбластьКолонка.Параметры.Апрель = 0;
				ОбластьКолонка.Параметры.Май = 0;
				ОбластьКолонка.Параметры.Июнь = 0;
				ОбластьКолонка.Параметры.Июль = 0;
				ОбластьКолонка.Параметры.Август = 0;
				ОбластьКолонка.Параметры.Сентябрь = 0;
				ОбластьКолонка.Параметры.Октябрь = 0;
				ОбластьКолонка.Параметры.Ноябрь = 0;
				ОбластьКолонка.Параметры.Декабрь = 0;
			КонецЕсли;	
			Если Месяц(СтрокаТЧ.Период) = 1 Тогда
				ОбластьКолонка.Параметры.Январь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 2 Тогда
				ОбластьКолонка.Параметры.Февраль = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 3 Тогда
				ОбластьКолонка.Параметры.Март = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 4 Тогда
				ОбластьКолонка.Параметры.Апрель = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 5 Тогда
				ОбластьКолонка.Параметры.Май = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 6 Тогда
				ОбластьКолонка.Параметры.Июнь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 7 Тогда
				ОбластьКолонка.Параметры.Июль = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 8 Тогда
				ОбластьКолонка.Параметры.Август = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 9 Тогда
				ОбластьКолонка.Параметры.Сентябрь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 10 Тогда
				ОбластьКолонка.Параметры.Октябрь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 11 Тогда
				ОбластьКолонка.Параметры.Ноябрь = СтрокаТЧ.РезультатВсего;
			ИначеЕсли Месяц(СтрокаТЧ.Период) = 12 Тогда
				ОбластьКолонка.Параметры.Декабрь = СтрокаТЧ.РезультатВсего;
			КонецЕсли;	
			Итог = Итог + СтрокаТЧ.РезультатВсего;	
		КонецЦикла;
		
		ОбластьКолонка.Параметры.Итог = Итог;
		ТабличныйДокумент.Присоединить(ОбластьКолонка);
		
		ОбластьМакета = Макет.ПолучитьОбласть("Дно");
		
		ОбластьМакета.Параметры.ГлавныйБухгалтер	= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.ГлавныйБухгалтер.Наименование);
		ОбластьМакета.Параметры.Руководитель		= ФизическиеЛицаКлиентСервер.ИмяФамилияВФорматеДСТУ(ОтветственныеЛица.Руководитель.Наименование);
		ТабличныйДокумент.Вывести(ОбластьМакета);
		
		// В табличном документе зададим имя области, в которую был 
		// выведен объект. Нужно для возможности печати покомплектно.
		УправлениеПечатью.ЗадатьОбластьПечатиДокумента(ТабличныйДокумент, 
			НомерСтрокиНачало, ОбъектыПечати, Ссылка);
		
	КонецЦикла;
	
	Возврат ТабличныйДокумент;
	
КонецФункции 	

#КонецОбласти

#КонецЕсли