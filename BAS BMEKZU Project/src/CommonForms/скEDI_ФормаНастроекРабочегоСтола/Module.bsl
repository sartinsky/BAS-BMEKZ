
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	СписокСкорректированный.Очистить();
	ПолеКолонок = Неопределено;
	Если НЕ Параметры.Свойство("ТабНастройкиКолонок", ПолеКолонок) Тогда
		Отказ = Истина;
		Возврат;		
	КонецЕсли;
	лЖурналРабочегоСтола = Неопределено;
	Если Параметры.Свойство("ЖурналРабочегоСтола", лЖурналРабочегоСтола) Тогда
		ЖурналРабочегоСтола = лЖурналРабочегоСтола;
	КонецЕсли;
	
	ЭлементыДеревоКолонок = ДеревоКолонок.ПолучитьЭлементы();
	ЭлементыДеревоКолонок.Очистить();
	
	СоответствиеУзлов = Новый Соответствие;
	Для каждого Стр из ПолеКолонок Цикл
		Если Стр.НомерТаб = 100 Тогда
			Нов = СписокСкорректированный.Добавить();
			Нов.Родитель = Стр.Родитель;
			Нов.КолонкаПолная = Стр.КолонкаПолная;
			Нов.ИмяКолонки = Стр.ИмяКолонки;
			Нов.Видимость = Стр.Видимость;
			Нов.НомерТаб = Стр.НомерТаб;
			Продолжить;
		ИначеЕсли Стр.НомерТаб % 100 = 0 Тогда
			НовыйУзел = ЭлементыДеревоКолонок.Добавить();
			НовыйУзел.Родитель = Стр.Родитель;
			НовыйУзел.КолонкаПолная = Стр.КолонкаПолная;
			НовыйУзел.ИмяКолонки = Стр.ИмяКолонки;
			НовыйУзел.Видимость = Стр.Видимость;
			НовыйУзел.НомерТаб = Стр.НомерТаб;
			СоответствиеУзлов.Вставить(Стр.ИмяКолонки, НовыйУзел);
		КонецЕсли;
	КонецЦикла;
	
	Для каждого Стр из ПолеКолонок Цикл
		Если Стр.НомерТаб % 100 > 0 Тогда
			Узел = СоответствиеУзлов.Получить(Стр.Родитель);
			Если Узел <> Неопределено Тогда
				НовыйУзел = Узел.ПолучитьЭлементы().Добавить();
				НовыйУзел.Родитель = Стр.Родитель;
				НовыйУзел.КолонкаПолная = Стр.КолонкаПолная;
				НовыйУзел.ИмяКолонки = Стр.ИмяКолонки;
				НовыйУзел.Видимость = Стр.Видимость;
				НовыйУзел.НомерТаб = Стр.НомерТаб;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры

&НаКлиенте
Процедура Применить(Команда)
	н = 200;
	ЭлементыДеревоКолонок = ДеревоКолонок.ПолучитьЭлементы();
	Для Каждого ЭлементДереваКолонок из ЭлементыДеревоКолонок Цикл
		нн = н;
		
		Нов = СписокСкорректированный.Добавить();
		Нов.Родитель = ЭлементДереваКолонок.Родитель;
		Нов.КолонкаПолная = ЭлементДереваКолонок.КолонкаПолная;
		Нов.ИмяКолонки = ЭлементДереваКолонок.ИмяКолонки;
		Нов.Видимость = ЭлементДереваКолонок.Видимость;
		Нов.НомерТаб = нн;
		
		ЭлементыДеревоКолонок1 = ЭлементДереваКолонок.ПолучитьЭлементы();
		Для Каждого ЭлементДереваКолонок1 из ЭлементыДеревоКолонок1 Цикл
			нн = нн + 1;
			Нов = СписокСкорректированный.Добавить();
			Нов.Родитель = ЭлементДереваКолонок1.Родитель;
			Нов.КолонкаПолная = ЭлементДереваКолонок1.КолонкаПолная;
			Нов.ИмяКолонки = ЭлементДереваКолонок1.ИмяКолонки;
			Нов.Видимость = ЭлементДереваКолонок1.Видимость;
			Нов.НомерТаб = нн;
		КонецЦикла;
		
		н = н + 100;
	КонецЦикла;
	
	СтруктураНастройки = Новый Структура;
	СтруктураНастройки.Вставить("Действие", "УстановитьСписокКолонок");
	СтруктураНастройки.Вставить("СписокКолонок",  СписокСкорректированный);
	СтруктураНастройки.Вставить("ЖурналРабочегоСтола", ЖурналРабочегоСтола);
	Закрыть(СтруктураНастройки);
КонецПроцедуры

&НаКлиенте
Процедура УстановитьСтандартные(Команда)
	СтруктураНастройки = Новый Структура;
	СтруктураНастройки.Вставить("Действие", "УстановитьСтандартныеНастройки");
	СтруктураНастройки.Вставить("ЖурналРабочегоСтола", ЖурналРабочегоСтола);
	Закрыть(СтруктураНастройки);
КонецПроцедуры


