
#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	Настройки = КомпоновщикНастроек.ПолучитьНастройки(); 
		
	ПериодОтчета = Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета");
	Если НЕ ПериодОтчета.Использование Тогда
		Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Значение.ДатаНачала = '00010101';
		Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Значение.ДатаОкончания = '39991231235959';
		Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Использование = Истина;
	ИначеЕсли Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Значение.ДатаОкончания = '00010101' Тогда
		Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Значение.ДатаОкончания = '39991231235959';
	КонецЕсли; 	
		
	МакетКомпоновкиДанных = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки, ДанныеРасшифровки);
	ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновкиДанных, ,ДанныеРасшифровки, Истина);
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных, Истина);
	
	Если Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Значение.ДатаНачала = '00010101' И Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Значение.ДатаОкончания = '39991231235959' Тогда
		ПериодНайден = Ложь;
		Для индСтр=1 По ДокументРезультат.ВысотаТаблицы Цикл
			Для индКол=1 По ДокументРезультат.ШиринаТаблицы  Цикл		
				Если СокрЛП(ДокументРезультат.Область(индСтр, индКол).Текст) = "- 31.12.3999" Тогда			
					ДокументРезультат.Область(индСтр, индКол, индСтр, индКол).Текст = "";
					ПериодНайден = Истина;
					Прервать;			
				КонецЕсли;
			КонецЦикла;
			
			Если ПериодНайден Тогда
				Прервать;	
			КонецЕсли; 
		КонецЦикла;	

	ИначеЕсли Настройки.ПараметрыДанных.Элементы.Найти("ПериодОтчета").Значение.ДатаОкончания = '39991231235959' Тогда
		ПериодНайден = Ложь;
		Для индСтр=1 По ДокументРезультат.ВысотаТаблицы Цикл
			Для индКол=1 По ДокументРезультат.ШиринаТаблицы  Цикл
				ЗначениеЯчейки = СокрЛП(ДокументРезультат.Область(индСтр, индКол).Текст); 

				Если Прав(ЗначениеЯчейки,10) = "31.12.3999" Тогда	
					
					ДокументРезультат.Область(индСтр, индКол, индСтр, индКол).Текст = Лев(ЗначениеЯчейки,СтрДлина(ЗначениеЯчейки) - 10);
					ПериодНайден = Истина;
					Прервать;			
				КонецЕсли;
			КонецЦикла;
			
			Если ПериодНайден Тогда
				Прервать;	
			КонецЕсли; 
		КонецЦикла;	
	КонецЕсли;

КонецПроцедуры

#КонецОбласти

#КонецЕсли
