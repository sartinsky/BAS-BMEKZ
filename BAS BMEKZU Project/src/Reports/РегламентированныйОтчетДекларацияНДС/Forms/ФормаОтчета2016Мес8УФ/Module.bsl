&НаСервере
Перем мБухИтоги;
&НаСервере
Перем ТаблицаРасшифровки;
&НаСервере
Перем ОбщиеПараметрыРасшифровки;

&НаСервере
Перем мОбъектОтчета;

&НаСервере
Перем R11GA, R11GB;
&НаСервере
Перем R12GA, R12GB;
&НаСервере
Перем R41GA, R41GB, R42GA, R42GB;
&НаСервере
Перем R001G4, R001G5, R001G6;
&НаСервере
Перем R011G4, R011G5, R011G6;
&НаСервере
Перем R101GA, R101GB;
&НаСервере
Перем R102GA, R102GB;
&НаСервере
Перем R103GA;
&НаСервере
Перем R021G4, R021G5;
&НаСервере
Перем R111GA, R111GB;
&НаСервере
Перем R112GA, R112GB;
&НаСервере
Перем R1021GA, R1022GA;
&НаСервере
Перем R141GA;
&НаСервере
Перем R152GA;
&НаСервере
Перем R151GA, R151GB;
&НаСервере
Перем ТаблицаРезультатов, ИмяКолонкиНО, ИмяКолонкиНК;

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	СформироватьСтруктуруРеквизитовФормы();
	
	СтруктураРеквизитовФормы.СписокПечатаемыхЛистов = Новый СписокЗначений;
		
	СтруктураРеквизитовФормы.мСоставПоказателей = "СоставПоказателей2016Мес8УФ";
	
	СоответствиеЕдиницыИзмеренияДелителю = Новый Структура;
	СоответствиеЕдиницыИзмеренияДелителю.Вставить("Окр1", 1);
	СоответствиеЕдиницыИзмеренияДелителю.Вставить("Окр1000", 1000);
	СоответствиеЕдиницыИзмеренияДелителю.Вставить("Окр1000000", 1000000);
		
	СтруктураРеквизитовФормы.мОписаниеТиповЧислоЕ = Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(15, 2));
	
	// Идентификаторы многострочных групп
	СтруктураРеквизитовФормы.мИдГруппы      = "ДT1R";
	СтруктураРеквизитовФормы.мИдГруппы_2    = "ДT2R";
	СтруктураРеквизитовФормы.мИдГруппы1     = "T1R";
	СтруктураРеквизитовФормы.мИдГруппы2     = "T2R";
	СтруктураРеквизитовФормы.мИдГруппы21    = "П2T1R";
	СтруктураРеквизитовФормы.мИдГруппы31    = "П3T1R";
	СтруктураРеквизитовФормы.мИдГруппы41    = "П4T2R";
	СтруктураРеквизитовФормы.мИдГруппы43    = "П4T3R";
	СтруктураРеквизитовФормы.мИдГруппы51    = "П5T1R";
	СтруктураРеквизитовФормы.мИдГруппы52    = "П5T2R";
	СтруктураРеквизитовФормы.мИдГруппы53    = "П5T3R";
	СтруктураРеквизитовФормы.мИдГруппыС1    = "С1T1R";
	СтруктураРеквизитовФормы.мИдГруппыС2    = "С1T2R";
	СтруктураРеквизитовФормы.мИдГруппыС3    = "С1T3R";
	СтруктураРеквизитовФормы.мИдГруппы7     = "П7T2R";
	СтруктураРеквизитовФормы.мИдГруппы81    = "П8T1R";
	СтруктураРеквизитовФормы.мИдГруппыФ1    = "ФT1R";
		
	// количество строк многострочных разделов по "бумажной" форме отчета
	// (минимальное количество строк, которое должно присутствовать всегда)
	КолИсхСтрокИдГруппы1 = 1;
	
	СтруктураДанныхДекларация	= Новый Структура;
	СтруктураДанныхПриложение1	= Новый Структура;
	СтруктураДанныхПриложение2	= Новый Структура;
	СтруктураДанныхПриложение3	= Новый Структура;
	СтруктураДанныхПриложение4	= Новый Структура;
	СтруктураДанныхПриложение5	= Новый Структура;
	СтруктураДанныхСправка		= Новый Структура;
	СтруктураДанныхПриложение7	= Новый Структура;
	СтруктураДанныхПриложение8	= Новый Структура;
	СтруктураДанныхПриложение9	= Новый Структура;
	СтруктураДанныхПриложение10	= Новый Структура;
	СтруктураДанныхФилиалы		= Новый Структура;
	СтруктураДанныхЗаявление	= Новый Структура;
	СтруктураДанныхСлужебныеДанные	= Новый Структура;
	
	//ИнициализацияМногостраничныхРазделов();
	мСтруктураМногострочныхРазделов = Новый Структура;
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы, 	СтруктураРеквизитовФормы.мИдГруппы);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы_2, 	СтруктураРеквизитовФормы.мИдГруппы_2);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы1, 	СтруктураРеквизитовФормы.мИдГруппы1);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы2, 	СтруктураРеквизитовФормы.мИдГруппы2);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы21, 	СтруктураРеквизитовФормы.мИдГруппы21);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы31, 	СтруктураРеквизитовФормы.мИдГруппы31);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы41, 	СтруктураРеквизитовФормы.мИдГруппы41);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы43, 	СтруктураРеквизитовФормы.мИдГруппы43);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы51, 	СтруктураРеквизитовФормы.мИдГруппы51);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы52, 	СтруктураРеквизитовФормы.мИдГруппы52);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы53, 	СтруктураРеквизитовФормы.мИдГруппы53);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыС1, 	СтруктураРеквизитовФормы.мИдГруппыС1);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыС2, 	СтруктураРеквизитовФормы.мИдГруппыС2);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыС3, 	СтруктураРеквизитовФормы.мИдГруппыС3);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы7, 	СтруктураРеквизитовФормы.мИдГруппы7);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы81, 	СтруктураРеквизитовФормы.мИдГруппы81);
	мСтруктураМногострочныхРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыФ1, 	СтруктураРеквизитовФормы.мИдГруппыФ1);
	
	мСтруктураМногостраничныхРазделов = Новый Структура;
	//мСтруктураМногостраничныхРазделов.Вставить("ПриложениеПН", "ТаблицаСтраницыРаздела1");
	
	мСтруктураИсхКолвоСтрокРазделов = Новый Структура;
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы_2, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы1, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы2, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы21, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы31, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы41, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы43, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы51, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы52, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы53, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыС1, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыС2, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыС3, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы7, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппы81, 	КолИсхСтрокИдГруппы1);
	мСтруктураИсхКолвоСтрокРазделов.Вставить(СтруктураРеквизитовФормы.мИдГруппыФ1, 	КолИсхСтрокИдГруппы1);
	
	ЗаполнитьСтруктурыКолонокМногострочныхЧастей();
	
	ЦветЗаполняетсяТолькоВручную     = Новый Цвет(255, 255, 225);
	ЦветЗаполняетсяАвтоКорректир     = Новый Цвет(255, 240, 200);
	ЦветЗаполняетсяАвтоБезКорректир  = Новый Цвет(230, 240, 220);
	СтруктураРеквизитовФормы.ЦветЗаполняетсяАвтоАрифметика = Новый Цвет(192, 220, 192); // ЗЕЛЕНЫЙ
	ЦветЗаполняетсяОднозначноВручную = Новый Цвет(255, 255, 192); // ЖЕЛТЫЙ
	ЦветЗаполняетсяАвтоматически     = Новый Цвет(255, 255, 255); // Белый, Ввод запрещен
	
	// структура цветов раскраски автозаполняемых ячеек
	мСтруктураЦветовРаскраски = Новый Структура;
	мСтруктураЦветовРаскраски.Вставить("_1", ЦветЗаполняетсяТолькоВручную);
	мСтруктураЦветовРаскраски.Вставить("_2", ЦветЗаполняетсяАвтоКорректир);
	мСтруктураЦветовРаскраски.Вставить("_3", ЦветЗаполняетсяАвтоБезКорректир);
	мСтруктураЦветовРаскраски.Вставить("_4", СтруктураРеквизитовФормы.ЦветЗаполняетсяАвтоАрифметика);
	мСтруктураЦветовРаскраски.Вставить("_0", ЦветЗаполняетсяОднозначноВручную);
	мСтруктураЦветовРаскраски.Вставить("_5", ЦветЗаполняетсяАвтоматически);
	
	мСтруктураВариантыЗаполнения       = Новый Структура;
	мСтруктураВариантыЗаполненияЭталон = Новый Структура;
		
	// Версия формы
	СтруктураРеквизитовФормы.мВерсияФормы = "01/02/2016";
	
	СтруктураРеквизитовФормы.мПечатныеформы 	= Новый СписокЗначений;
	СтруктураРеквизитовФормы.мПечатаемыеРазделы = Новый СписокЗначений;
	
	ИмяРаздела = "Декларация";
		
	СтруктураРеквизитовФормы.НаимТекущегоРаздела = ИмяРаздела;
	
	СтруктураРеквизитовФормы.мВыбраннаяФорма          = Параметры.мВыбраннаяФорма;
	СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета  = Параметры.мДатаКонцаПериодаОтчета;
	СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета = Параметры.мДатаНачалаПериодаОтчета;
	СтруктураРеквизитовФормы.мПериодичность           = Параметры.мПериодичность;
	СтруктураРеквизитовФормы.мСкопированаФорма        = Параметры.мСкопированаФорма;
	СтруктураРеквизитовФормы.мСохраненныйДок          = Параметры.мСохраненныйДок;
	СтруктураРеквизитовФормы.Организация              = Параметры.Организация;
	
	ДатаПодписи                                       = ТекущаяДатаСеанса();
	
	ПорядкиОкругленияОтчетности = Новый Структура;
	ПорядкиОкругленияОтчетности.Вставить("ПеречислениеПорядкиОкругленияОтчетностиОкр1",       Перечисления.ПорядкиОкругленияОтчетности.Окр1);
	ПорядкиОкругленияОтчетности.Вставить("ПеречислениеПорядкиОкругленияОтчетностиОкр1000",    Перечисления.ПорядкиОкругленияОтчетности.Окр1000);
	ПорядкиОкругленияОтчетности.Вставить("ПеречислениеПорядкиОкругленияОтчетностиОкр1000000", Перечисления.ПорядкиОкругленияОтчетности.Окр1000000);
	
	СтруктураРеквизитовФормы.СправочникиВидыКонтактнойИнформацииФактАдресОрганизации = Справочники.ВидыКонтактнойИнформации.ФактАдресОрганизации;
	
	СтруктураРеквизитовФормы.мБезОткрытияФормы = Ложь;
	СтруктураРеквизитовФормы.мРежимПечати 	   = Ложь;
	
	ПеречислениеПериодичностьМесяц = Перечисления.Периодичность.Месяц;
	
	СтруктураРеквизитовФормы.ЕстьДуплекс = ОбщегоНазначения.ХранилищеОбщихНастроекЗагрузить("РегламентированнаяОтчетность", "ЕстьДуплекс", Ложь);
	Элементы.ЕстьДуплекс.Пометка		 = СтруктураРеквизитовФормы.ЕстьДуплекс;
	
	ВывестиМакетВТаблДокНаСервере(ИмяРаздела, 1);
	
	Инициализация(Параметры.БезОткрытияФормы);
	
	УстановитьФорматВыводаВПоляхВводаНаСервере(ИмяРаздела);
	УстановитьЦветФонаЯчейкиНаСервере(,, ИмяРаздела);
	
КонецПроцедуры // ПриСозданииНаСервере()

&НаСервере
Процедура СформироватьСтруктуруРеквизитовФормы()
	
	СтруктураРеквизитовФормы = Новый Структура;
	СтруктураРеквизитовФормы.Вставить("Организация");
	СтруктураРеквизитовФормы.Вставить("ЕдиницаИзмерения");
	СтруктураРеквизитовФормы.Вставить("ТочностьЕдиницыИзмерения");
	СтруктураРеквизитовФормы.Вставить("мБезОткрытияФормы");
	СтруктураРеквизитовФормы.Вставить("мВерсияФормы");
	СтруктураРеквизитовФормы.Вставить("мВыбраннаяФорма");
	СтруктураРеквизитовФормы.Вставить("мДатаКонцаПериодаОтчета");
	СтруктураРеквизитовФормы.Вставить("мДатаНачалаПериодаОтчета");
	СтруктураРеквизитовФормы.Вставить("мЗаписываетсяНовыйДокумент");
	СтруктураРеквизитовФормы.Вставить("мЗаписьЗапрещена");
	
	СтруктураРеквизитовФормы.Вставить("мИдГруппы");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы_2");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы2");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы21");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы31");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы41");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы43");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы51");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы52");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы53");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыС1");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыС2");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыС3");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы7");
	СтруктураРеквизитовФормы.Вставить("мИдГруппы81");
	СтруктураРеквизитовФормы.Вставить("мИдГруппыФ1");
	
	СтруктураРеквизитовФормы.Вставить("мОписаниеТиповЧислоЕ");
	СтруктураРеквизитовФормы.Вставить("мПериодичность");
	СтруктураРеквизитовФормы.Вставить("мПечатаемыеРазделы");
	СтруктураРеквизитовФормы.Вставить("мПечатныеФормы");
	СтруктураРеквизитовФормы.Вставить("мРежимПечати");
	СтруктураРеквизитовФормы.Вставить("мСкопированаФорма");
	СтруктураРеквизитовФормы.Вставить("мСоставПоказателей");
	СтруктураРеквизитовФормы.Вставить("мСохраненныйДок");
	СтруктураРеквизитовФормы.Вставить("мСтрокаФормата");
	СтруктураРеквизитовФормы.Вставить("СправочникиВидыКонтактнойИнформацииФактАдресОрганизации");
	СтруктураРеквизитовФормы.Вставить("ФлажокОтклАвтоРасчет", Ложь);
	СтруктураРеквизитовФормы.Вставить("ЦветЗаполняетсяАвтоАрифметика");
	СтруктураРеквизитовФормы.Вставить("НаимОрганизации");
	СтруктураРеквизитовФормы.Вставить("ОрганизацияЮридическоеФизическоеЛицо");
	СтруктураРеквизитовФормы.Вставить("СтрПериодОтчета");
	СтруктураРеквизитовФормы.Вставить("ВыводитьСтраницуВТаблДокНаСервере");
	СтруктураРеквизитовФормы.Вставить("НаимТекущегоРаздела");
	СтруктураРеквизитовФормы.Вставить("НомерТекущейСтраницы");
	СтруктураРеквизитовФормы.Вставить("СписокПечатаемыхЛистов");
	СтруктураРеквизитовФормы.Вставить("ОтображатьКнопкуЗаполнить", Истина);
	
	СтруктураРеквизитовФормы.Вставить("ОтображатьКнопкиДопСтрок", Истина);
	СтруктураРеквизитовФормы.Вставить("ОтображатьКнопкиДопСтраниц", Ложь);
	СтруктураРеквизитовФормы.Вставить("ОтображатьКнопкуРасшифровать", Истина);
	СтруктураРеквизитовФормы.Вставить("АдресВременногоХранилищаРасшифровки");
	СтруктураРеквизитовФормы.Вставить("мСохранятьРасшифровку", Истина);
	
	СтруктураРеквизитовФормы.Вставить("ОтображатьКнопкуВыгрузить", Истина);
	
	СтруктураРеквизитовФормы.Вставить("ТекущаяСтрокаРазделовОтчета");
	
	СтруктураРеквизитовФормы.Вставить("ТекущиеОбластиСтраниц");
	СтруктураРеквизитовФормы.Вставить("КолонкиМногострочныхРазделов");
	СтруктураРеквизитовФормы.Вставить("ЕстьДуплекс", Ложь);
	
	СтруктураРеквизитовФормы.Вставить("ПолучениеДанныхДляЗвит1С", Ложь);
	СтруктураРеквизитовФормы.Вставить("ДопПоказателиОтчетаЗвит1С", Новый Структура);
	
	СтруктураРеквизитовФормы.Вставить("ОтчетЗаДваМесяца", Ложь);
	
	СтруктураРеквизитовФормы.Вставить("СпецРежим", 0);
	
	СтруктураРеквизитовФормы.Вставить("НеВыдаватьСообщенияОбОшибкахВРасчете", Ложь);
	СтруктураРеквизитовФормы.Вставить("мНеВыдаватьСообщенияОбОшибкахВРасчете", Ложь);
	
	// ИНАГРО ++
	СтруктураРеквизитовФормы.Вставить("К1");
	СтруктураРеквизитовФормы.Вставить("К2");
	СтруктураРеквизитовФормы.Вставить("К3");
	// ИНАГРО --
	
КонецПроцедуры

//&НаСервере
//Процедура ИнициализацияМногостраничныхРазделов()
// 
//	Элементы.ДопСтроки.Видимость = Истина;
//	СтрПерваяСтраница = ЭтаФорма.ТаблицаСтраницыРаздела1.Добавить();
//	СтрПерваяСтраница.Представление               = НСтр("ru='Стр. ';uk='Стр. '") + 1;
//	СтрПерваяСтраница.АктивнаяСтраница            = Истина;
//	СтрПерваяСтраница.АвтоматическоеПредставление = Истина;

//КонецПроцедуры // ИнициализацияМногостраничныхРазделов()

// Функция возвращает параметры числа Е для различных разделов отчета
//
// Параметры
//  ИмяРаздела  - Строка
//
// Возвращаемое значение:
//  Результат   - ОписаниеТипа
//
&НаКлиентеНаСервереБезКонтекста
Функция ПолучитьОписаниеТипаЧислаЕДляРаздела(ИмяРаздела = "")
	
	Результат = Новый Структура("ОписаниеТипа, Длина, Точность");
	
	//Если ИмяРаздела = "Раздел1" 
	// ИЛИ ИмяРаздела = "Раздел2" 
	// ИЛИ ИмяРаздела = "Раздел3" 
	// ИЛИ ИмяРаздела = "Раздел3_Прил2" Тогда
	//	Результат = Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(14, 2));
	//ИначеЕсли ИмяРаздела = "Раздел7" Тогда
	//	Результат = Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(16, 2));	
	//Иначе
    Результат = Новый ОписаниеТипов("Число", Новый КвалификаторыЧисла(15, 2));
	//КонецЕсли; 

	Возврат Результат; 
	
КонецФункции


&НаСервере
Процедура Инициализация(БезОткрытияФормы = Ложь) Экспорт
	
	Перем ИсходноеКоличествоСтрокГруппы;
	
	СтруктураРеквизитовФормы.мБезОткрытияФормы = БезОткрытияФормы;
	
	ЗаполнитьНачальныеНастройки();

	
	ФормироватьСтруктуруСтраницОтчета();

	ФормироватьСтруктуруСвойствСтраниц();

	СформироватьДеревоРазделовОтчетаНаСервере();
	
	ЗаполнитьПустыеСтруктурыДанных();	
	
	СтруктураРеквизитовФормы.мРежимПечати = Ложь;

	Если СтруктураРеквизитовФормы.мСохраненныйДок = Неопределено Тогда
		
		НачальныеОперацииСМногострочнымиБлоками();
			
		Если СтруктураРеквизитовФормы.мСкопированаФорма <> Неопределено Тогда // документ скопирован
			ВосстановитьСохраненныеДанные();
		Иначе // новый документ
			
			СтруктураРеквизитовФормы.ЕдиницаИзмерения         = Перечисления.ПорядкиОкругленияОтчетности.Окр1;
			СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения = 0;
			
			КопироватьДанныеФормы(мДеревоСтраницОтчета, мДеревоВыбранныхСтраниц);
	
			ЗаполнитьПоказательНаВсехЗакладках("HZG", "X", ЭтаФорма, "|Приложение2|Приложение3|Приложение4|Приложение9|Приложение10|Заявление|Филиалы|");
			ЭтаФорма.СтруктураРеквизитовФормы.СпецРежим = 0;         
			
		КонецЕсли;
		
		Модифицированность = Истина;

	Иначе
		
		ВосстановитьСохраненныеДанные();
		
		Если ЗначениеЗаполнено(СтруктураРеквизитовФормы.мСкопированаФорма) Тогда
			СтруктураРеквизитовФормы.мСохраненныйДок = Неопределено;
		КонецЕсли;
		
	КонецЕсли;
	
	РегламентированнаяОтчетность.ПолучитьСведенияОПоказателяхОтчета(ЭтаФорма);
	
	Если НЕ СтруктураРеквизитовФормы.ОтображатьКнопкуЗаполнить Тогда
		Элементы.Заполнить.Видимость = Ложь;
		СтруктураРеквизитовФормы.мСохранятьРасшифровку = Ложь;
	КонецЕсли;
	
	Если НЕ СтруктураРеквизитовФормы.ОтображатьКнопкуРасшифровать Тогда
		Элементы.Расшифровать.Видимость = Ложь;
	КонецЕсли;
	
	Если НЕ СтруктураРеквизитовФормы.ОтображатьКнопкуВыгрузить Тогда
		Элементы.Выгрузка.Видимость = Ложь;
	КонецЕсли;
	
	Если НЕ СтруктураРеквизитовФормы.ОтображатьКнопкиДопСтрок Тогда
		Элементы.ДопСтроки.Видимость = Ложь;
	КонецЕсли;
	
	Если НЕ СтруктураРеквизитовФормы.ОтображатьКнопкиДопСтраниц Тогда
		Элементы.ДопСтраницы.Видимость = Ложь;
	КонецЕсли;
	
	ПоказатьПериод();
	
	СтруктураРеквизитовФормы.НаимОрганизации = СтруктураРеквизитовФормы.Организация.Наименование;
	СтруктураРеквизитовФормы.ОрганизацияЮридическоеФизическоеЛицо = СтруктураРеквизитовФормы.Организация.ЮридическоеФизическоеЛицо;
	
	Если СтруктураРеквизитовФормы.мСохраненныйДок = Неопределено ИЛИ ЗначениеЗаполнено(СтруктураРеквизитовФормы.мСкопированаФорма) Тогда
		ЗаполнитьСведенияОбОрганизацииНаСервере();
	КонецЕсли;
    	
	// формируем список элементов подменю, связанное с кнопкой <Печать>
	Если НЕ БезОткрытияФормы Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПрорисоватьПодменюПечать(ЭтаФорма);
	КонецЕсли;
	СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Ложь;
	
КонецПроцедуры // Инициализация()

&НаСервере
Процедура НачальныеОперацииСМногострочнымиБлоками()
	
	Перем ИсходноеКоличествоСтрокГруппы;

	// создаем исходную структуру многострочных разделов
	Для Каждого ЭлементСтруктуры Из мСтруктураМногострочныхРазделов Цикл
		
		ИмяГруппы = ЭлементСтруктуры.Ключ;
		СтруктураГруппы = ЭтаФорма[ЭлементСтруктуры.Значение];
		
		мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);

		Для НСтр = 1 По ИсходноеКоличествоСтрокГруппы Цикл

			СтруктураГруппы.Добавить();
			
		КонецЦикла;
		
	КонецЦикла;
	
КонецПроцедуры // НачальныеОперацииСМногострочнымиБлоками()

// Выполняет начальные настройки параметров отчета.
// По данным макета "СоствПоказателей" формирует:
//   - состав показателей отчета;
//   - варианты заполнения показателей отчета;
//   - дерево выводимых на печать листов отчета.
//
&НаСервере
Процедура ЗаполнитьНачальныеНастройки()
	
	МакетСоставаПоказателей = ОбъектОтчета(ЭтаФорма.ИмяФормы).ПолучитьМакет(СтруктураРеквизитовФормы.мСоставПоказателей);	
	
	МассивТиповТаблицаЗначений = Новый Массив; 
	МассивТиповТаблицаЗначений.Добавить(Тип("ТаблицаЗначений"));
	ОписаниеТиповТаблицаЗначений = Новый ОписаниеТипов(МассивТиповТаблицаЗначений);
	
	Для Инд = 0 По МакетСоставаПоказателей.Области.Количество() - 1 Цикл
				
		ТекОбласть    = МакетСоставаПоказателей.Области[Инд];
		ИмяСтраницы   = ТекОбласть.Имя;
		
		ЭтаФорма["ТаблицаВариантыЗаполнения" + ИмяСтраницы].Добавить();
		
		// Таблица значений содержит информацию о вариантах заполнения показателя отчета.
		// В колонках таблицы значений отображается следующая информация:
		//   - имя ячейки (код показателя);
		//   - вариант заполнения ячейки;
		//   - вычисленное по данным ИБ значение ячейки;
		//   - величина автокорректировки значения ячейки;
		//   - примечание к ячейке.
		//
				
		Для Ном = ТекОбласть.Верх По ТекОбласть.Низ Цикл
			// перебираем строки макета
            					
			// Код показателя (по составу показателей) определяется по первой колонке макета
			КодПоказателя = СокрП(МакетСоставаПоказателей.Область(Ном, 1).Текст);
			ИмяПоказателя = КодПоказателя;

			Если КодПоказателя = "===" Тогда         // признак конечной строки
				Прервать;
			КонецЕсли;
			
			Если КодПоказателя = "###" Тогда         
				Прервать;
			КонецЕсли;

			Если Лев(КодПоказателя, 2) = "//" Тогда  // пропускаем комментарии
				Продолжить;
			КонецЕсли;

			// код показателя по форме отчете (имя ячейки в полях табличного документа формы)
			КодПоказателяПоФорме = СокрЛП(МакетСоставаПоказателей.Область(Ном, 2).Текст);
			// признак многострочности определяется по третьей колонке макета
			ПризнМногострочность = СокрЛП(МакетСоставаПоказателей.Область(Ном, 3).Текст);
			// по четвертой колонке определяется тип данных реквизита
			ТипДанныхРеквизита   = СокрЛП(МакетСоставаПоказателей.Область(Ном, 4).Текст);
			// по колонке 5 определяется исходное количество строк многострочного раздела
			стрКолСтрокИсходный  = СокрЛП(МакетСоставаПоказателей.Область(Ном, 5).Текст);
			// вариант заполнения ячейки определяется по колонке 6 макета
			стрВариантЗаполнения = РегламентированнаяОтчетность.ПолучитьВариантЗаполненияПоказателяРегОтчета(МакетСоставаПоказателей, Ном);
			// код показателя из структуры, берется из колонки 9
			
			чКолСтрокИсходный    = ? (ПустаяСтрока(стрКолСтрокИсходный),  0, Число(стрКолСтрокИсходный));
			чВариантЗаполнения   = ? (ПустаяСтрока(стрВариантЗаполнения), 0, Число(стрВариантЗаполнения));

			// формируем таблицу значений, содержащей состав показателей отчета
			НоваяСтрока = мТаблицаСоставПоказателей.Добавить();
			НоваяСтрока.ИмяПоляТаблДокумента   = ИмяСтраницы;
			НоваяСтрока.КодПоказателяПоСоставу = КодПоказателя;
			НоваяСтрока.КодПоказателяПоФорме   = КодПоказателяПоФорме;
			НоваяСтрока.ПризнМногострочности   = ПризнМногострочность;
			НоваяСтрока.ТипДанныхПоказателя    = ТипДанныхРеквизита;

			Если чВариантЗаполнения <> 0 Тогда
				// Если в колонке 6 задан вариант заполнения показателя, 
				// то его значение может определяться по данным ИБ.
				// Дополняем таблицу значений вариантов заполнения
				НоваяСтрока = ЭтаФорма["ТаблицаВариантыЗаполнения" + ИмяСтраницы][0].ТаблицаВариантовЗаполнения.Добавить();
				НоваяСтрока.КодПоказателя      = ? (Не ПустаяСтрока(КодПоказателяПоФорме), КодПоказателяПоФорме, КодПоказателя);
				НоваяСтрока.ВариантЗаполнения  = чВариантЗаполнения;
			КонецЕсли;

		КонецЦикла;

		Если ЭтаФорма["ТаблицаВариантыЗаполнения" + ИмяСтраницы][0].ТаблицаВариантовЗаполнения.Количество() > 0 Тогда		
			// имеются автоматически заполняемые ячейки
            
			// Создаем структуру, содержащей варианты заполнения показателей отчета.
			//
			// В качестве ключа используется имя страницы основной панели формы, содержащей
			//   табличный документ с автоматически заполняемыми показателями.
			// В качестве значения принимаем Массив из таблицы значений - вариантов заполнения
			//   показателей по каждой странице многостраничного раздела.
			//
			мСтруктураВариантыЗаполнения.Вставить(ИмяСтраницы, ИмяСтраницы);
			мСтруктураВариантыЗаполненияЭталон.Вставить(ИмяСтраницы, ИмяСтраницы);
						
		Конецесли;

	КонецЦикла;
	
КонецПроцедуры // ЗаполнитьНачальныеНастройки()

// Формирует дерево значений - структуру страниц отчета,
// содержащей настройки показа страниц, вывода на печать и выгрузки в ИМНС.
//
&НаСервере
Процедура ФормироватьСтруктуруСтраницОтчета() 

	// Дерево содержит коллекцию страниц отчета.
	// В колонках дерева хранятся следующие данные:
	//    - представление листа;
	//    - имя страницы основной панели формы, содержащей выводимый на печать лист;
	//    - имя поля табличного документа;
	//    - имя области ячеек табличного документа (используется в случае вывода
	//      на печать отдельных страниц титульного листа);
	//    - ориентация страницы при печати;
	//    - число, метка вывода страницы на печать;
	//    - число, метка показа страницы на основной панели формы;
	//    - число, метка выгрузки данных страницы 
	//

	мДеревоСтраницОтчета.ПолучитьЭлементы().Очистить();
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Декларация";
	СтрокаУровня1.Представление            = НСтр("ru='Декларация по НДС';uk='Декларація з ПДВ'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение1";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д1';uk='Додаток Д1'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;

	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение2";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д2';uk='Додаток Д2'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;

	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение3";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д3';uk='Додаток Д3'");
	СтрокаУровня1.ИмяПоляТабличногоДокум   = "ПолеТабличногоДокументаПриложение3";
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение4";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д4';uk='Додаток Д4'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение5";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д5';uk='Додаток Д5'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Справка";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д6 (Справка)';uk='Додаток Д6 (Довідка)'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;

	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение7";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д7';uk='Додаток Д7'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение8";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение Д8';uk='Додаток Д8'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Ландшафт;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение9";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение ДС9';uk='Додаток ДС9'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Приложение10";
	СтрокаУровня1.Представление            = НСтр("ru='Приложение ДС10';uk='Додаток ДС10'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Заявление";
	СтрокаУровня1.Представление            = НСтр("ru='Заявление  о выборе квартального отчетного (налогового) периода ';uk='Заява про вибір квартального звітного (податкового) періоду '");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;

	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "Филиалы";
	СтрокаУровня1.Представление            = НСтр("ru='Сообщение о делегировании филиалам права выписки налоговых накладных';uk= 'Повідомлення про делегування філіям права виписки податкових накладних'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "ОбластьПечатиПоВысоте|ОбластьПечатиПоШирине";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 1;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
	СтрокаУровня1 = мДеревоСтраницОтчета.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы              = "СлужебныеДанные";
	СтрокаУровня1.Представление            = НСтр("ru='Служебные данные';uk='Службові дані'");
	СтрокаУровня1.ИмяОбластиТабличногоПоля = "";
	СтрокаУровня1.ОриентацияСтраницы       = ОриентацияСтраницы.Портрет;
	СтрокаУровня1.ВыводНаПечать            = 0;
	СтрокаУровня1.ПоказатьСтраницу         = 1;
	СтрокаУровня1.ВыгрузитьСтраницу        = 1;
	
КонецПроцедуры // ФормироватьСтруктуруСтраницОтчета()

// Формирует дерево значений - структуру страниц отчета,
// содержащей настройки показа страниц, вывода на печать и выгрузки.
//
&НаСервере
Процедура ФормироватьСтруктуруСвойствСтраниц() Экспорт
		
	мСвойстваРазделовДекларации.ПолучитьЭлементы().Очистить();
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Декларация";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено; 
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;

	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы_2;
	НовСтр.Область = "МногострочнаяЧасть_2";
	НовСтр.ВысотаСтроки =1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение1";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы1;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы2;
	НовСтр.Область = "МногострочнаяЧасть_2";
	НовСтр.ВысотаСтроки =1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение2";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы21;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение3";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы31;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение4";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы41;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы43;
	НовСтр.Область = "МногострочнаяЧасть_2";
	НовСтр.ВысотаСтроки = 1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение5";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы51;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы52;
	НовСтр.Область = "МногострочнаяЧасть_2";
	НовСтр.ВысотаСтроки = 1;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы53;
	НовСтр.Область = "МногострочнаяЧасть_3";
	НовСтр.ВысотаСтроки = 1;
	
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Справка";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппыС1;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппыС2;
	НовСтр.Область = "МногострочнаяЧасть_2";
	НовСтр.ВысотаСтроки = 1;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппыС3;
	НовСтр.Область = "МногострочнаяЧасть_3";
	НовСтр.ВысотаСтроки = 1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение7";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы7;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение8";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппы81;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение9";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Приложение10";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Заявление";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "Филиалы";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
	НовСтр = СтрокаУровня1.МногострочностьВРазделе.Добавить();
	НовСтр.ИдГруппы = СтруктураРеквизитовФормы.мИдГруппыФ1;
	НовСтр.Область = "МногострочнаяЧасть_1";
	НовСтр.ВысотаСтроки = 1;
	
	СтрокаУровня1 = мСвойстваРазделовДекларации.ПолучитьЭлементы().Добавить();
	СтрокаУровня1.ИмяСтраницы                          = "СлужебныеДанные";
	СтрокаУровня1.СохранятьМногострКакТЗ               = Неопределено;
	СтрокаУровня1.МногостраничностьВРазделе            = Ложь;
	СтрокаУровня1.МаксКолвоЭкз						   = 0;
	СтрокаУровня1.ОчищатьРаздел                        = Истина;
	СтрокаУровня1.ИмяПредставления                     = "";
	СтрокаУровня1.ПредставлениеДанных                  = Истина;
	СтрокаУровня1.РазделОбязателенДляВыгрузки          = Неопределено;
	СтрокаУровня1.РазделЯвляетсяАвтозаполняемым        = Ложь;
	
КонецПроцедуры // ФормироватьСтруктуруСвойствСтраниц()

// СформироватьДеревоРазделовОтчетаНаСервере()
//
&НаСервере
Процедура СформироватьДеревоРазделовОтчетаНаСервере() Экспорт
	
	СформироватьДеревоРазделовОтчета(ЭтаФорма);
			
КонецПроцедуры // СформироватьДеревоРазделовОтчетаНаСервере()

// СформироватьДеревоРазделовОтчетаНаКлиенте()
//
&НаКлиенте
Процедура СформироватьДеревоРазделовОтчетаНаКлиенте() Экспорт
	
	СформироватьДеревоРазделовОтчета(ЭтаФорма);
			
КонецПроцедуры // СформироватьДеревоРазделовОтчетаНаКлиенте()

// СформироватьДеревоРазделовОтчета()
//
&НаКлиентеНаСервереБезКонтекста
Процедура СформироватьДеревоРазделовОтчета(Форма)
	
	Форма["РазделыОтчета"].ПолучитьЭлементы().Очистить();
	
	Для Каждого ЭлементДереваСтраницОтчета Из Форма["мДеревоСтраницОтчета"].ПолучитьЭлементы() Цикл
		
		Если ЭлементДереваСтраницОтчета.ПоказатьСтраницу = 1 Тогда
			
			ЭлементРазделовОтчета = Форма["РазделыОтчета"].ПолучитьЭлементы().Добавить();
			ЭлементРазделовОтчета.КолонкаРазделыОтчета         = ЭлементДереваСтраницОтчета.Представление;
			ЭлементРазделовОтчета.КолонкаРазделыОтчетаСокрНаим = ЭлементДереваСтраницОтчета.ИмяСтраницы;
			ЭлементРазделовОтчета.ИндексКартинки               = 1;
			ЭлементРазделовОтчета.РазделМногостраничный        = Ложь;
			ЭлементРазделовОтчета.РазделМногострочный          = Ложь;
			
			НайденноеЗначение = Неопределено;
			
			Если Форма["мСтруктураМногостраничныхРазделов"].Свойство(ЭлементРазделовОтчета.КолонкаРазделыОтчетаСокрНаим, НайденноеЗначение) Тогда
				
				Если НЕ НайденноеЗначение = Неопределено Тогда
					
					НайденноеЗначение = Форма[НайденноеЗначение];
					
					ЭлементРазделовОтчета.ИндексКартинки        = 0;
					ЭлементРазделовОтчета.РазделМногостраничный = Истина;
					
					Для НомерСтраницы = 1 По НайденноеЗначение.Количество() Цикл
						
						СтраницаРазделаОтчета = ЭлементРазделовОтчета.ПолучитьЭлементы().Добавить();
						
						СтраницаРазделаОтчета.КолонкаРазделыОтчета              = НайденноеЗначение[НомерСтраницы-1].Представление;
						СтраницаРазделаОтчета.КолонкаРазделыОтчетаСокрНаим      = ЭлементРазделовОтчета.КолонкаРазделыОтчетаСокрНаим;
						СтраницаРазделаОтчета.КолонкаНомерСтраницыРазделаОтчета = НомерСтраницы;
						СтраницаРазделаОтчета.ИндексКартинки                    = 1;
						СтраницаРазделаОтчета.РазделМногостраничный             = ЭлементРазделовОтчета.РазделМногостраничный;
						СтраницаРазделаОтчета.РазделМногострочный               = ЭлементРазделовОтчета.РазделМногострочный;
						
					КонецЦикла;
					
				КонецЕсли;
				
			КонецЕсли;
				
		КонецЕсли;
				
	КонецЦикла;
			
КонецПроцедуры // СформироватьДеревоРазделовОтчета()

&НаСервере
Функция СформироватьСтруктуруДанныхДопСтрокСтраницы(Форма, ИмяСтраницы) Экспорт
	Перем СтруктураДанныхДопСтрокРаздела;

	Если ИмяСтраницы = "ПриложениеПН" Тогда

		РегламентированнаяОтчетностьКлиентСервер.ОбновитьСтруктуруМногострочногоРаздела(Форма, Форма.СтруктураРеквизитовФормы.мИдГруппыPN);

		СтруктураДанныхДопСтрокРаздела = Новый Структура;
		
		ПромТаблицаДопСтрокРаздела = Неопределено;
		Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппыPN, ПромТаблицаДопСтрокРаздела);
		ПромТаблицаДопСтрокРаздела = Форма[ПромТаблицаДопСтрокРаздела];
		ТаблицаДопСтрокГруппы = Форма["Хранилище" + Форма.СтруктураРеквизитовФормы.мИдГруппыPN].Добавить().Таблица;
		КопироватьДанныеФормы(ПромТаблицаДопСтрокРаздела, ТаблицаДопСтрокГруппы);
		СтруктураДанныхДопСтрокРаздела.Вставить(Форма.СтруктураРеквизитовФормы.мИдГруппыPN, ТаблицаДопСтрокГруппы);
		
	КонецЕсли;

	Возврат СтруктураДанныхДопСтрокРаздела;

КонецФункции

// РазделыОтчетаПриАктивизацииСтроки()
//
&НаКлиенте
Процедура РазделыОтчетаПриАктивизацииСтроки(Элемент) Экспорт
	
	Если Элемент.ТекущиеДанные = Неопределено
	 ИЛИ Элемент.ТекущаяСтрока = СтруктураРеквизитовФормы.ТекущаяСтрокаРазделовОтчета Тогда
		Возврат;
	КонецЕсли;
	
	// сохраним текущее положение курсора на странице
	Если СтруктураРеквизитовФормы.ТекущиеОбластиСтраниц = Неопределено Тогда
		СтруктураРеквизитовФормы.ТекущиеОбластиСтраниц = Новый Структура;
	КонецЕсли;
	ТекущийНомерСтраницы = "_" + Строка(СтруктураРеквизитовФормы.ТекущаяСтрокаРазделовОтчета);
	
	КоординатыОбласти = Новый Структура();
	КоординатыОбласти.Вставить("Верх", 	Элементы.ТабличныйДокумент.ТекущаяОбласть.Верх);
	КоординатыОбласти.Вставить("Низ", 	Элементы.ТабличныйДокумент.ТекущаяОбласть.Низ);
	КоординатыОбласти.Вставить("Лево", 	Элементы.ТабличныйДокумент.ТекущаяОбласть.Лево);
	КоординатыОбласти.Вставить("Право", Элементы.ТабличныйДокумент.ТекущаяОбласть.Право);
	
	СтруктураРеквизитовФормы.ТекущиеОбластиСтраниц.Вставить(ТекущийНомерСтраницы, КоординатыОбласти);	

	СтруктураРеквизитовФормы.ТекущаяСтрокаРазделовОтчета = Элемент.ТекущаяСтрока;
	
	Элементы.ОчиститьТекущуюСтраницу.Доступность = Истина;
	
	Элементы.ДобавитьСтраницу.Доступность   = Ложь;
	Элементы.УдалитьСтраницу.Доступность    = Ложь;
	Элементы.УдалитьВсеСтраницы.Доступность = Ложь;
	Элементы.ДобавитьСтроку.Доступность     = Ложь;
	Элементы.УдалитьСтроку.Доступность      = Ложь;
				
	Если СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере Тогда
		
		Если Элемент.ТекущиеДанные.РазделМногостраничный Тогда
			
			Элемент.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета = ?(Элемент.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета = Неопределено
															        ИЛИ Элемент.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета = 0, 1, Элемент.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета);
																
		КонецЕсли;														
				
		ВывестиМакетСтраницыВТабличныйДокументНаСервере(Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим, Элемент.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета);
		
	Иначе
		
		СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Истина;
		
	КонецЕсли;
		
	Если Элемент.ТекущиеДанные.РазделМногостраничный Тогда
		
		Элемент.Развернуть(Элемент.ТекущаяСтрока);
		
		Элементы.ДобавитьСтраницу.Доступность   = Истина;
		Элементы.УдалитьСтраницу.Доступность    = Истина;
		Элементы.УдалитьВсеСтраницы.Доступность = Истина;
		
		Если Элемент.ТекущиеДанные.ПолучитьРодителя() = Неопределено Тогда
			
			Элементы.ОчиститьТекущуюСтраницу.Доступность = Ложь;
			
			Элементы.УдалитьСтраницу.Доступность = Ложь;
							   			
			Если Элемент.ТекущиеДанные.ПолучитьЭлементы().Количество() = 1 Тогда
				Элементы.УдалитьВсеСтраницы.Доступность = Ложь;
			КонецЕсли;
			
		ИначеЕсли Элемент.ТекущиеДанные.ПолучитьРодителя().ПолучитьЭлементы().Количество() = 1 Тогда
			
			Элементы.УдалитьСтраницу.Доступность    = Ложь;
			Элементы.УдалитьВсеСтраницы.Доступность = Ложь;
			
		КонецЕсли;
		
	КонецЕсли;
	
	Если    Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Декларация"
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Приложение1" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Приложение2" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Приложение3" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Приложение4" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Приложение5" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Справка" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Приложение7" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Приложение8" 
		ИЛИ Элемент.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим = "Филиалы" Тогда
	
		Элементы.ДобавитьСтроку.Доступность = Истина;
		Элементы.УдалитьСтроку.Доступность  = Истина;
		
	КонецЕсли;
	
	// восстановим текущее положение курсора
	ТекущийНомерСтраницы = "_"+Строка(СтруктураРеквизитовФормы.ТекущаяСтрокаРазделовОтчета);
	Если СтруктураРеквизитовФормы.ТекущиеОбластиСтраниц.Свойство(ТекущийНомерСтраницы) Тогда
		
		КоординатыОбласти = СтруктураРеквизитовФормы.ТекущиеОбластиСтраниц[ТекущийНомерСтраницы];
		
		Элементы.ТабличныйДокумент.ТекущаяОбласть = ТабличныйДокумент.Область(КоординатыОбласти.Верх, КоординатыОбласти.Лево, КоординатыОбласти.Низ, КоординатыОбласти.Право);	
		
	Иначе	
		
		Элементы.ТабличныйДокумент.ТекущаяОбласть = ТабличныйДокумент.Область(1, 1, 1, 1);	
		
	КонецЕсли;
	
КонецПроцедуры // РазделыОтчетаПриАктивизацииСтроки()

&НаСервере
Процедура ВывестиМакетСтраницыВТабличныйДокументНаСервере(ИмяТекРаздела, НомерСтраницыРазделаОтчета)
		
	СохранитьДанныеРаздела(СтруктураРеквизитовФормы.НаимТекущегоРаздела, Истина);
			
	ВывестиМакетВТаблДокНаСервере(ИмяТекРаздела, НомерСтраницыРазделаОтчета);
	
	СтруктураРеквизитовФормы.НаимТекущегоРаздела  = ИмяТекРаздела;
	СтруктураРеквизитовФормы.НомерТекущейСтраницы = НомерСтраницыРазделаОтчета;
	
	//Если ИмяТекРаздела = "Раздел2" Тогда
	//	ИзменитьЦветЯчеекНаСервере();
	//КонецЕсли;
						
КонецПроцедуры // ВывестиМакетСтраницыВТабличныйДокументНаСервере()

&НаСервере
Процедура СохранитьДанныеРаздела(НаимРаздела, ОчищатьРазделЕслиЕстьМногострочность, ИзменитьПризнакАктивностиСтраницы = Истина)
	
	// Многостраничные и многострочные разделы.
	//
	Если    НаимРаздела = "ПриложениеПН" Тогда
		
		ТаблицаСтраницРаздела = Неопределено;
		
		мСтруктураМногостраничныхРазделов.Свойство(НаимРаздела, ТаблицаСтраницРаздела);
				
		ТаблицаСтраницРаздела = ЭтаФорма[ТаблицаСтраницРаздела];
		
		СтрТаблицыСтраниц = ТаблицаСтраницРаздела.НайтиСтроки(Новый Структура("АктивнаяСтраница", Истина));
		
		Если СтрТаблицыСтраниц.Количество() > 0 Тогда
				
			СтрТаблицаСтраницы = СтрТаблицыСтраниц[0];
			
			// Сохраним данные активной страницы, с присвоением Представления страницы и с очистной многострочных частей (Истина)
			
			СтруктураДанныхТекущейТаблицы = СобратьДанныеТекущегоТаблПоля(ЭтаФорма, "ТабличныйДокумент");
			
			ОпределитьПредставлениеДопСтраниц(НаимРаздела);

			СтруктураДанныхДопСтрокРаздела = СформироватьСтруктуруДанныхДопСтрокСтраницы(ЭтаФорма, НаимРаздела);
			
			Если СтрТаблицаСтраницы.Данные.Количество() > 0 Тогда
				СтрТаблицаСтраницы.Данные[0].Значение = СтруктураДанныхТекущейТаблицы;
			Иначе
				СтрТаблицаСтраницы.Данные.Добавить(СтруктураДанныхТекущейТаблицы);
			КонецЕсли;
							
			Если СтрТаблицаСтраницы.ДанныеДопСтрок.Количество() > 0 Тогда
				СтрТаблицаСтраницы.ДанныеДопСтрок[0].Значение = СтруктураДанныхДопСтрокРаздела;
			Иначе
				СтрТаблицаСтраницы.ДанныеДопСтрок.Добавить(СтруктураДанныхДопСтрокРаздела, "ДанныеФормыКоллекцияТаблицаДопСтрокРаздела");
			КонецЕсли;
			
			СтрТаблицаСтраницы.АктивнаяСтраница = НЕ ИзменитьПризнакАктивностиСтраницы;
			
		КонецЕсли;
		
	// Обычные разделы.
	//
	Иначе
		
		ЭтаФорма["СтруктураДанных" + НаимРаздела] = СобратьДанныеТекущегоТаблПоля(ЭтаФорма, "ТабличныйДокумент");
		
		ИмяГруппыМассив = ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаСервере(НаимРаздела);
		Для каждого ИмяГруппы Из ИмяГруппыМассив Цикл
			ОбновитьСтруктуруМногострочногоРазделаНаСервере(ИмяГруппы);	
		КонецЦикла;
		
	КонецЕсли;
				
КонецПроцедуры

&НаСервере
Процедура ОпределитьПредставлениеДопСтраниц(ИмяСтраницы = Неопределено, ТолькоУАктивнойСтраницы = Неопределено)
	Перем ТаблицаСтраницРаздела;
	Перем ТекущееПредставлениеСтраницы;

	ТолькоАктивная = ?(ТолькоУАктивнойСтраницы = Неопределено, Ложь, ТолькоУАктивнойСтраницы);
	
	Для Каждого Страница Из мСтруктураМногостраничныхРазделов Цикл
		ИмяТекСтраницы        = Страница.Ключ;
		ТаблицаСтраницРаздела = ЭтаФорма[Страница.Значение];

		Если ИмяСтраницы <> Неопределено Тогда
			Если ИмяТекСтраницы <> ИмяСтраницы Тогда
				Продолжить; // Пропускаем не нужные страницы
			КонецЕсли;
		КонецЕсли;

		// Если есть хоть одна страница - определим её представление
		Если ТаблицаСтраницРаздела.Количество() > 0 Тогда

			НомерСтраницы = 0;

			Для Каждого СтрокаТаблицы Из ТаблицаСтраницРаздела Цикл

				НомерСтраницы = НомерСтраницы + 1;

				СохрПредставлениеСтраницы = СтрокаТаблицы.Представление;

				// Если колонки нет, тогда автоматическое представление включено по умолчанию.
				Если ТаблицаСтраницРаздела[0].Свойство("АвтоматическоеПредставление") Тогда
					АвтоматическоеПредставление = СтрокаТаблицы.АвтоматическоеПредставление;
				Иначе
					АвтоматическоеПредставление = Истина;
				КонецЕсли;

				Если НЕ АвтоматическоеПредставление Тогда
					Продолжить;
				КонецЕсли;

				Если (НЕ ТолькоАктивная) Или ((ТолькоАктивная) И (СтрокаТаблицы.АктивнаяСтраница))Тогда

					ТекущееПредставлениеСтраницы = НСтр("ru='Стр. ';uk='Стр. '") + Строка(НомерСтраницы);
					СтрокаТаблицы.Представление = ТекущееПредставлениеСтраницы;

				КонецЕсли; // ТолькоАктивная

			КонецЦикла;

		КонецЕсли;

	КонецЦикла;

КонецПроцедуры


&НаСервере
Процедура ВывестиМакетВТаблДокНаСервере(ИмяТекРаздела, НомерСтраницыРазделаОтчета)
	
	ТабличныйДокумент.Очистить();
	ТабличныйДокумент.Вывести(ОбъектОтчета(ЭтаФорма.ИмяФормы).ПолучитьМакет(Сред(ЭтаФорма.ИмяФормы, Найти(ЭтаФорма.ИмяФормы, "ФормаОтчета")) + "_" + ИмяТекРаздела));
	
	
	Если ТабличныйДокумент.Области.Найти("ПредупреждениеОПечати") = Неопределено Тогда
		ТабличныйДокумент.ОбластьПечати = Неопределено;
	Иначе
		ТабличныйДокумент.ОбластьПечати 					  = ТабличныйДокумент.Области.ПредупреждениеОПечати;
	    ТабличныйДокумент.Области.ПредупреждениеОПечати.Текст = НСтр("ru='ВНИМАНИЕ! Печать отчета необходимо осуществлять из меню ''Печать''.';uk= 'УВАГА! Друк звіту необхідно здійснювати за допомогою меню ''Друк''.'");
	КонецЕсли;
	
	Если НЕ ИмяТекРаздела = "ПриложениеПН" Тогда 
		
		Для Каждого ЭлСтруктуры Из ЭтаФорма["СтруктураДанных" + ИмяТекРаздела] Цикл
			Если НЕ ТабличныйДокумент.Области.Найти(ЭлСтруктуры.Ключ) = Неопределено Тогда
				Попытка
					ТабличныйДокумент.Области[ЭлСтруктуры.Ключ].Значение = ЭлСтруктуры.Значение;
				Исключение
				КонецПопытки;
			КонецЕсли;	
		КонецЦикла;
		
		ИмяГруппыМассив = ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаСервере(ИмяТекРаздела);
		Для каждого ИмяГруппы Из ИмяГруппыМассив Цикл
		
			СтруктураГруппы = Неопределено;
			
			мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);
			
			СтруктураГруппы = ЭтаФорма[СтруктураГруппы];
			
			ВывестиРазделВТабличныйДокумент(ЭтаФорма, ИмяГруппы, СтруктураГруппы);
		
		КонецЦикла;
						
//	 Многострочные и обычные разделы.
	Иначе
		НаимТаблицыСтраницы = мСтруктураМногостраничныхРазделов[ИмяТекРаздела];
		
		СтруктураДанных = Новый Структура;
		
		СписокДанных = ЭтаФорма[НаимТаблицыСтраницы][НомерСтраницыРазделаОтчета - 1].Данные;
		
		ЭтаФорма[НаимТаблицыСтраницы][НомерСтраницыРазделаОтчета - 1].АктивнаяСтраница = Истина;

		Если СписокДанных.Количество() > 0 Тогда
			СтруктураДанных = СписокДанных[0].Значение;
		КонецЕсли;
		 	 
		Для Каждого ЭлСтруктуры Из СтруктураДанных Цикл
			
			Если НЕ ТабличныйДокумент.Области.Найти(ЭлСтруктуры.Ключ) = Неопределено Тогда
				
				Попытка
					ТабличныйДокумент.Области[ЭлСтруктуры.Ключ].Значение = ЭлСтруктуры.Значение;
				Исключение
				КонецПопытки;
				
			КонецЕсли;
			
		КонецЦикла;

		ТаблицаСтраницРаздела = Неопределено;
		
		мСтруктураМногостраничныхРазделов.Свойство(ИмяТекРаздела, ТаблицаСтраницРаздела);
				
		ТаблицаСтраницРаздела = ЭтаФорма[ТаблицаСтраницРаздела];
		                                                        		
		СтрСледующаяСтраница = ТаблицаСтраницРаздела[НомерСтраницыРазделаОтчета - 1];
		
		СтрСледующаяСтраница.АктивнаяСтраница = Истина;
		
		ТаблицаВариантыЗаполнения = РегламентированнаяОтчетностьВызовСервера.ПолучитьТаблицуВариантовЗаполненияНаСервере(ЭтаФорма, ИмяТекРаздела);
				
		НовДанныеДопСтрокРаздела = СтрСледующаяСтраница.ДанныеДопСтрок;
		
		Если (ТипЗнч(НовДанныеДопСтрокРаздела) = Тип("СписокЗначений"))
			И (НовДанныеДопСтрокРаздела.Количество() > 0)
			И (НовДанныеДопСтрокРаздела[0].Представление = "ДанныеФормыКоллекцияТаблицаДопСтрокРаздела") Тогда
			
			НовДанныеДопСтрокРаздела = НовДанныеДопСтрокРаздела[0].Значение;
			
		Иначе
			
			НовДанныеДопСтрокРаздела = Неопределено;
			
		КонецЕсли;

		
		Если НовДанныеДопСтрокРаздела <> Неопределено Тогда
			
			Для Каждого ГруппаСтрок Из НовДанныеДопСтрокРаздела Цикл
				
				ИмяГруппыДопСтрок = ГруппаСтрок.Ключ;
				ДанныеГруппыСтрок = ГруппаСтрок.Значение;
				
				ПромТаблицаГруппыСтрок = ЭтаФорма["Хранилище" + ИмяГруппыДопСтрок].Добавить().Таблица;
				
				КопироватьДанныеФормы(ДанныеГруппыСтрок, ПромТаблицаГруппыСтрок);
				
				// Заменяем таблицу значений с данными текущей страницы.
				КопироватьДанныеФормы(ПромТаблицаГруппыСтрок, ЭтаФорма[ИмяГруппыДопСтрок]);
				
				ВывестиРазделВТабличныйДокумент(ЭтаФорма, ИмяГруппыДопСтрок, ПромТаблицаГруппыСтрок);
				ОбновитьСтруктуруМногострочногоРазделаНаСервере(ИмяГруппыДопСтрок);
				
			КонецЦикла;
			
		КонецЕсли;
		
	КонецЕсли;	
	
	//ЗаполнитьПоказателиЗначениямиПоУмолчанию(ИмяТекРаздела);
	
	УстановитьФорматВыводаВПоляхВводаНаСервере(ИмяТекРаздела);
	
	УстановитьЦветФонаЯчейкиНаСервере(,, ИмяТекРаздела);
	
	
КонецПроцедуры // ВывестиМакетВТаблДокНаСервере()

&НаСервере
Процедура ЗаполнитьПоказателиЗначениямиПоУмолчанию(НаимРаздела)
	
	Если НаимРаздела = "ПриложениеПН" Тогда
		ЗаполнитьШапкуПодписиПриложенияПН(ЭтаФорма);
	КонецЕсли;
	
КонецПроцедуры // ЗаполнитьПоказателиЗначениямиПоУмолчанию()

&НаКлиенте
Функция ОпределитьТабличноеПолеПоИдМногострочногоРазделаНаКлиенте(ИдГруппы) Экспорт

	ИдГрупп = Новый Структура;
	ИдГрупп.Вставить("мИдГруппы", СтруктураРеквизитовФормы.мИдГруппы);
	ИдГрупп.Вставить("мИдГруппы_2", СтруктураРеквизитовФормы.мИдГруппы_2);
	ИдГрупп.Вставить("мИдГруппы1", СтруктураРеквизитовФормы.мИдГруппы1);
	ИдГрупп.Вставить("мИдГруппы2", СтруктураРеквизитовФормы.мИдГруппы2);
	ИдГрупп.Вставить("мИдГруппы21", СтруктураРеквизитовФормы.мИдГруппы21);
	ИдГрупп.Вставить("мИдГруппы31", СтруктураРеквизитовФормы.мИдГруппы31);
	ИдГрупп.Вставить("мИдГруппы41", СтруктураРеквизитовФормы.мИдГруппы41);
	ИдГрупп.Вставить("мИдГруппы43", СтруктураРеквизитовФормы.мИдГруппы43);
	ИдГрупп.Вставить("мИдГруппы51", СтруктураРеквизитовФормы.мИдГруппы51);
	ИдГрупп.Вставить("мИдГруппы52", СтруктураРеквизитовФормы.мИдГруппы52);
	ИдГрупп.Вставить("мИдГруппы53", СтруктураРеквизитовФормы.мИдГруппы53);
	ИдГрупп.Вставить("мИдГруппыС1", СтруктураРеквизитовФормы.мИдГруппыС1);
	ИдГрупп.Вставить("мИдГруппыС2", СтруктураРеквизитовФормы.мИдГруппыС2);
	ИдГрупп.Вставить("мИдГруппыС3", СтруктураРеквизитовФормы.мИдГруппыС3);
	ИдГрупп.Вставить("мИдГруппы7", СтруктураРеквизитовФормы.мИдГруппы7);
	ИдГрупп.Вставить("мИдГруппы81", СтруктураРеквизитовФормы.мИдГруппы81);
	ИдГрупп.Вставить("мИдГруппыФ1", СтруктураРеквизитовФормы.мИдГруппыФ1);
	
	Возврат ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИдГруппы, ИдГрупп);
		
КонецФункции // ОпределитьТабличноеПолеПоИдМногострочногоРазделаНаКлиенте()

&НаСервере
Функция ОпределитьТабличноеПолеПоИдМногострочногоРазделаНаСервере(ИдГруппы) Экспорт

	ИдГрупп = Новый Структура;
	ИдГрупп.Вставить("мИдГруппы", СтруктураРеквизитовФормы.мИдГруппы);
	ИдГрупп.Вставить("мИдГруппы_2", СтруктураРеквизитовФормы.мИдГруппы_2);
	ИдГрупп.Вставить("мИдГруппы1", СтруктураРеквизитовФормы.мИдГруппы1);
	ИдГрупп.Вставить("мИдГруппы2", СтруктураРеквизитовФормы.мИдГруппы2);
	ИдГрупп.Вставить("мИдГруппы21", СтруктураРеквизитовФормы.мИдГруппы21);
	ИдГрупп.Вставить("мИдГруппы31", СтруктураРеквизитовФормы.мИдГруппы31);
	ИдГрупп.Вставить("мИдГруппы41", СтруктураРеквизитовФормы.мИдГруппы41);
	ИдГрупп.Вставить("мИдГруппы43", СтруктураРеквизитовФормы.мИдГруппы43);
	ИдГрупп.Вставить("мИдГруппы51", СтруктураРеквизитовФормы.мИдГруппы51);
	ИдГрупп.Вставить("мИдГруппы52", СтруктураРеквизитовФормы.мИдГруппы52);
	ИдГрупп.Вставить("мИдГруппы53", СтруктураРеквизитовФормы.мИдГруппы53);
	ИдГрупп.Вставить("мИдГруппыС1", СтруктураРеквизитовФормы.мИдГруппыС1);
	ИдГрупп.Вставить("мИдГруппыС2", СтруктураРеквизитовФормы.мИдГруппыС2);
	ИдГрупп.Вставить("мИдГруппыС3", СтруктураРеквизитовФормы.мИдГруппыС3);
	ИдГрупп.Вставить("мИдГруппы7", СтруктураРеквизитовФормы.мИдГруппы7);
	ИдГрупп.Вставить("мИдГруппы81", СтруктураРеквизитовФормы.мИдГруппы81);
	ИдГрупп.Вставить("мИдГруппыФ1", СтруктураРеквизитовФормы.мИдГруппыФ1);
	
	Возврат ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИдГруппы, ИдГрупп);

КонецФункции // ОпределитьТабличноеПолеПоИдМногострочногоРазделаНаСервере()

// Функция определяет поле табличного документа формы, содержащее 
// многострочный раздел.по имени ИдГруппы.
//
// Параметры:
//  ИдГруппы - строка, имя многострочного раздела.
//
// Возвращаемое значение:
//  Поле табличного документа.
//
&НаКлиентеНаСервереБезКонтекста
Функция ОпределитьТабличноеПолеПоИдМногострочногоРаздела(ИдГруппы, ИдГрупп) Экспорт

	Перем ТекТабличноеПоле;
		
	Если  ИдГруппы = ИдГрупп.мИдГруппы
	  ИЛИ ИдГруппы = ИдГрупп.мИдГруппы_2 Тогда
		
		ТекТабличноеПоле = "Декларация";
		
	ИначеЕсли  ИдГруппы = ИдГрупп.мИдГруппы1
	       ИЛИ ИдГруппы = ИдГрупп.мИдГруппы2 Тогда
		
		ТекТабличноеПоле = "Приложение1";
		
	ИначеЕсли  ИдГруппы = ИдГрупп.мИдГруппы21 Тогда
		
		ТекТабличноеПоле = "Приложение2";
		
	ИначеЕсли  ИдГруппы = ИдГрупп.мИдГруппы31 Тогда
		
		ТекТабличноеПоле = "Приложение3";
		
	ИначеЕсли   ИдГруппы = ИдГрупп.мИдГруппы41 
			ИЛИ ИдГруппы = ИдГрупп.мИдГруппы43 Тогда
		
		ТекТабличноеПоле = "Приложение4";
		
	ИначеЕсли   ИдГруппы = ИдГрупп.мИдГруппы51 
			ИЛИ ИдГруппы = ИдГрупп.мИдГруппы52 
			ИЛИ ИдГруппы = ИдГрупп.мИдГруппы53 Тогда
		
		ТекТабличноеПоле = "Приложение5";
		
	ИначеЕсли   ИдГруппы = ИдГрупп.мИдГруппыС1 
			ИЛИ ИдГруппы = ИдГрупп.мИдГруппыС2 
			ИЛИ ИдГруппы = ИдГрупп.мИдГруппыС3 Тогда
		
		ТекТабличноеПоле = "Справка";
		
	ИначеЕсли   ИдГруппы = ИдГрупп.мИдГруппы7 Тогда
		
		ТекТабличноеПоле = "Приложение7";
		
	ИначеЕсли   ИдГруппы = ИдГрупп.мИдГруппы81 Тогда
		
		ТекТабличноеПоле = "Приложение8";
		
	ИначеЕсли   ИдГруппы = ИдГрупп.мИдГруппыФ1 Тогда
		
		ТекТабличноеПоле = "Филиалы";
		
	КонецЕсли;

	Возврат ТекТабличноеПоле;

КонецФункции // ОпределитьТабличноеПолеПоИдМногострочногоРаздела()

// ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаСервере()
//
&НаСервере
Функция ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаСервере(ИмяЛиста = Неопределено) Экспорт
	
	ИдГрупп = Новый Структура;
	ИдГрупп = Новый Структура;
	ИдГрупп.Вставить("мИдГруппы", СтруктураРеквизитовФормы.мИдГруппы);
	ИдГрупп.Вставить("мИдГруппы_2", СтруктураРеквизитовФормы.мИдГруппы_2);
	ИдГрупп.Вставить("мИдГруппы1", СтруктураРеквизитовФормы.мИдГруппы1);
	ИдГрупп.Вставить("мИдГруппы2", СтруктураРеквизитовФормы.мИдГруппы2);
	ИдГрупп.Вставить("мИдГруппы21", СтруктураРеквизитовФормы.мИдГруппы21);
	ИдГрупп.Вставить("мИдГруппы31", СтруктураРеквизитовФормы.мИдГруппы31);
	ИдГрупп.Вставить("мИдГруппы41", СтруктураРеквизитовФормы.мИдГруппы41);
	ИдГрупп.Вставить("мИдГруппы43", СтруктураРеквизитовФормы.мИдГруппы43);
	ИдГрупп.Вставить("мИдГруппы51", СтруктураРеквизитовФормы.мИдГруппы51);
	ИдГрупп.Вставить("мИдГруппы52", СтруктураРеквизитовФормы.мИдГруппы52);
	ИдГрупп.Вставить("мИдГруппы53", СтруктураРеквизитовФормы.мИдГруппы53);
	ИдГрупп.Вставить("мИдГруппыС1", СтруктураРеквизитовФормы.мИдГруппыС1);
	ИдГрупп.Вставить("мИдГруппыС2", СтруктураРеквизитовФормы.мИдГруппыС2);
	ИдГрупп.Вставить("мИдГруппыС3", СтруктураРеквизитовФормы.мИдГруппыС3);
	ИдГрупп.Вставить("мИдГруппы7", СтруктураРеквизитовФормы.мИдГруппы7);
	ИдГрупп.Вставить("мИдГруппы81", СтруктураРеквизитовФормы.мИдГруппы81);
	ИдГрупп.Вставить("мИдГруппыФ1", СтруктураРеквизитовФормы.мИдГруппыФ1);
		
	Возврат ОпределитьИдМногострочногоРазделаПоАктивнойСтранице(ИмяЛиста, , ИдГрупп);
	
КонецФункции // ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаСервере()

// ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаКлиенте()
//
&НаКлиенте
Функция ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаКлиенте(ИмяЛиста = Неопределено) Экспорт
	
	ИдГрупп = Новый Структура;
	ИдГрупп = Новый Структура;
	ИдГрупп.Вставить("мИдГруппы", СтруктураРеквизитовФормы.мИдГруппы);
	ИдГрупп.Вставить("мИдГруппы_2", СтруктураРеквизитовФормы.мИдГруппы_2);
	ИдГрупп.Вставить("мИдГруппы1", СтруктураРеквизитовФормы.мИдГруппы1);
	ИдГрупп.Вставить("мИдГруппы2", СтруктураРеквизитовФормы.мИдГруппы2);
	ИдГрупп.Вставить("мИдГруппы21", СтруктураРеквизитовФормы.мИдГруппы21);
	ИдГрупп.Вставить("мИдГруппы31", СтруктураРеквизитовФормы.мИдГруппы31);
	ИдГрупп.Вставить("мИдГруппы41", СтруктураРеквизитовФормы.мИдГруппы41);
	ИдГрупп.Вставить("мИдГруппы43", СтруктураРеквизитовФормы.мИдГруппы43);
	ИдГрупп.Вставить("мИдГруппы51", СтруктураРеквизитовФормы.мИдГруппы51);
	ИдГрупп.Вставить("мИдГруппы52", СтруктураРеквизитовФормы.мИдГруппы52);
	ИдГрупп.Вставить("мИдГруппы53", СтруктураРеквизитовФормы.мИдГруппы53);
	ИдГрупп.Вставить("мИдГруппыС1", СтруктураРеквизитовФормы.мИдГруппыС1);
	ИдГрупп.Вставить("мИдГруппыС2", СтруктураРеквизитовФормы.мИдГруппыС2);
	ИдГрупп.Вставить("мИдГруппыС3", СтруктураРеквизитовФормы.мИдГруппыС3);
	ИдГрупп.Вставить("мИдГруппы7", СтруктураРеквизитовФормы.мИдГруппы7);
	ИдГрупп.Вставить("мИдГруппы81", СтруктураРеквизитовФормы.мИдГруппы81);
	ИдГрупп.Вставить("мИдГруппыФ1", СтруктураРеквизитовФормы.мИдГруппыФ1);
		
	Возврат ОпределитьИдМногострочногоРазделаПоАктивнойСтранице(ИмяЛиста, , ИдГрупп);

КонецФункции // ОпределитьИдМногострочногоРазделаПоАктивнойСтраницеНаКлиенте()

// Функция определяет многострочный раздел табличного документа
// на активной странице основной панели формы.
//
// Параметры:
//  Нет;
//
// Возвращаемое значение:
//  строка, имя многострочного раздела.
//
&НаКлиентеНаСервереБезКонтекста
Функция ОпределитьИдМногострочногоРазделаПоАктивнойСтранице(ИмяЛиста = Неопределено, ТекущаяСтраница, ИдГрупп)
	
	Перем ИмяГруппы;
	
	ИмяГруппы = Новый Массив;
	
	Если ИмяЛиста = Неопределено Тогда
        ИмяТекущейСтраницыПанели = ТекущаяСтраница.Имя;
	Иначе
		ИмяТекущейСтраницыПанели = ИмяЛиста;
	КонецЕсли;

	Если ИмяТекущейСтраницыПанели = "Декларация" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы);
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы_2);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Приложение1" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы1);
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы2);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Приложение2" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы21);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Приложение3" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы31);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Приложение4" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы41);
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы43);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Приложение5" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы51);
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы52);
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы53);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Справка" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппыС1);
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппыС2);
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппыС3);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Приложение7" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы7);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Приложение8" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппы81);
	ИначеЕсли ИмяТекущейСтраницыПанели = "Филиалы" Тогда
		ИмяГруппы.Добавить(ИдГрупп.мИдГруппыФ1);
	КонецЕсли;

	Возврат ИмяГруппы;

КонецФункции // ОпределитьИдМногострочногоРазделаПоАктивнойСтранице()

&НаСервере
Процедура УстановитьФорматВыводаВПоляхВводаНаСервере(НаимРаздела)
	
	УстановитьФорматВыводаВПоляхВвода(ЭтаФорма, НаимРаздела);
	
КонецПроцедуры // УстановитьФорматВыводаВПоляхВводаНаСервере()

&НаКлиентеНаСервереБезКонтекста
Процедура УстановитьФорматВыводаВПоляхВвода(Форма, НаимРаздела) Экспорт
	Перем СтруктураГруппы;

	Если Форма.СтруктураРеквизитовФормы.ЕдиницаИзмерения = Форма.ПорядкиОкругленияОтчетности.ПеречислениеПорядкиОкругленияОтчетностиОкр1 Тогда
		Форма.СтруктураРеквизитовФормы.мСтрокаФормата = "; ЧДЦ = " + Форма.СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения + "; ЧРД=,; ЧН=-; ЧС = 0";
	ИначеЕсли Форма.СтруктураРеквизитовФормы.ЕдиницаИзмерения = Форма.ПорядкиОкругленияОтчетности.ПеречислениеПорядкиОкругленияОтчетностиОкр1000 Тогда
		Форма.СтруктураРеквизитовФормы.мСтрокаФормата = "; ЧДЦ = " + Форма.СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения + "; ЧРД=,; ЧН=-; ЧС = 3";
	ИначеЕсли Форма.СтруктураРеквизитовФормы.ЕдиницаИзмерения = Форма.ПорядкиОкругленияОтчетности.ПеречислениеПорядкиОкругленияОтчетностиОкр1000000 Тогда
		Форма.СтруктураРеквизитовФормы.мСтрокаФормата = "; ЧДЦ = " + Форма.СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения + "; ЧРД=,; ЧН=-; ЧС = 6";
	КонецЕсли;

	Для Каждого СтрПоказатели Из Форма.мТаблицаСоставПоказателей Цикл

		Если НЕ НаимРаздела = СтрПоказатели.ИмяПоляТаблДокумента Тогда
			Продолжить;
		КонецЕсли;
		
		КодПоказателя				= СокрП(СтрПоказатели.КодПоказателяПоСоставу);
		ПризнМногострочность		= СокрП(СтрПоказатели.ПризнМногострочности);
		КодПоказателяПоСтруктуре	= СокрП(СтрПоказатели.КодПоказателяПоСтруктуре);
		КодПоказателяПоФорме		= СокрП(СтрПоказатели.КодПоказателяПоФорме);
		ТипДанныхПоказателя			= СокрП(СтрПоказатели.ТипДанныхПоказателя);
		ИмяПоказателя				= ?(ПустаяСтрока(СтрПоказатели.КодПоказателяПоФорме), КодПоказателя, КодПоказателяПоФорме);

		Если ПустаяСтрока(КодПоказателя) ИЛИ КодПоказателя = "===" ИЛИ КодПоказателя = "###" ИЛИ Лев(СокрЛ(КодПоказателя), 2) = "//" Тогда
			Продолжить;
		КонецЕсли;

		Если ТипДанныхПоказателя = "Е" И ПустаяСтрока(КодПоказателяПоСтруктуре) Тогда
			ТекТабличноеПоле = Форма.ТабличныйДокумент;
			Если ПризнМногострочность <> "/" Тогда
				ФорматируемаяОбласть = ТекТабличноеПоле.Области[ИмяПоказателя];
				ДопустимыйЗнакПоказателя = ФорматируемаяОбласть.ТипЗначения.КвалификаторыЧисла.ДопустимыйЗнак;
				ЧислоЕЗнак = ПолучитьОписаниеТипаЧислаЕДляРаздела(НаимРаздела);
				ФорматируемаяОбласть.ТипЗначения = Новый ОписаниеТипов(ФорматируемаяОбласть.ТипЗначения,,,Новый КвалификаторыЧисла(ЧислоЕЗнак.КвалификаторыЧисла.Разрядность,ЧислоЕЗнак.КвалификаторыЧисла.РазрядностьДробнойЧасти, ДопустимыйЗнакПоказателя));
				
				ФорматируемаяОбласть.Формат = "ЧЦ = " + ЧислоЕЗнак.КвалификаторыЧисла.Разрядность + Форма.СтруктураРеквизитовФормы.мСтрокаФормата;
			Иначе
				// определяем кол-во строк многострочного раздела и применяем процедуру форматирования к данной графе по всем строкам
				НСтр = 1;
				Пока ТекТабличноеПоле.Области.Найти(ИмяПоказателя + "_" + Формат(НСтр, "ЧГ=0")) <> Неопределено Цикл
					ФорматируемаяОбласть = ТекТабличноеПоле.Области[ИмяПоказателя + "_" + Формат(НСтр, "ЧГ=0")];
					ДопустимыйЗнакПоказателя = ФорматируемаяОбласть.ТипЗначения.КвалификаторыЧисла.ДопустимыйЗнак;
					
					ЧислоЕЗнак = ПолучитьОписаниеТипаЧислаЕДляРаздела(НаимРаздела);
					ФорматируемаяОбласть.ТипЗначения = Новый ОписаниеТипов(ФорматируемаяОбласть.ТипЗначения,,,Новый КвалификаторыЧисла(ЧислоЕЗнак.КвалификаторыЧисла.Разрядность,ЧислоЕЗнак.КвалификаторыЧисла.РазрядностьДробнойЧасти, ДопустимыйЗнакПоказателя));
					
					ФорматируемаяОбласть.Формат = "ЧЦ = " + ЧислоЕЗнак.КвалификаторыЧисла.Разрядность + Форма.СтруктураРеквизитовФормы.мСтрокаФормата;
					НСтр = НСтр + 1;
				КонецЦикла;
			КонецЕсли;
		КонецЕсли;
		
	КонецЦикла;
	

КонецПроцедуры // УстановитьФорматВыводаВПоляхВвода()

&НаСервере
Процедура ЗаполнитьДатуПодписиНаСервере()

	ЗаполнитьДатуПодписи(ЭтаФорма);	

КонецПроцедуры

&НаСервереБезКонтекста
Процедура ЗаполнитьДатуПодписи(Форма)

	ЗаполнитьПоказательНаСервере("HFILL",  Форма.ДатаПодписи, Форма, "СлужебныеДанные");
	
	ПроставитьВКвадратыЗначенияНаВсехЗакладках(Форма, "Д_",        8, Формат(Форма.ДатаПодписи, "ДФ=ddMMyyyy"),  Ложь,,"");		
	
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Процедура ЗаполнитьШапкуПодписиПриложенияПН(Форма)

	HZ   = ПолучитьПоказательНаСервере("HZ",	Форма,"Декларация");
	HZN  = ПолучитьПоказательНаСервере("HZN",	Форма,"Декларация");
	HZU  = ПолучитьПоказательНаСервере("HZU",	Форма,"Декларация");
	
	HTIN = ПолучитьПоказательНаСервере("HTIN",	Форма,"Декларация");
	
	HZY  = ПолучитьПоказательНаСервере("HZY",	Форма,"Декларация");
	
	H1KV = ПолучитьПоказательНаСервере("H1KV",	Форма,"Декларация");
	HHY  = ПолучитьПоказательНаСервере("HHY",	Форма,"Декларация");
	H3KV = ПолучитьПоказательНаСервере("H3KV",	Форма,"Декларация");
	HHY  = ПолучитьПоказательНаСервере("HHY",	Форма,"Декларация");
	
	HBOS = ПолучитьПоказательНаСервере("HBOS",	Форма,"Декларация");
	HBUH = ПолучитьПоказательНаСервере("HBUH",	Форма,"Декларация");
	
	ЗаполнитьПоказательНаСервере("HZ",   HZ, 	Форма, "ПриложениеПН");
	ЗаполнитьПоказательНаСервере("HZN",  HZN, 	Форма, "ПриложениеПН");
	ЗаполнитьПоказательНаСервере("HZU",  HZU, 	Форма, "ПриложениеПН");
	
	ЗаполнитьПоказательНаСервере("HTIN", HTIN, 	Форма, "ПриложениеПН");
	
	ЗаполнитьПоказательНаСервере("HZY",  HZY, 	Форма, "ПриложениеПН");
	
	ЗаполнитьПоказательНаСервере("H1KV", H1KV, 	Форма, "ПриложениеПН");
	ЗаполнитьПоказательНаСервере("HHY",  HHY, 	Форма, "ПриложениеПН");
	ЗаполнитьПоказательНаСервере("H3KV", H3KV, 	Форма, "ПриложениеПН");
	ЗаполнитьПоказательНаСервере("HHY",  HHY, 	Форма, "ПриложениеПН");
	
	ЗаполнитьПоказательНаСервере("HBOS", HBOS, 	Форма, "ПриложениеПН");
	ЗаполнитьПоказательНаСервере("HBUH", HBUH, 	Форма, "ПриложениеПН");
	
КонецПроцедуры

&НаСервере
Процедура ПоказатьПериод()
	
	// задаем заголовок формы
	СтруктураРеквизитовФормы.СтрПериодОтчета = ПредставлениеПериода(НачалоМесяца(СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета), КонецДня(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета), "ФП = Истина");
	
КонецПроцедуры // ПоказатьПериод()

// УстановитьЦветФонаЯчейкиНаКлиенте()
//
&НаКлиенте
Процедура УстановитьЦветФонаЯчейкиНаКлиенте(ИмяЯчейки = Неопределено, ВариантЗаполнения = Неопределено, ИмяТекущейСтраницыПанели = "") Экспорт
	
	УстановитьЦветФонаЯчейки(ЭтаФорма, ИмяЯчейки, ВариантЗаполнения, ИмяТекущейСтраницыПанели);
	
КонецПроцедуры // УстановитьЦветФонаЯчейкиНаКлиенте()

// Процедура управляет цветом фона автозаполняемых ячеек при:
//  а) автозаполнении;
//  б) ручном выборе другого варианта заполнения;
//  в) добавлении/удалении и листании дополнительных страниц.
//
// Цвет фона устанавливается в зависимости от варианта заполнения ячейки.
//
// Параметры:
//  ИмяЯчейки                - строка, имя ячейки, для которой устанавливаем цвет фона;
//  ВариантЗаполнения        - число,  вариант заполнения ячейки;
//  ИмяТекущейСтраницыПанели - строка, имя страницы основной панели, на которой для всех автозаполняемых
//                             ячеек табличного документа следует установить цвет фона.
//
&НаСервере
Процедура УстановитьЦветФонаЯчейкиНаСервере(ИмяЯчейки = Неопределено, ВариантЗаполнения = Неопределено, ИмяТекущейСтраницыПанели = "") Экспорт
	
	УстановитьЦветФонаЯчейки(ЭтаФорма, ИмяЯчейки, ВариантЗаполнения, ИмяТекущейСтраницыПанели);
	
КонецПроцедуры // УстановитьЦветФонаЯчейкиНаСервере()

// Процедура управляет цветом фона автозаполняемых ячеек при:
//  а) автозаполнении;
//  б) ручном выборе другого варианта заполнения;
//  в) добавлении/удалении и листании дополнительных страниц.
//
// Цвет фона устанавливается в зависимости от варианта заполнения ячейки.
//
// Параметры:
//  ИмяЯчейки                - строка, имя ячейки, для которой устанавливаем цвет фона;
//  ВариантЗаполнения        - число,  вариант заполнения ячейки;
//  ИмяТекущейСтраницыПанели - строка, имя страницы основной панели, на которой для всех автозаполняемых
//                             ячеек табличного документа следует установить цвет фона.
&НаКлиентеНаСервереБезКонтекста
Процедура УстановитьЦветФонаЯчейки(Форма, ИмяЯчейки = Неопределено, ВариантЗаполнения = Неопределено, ИмяТекущейСтраницыПанели = "") Экспорт
	
	Перем ЦветФона;
	Перем Комментарий;

	// Не нужно разукрашивать табличные поля, если открывается без открытия формы (например печать или просмотр)
	Если Форма.СтруктураРеквизитовФормы.мБезОткрытияФормы ИЛИ Форма.СтруктураРеквизитовФормы.мРежимПечати Тогда
		Возврат;
	КонецЕсли;

	Если Не ИмяЯчейки = Неопределено Тогда
		// устанавливаем цвет фона конкретной ячейки
		#Если НаКлиенте Тогда
			ИмяСтраницыПанели = РегламентированнаяОтчетностьКлиент.ОпределитьСтраницуПанелиПоКодуПоказателяНаКлиенте(Форма, ИмяЯчейки);
		#Иначе
			ИмяСтраницыПанели = РегламентированнаяОтчетностьВызовСервера.ОпределитьСтраницуПанелиПоКодуПоказателяНаСервере(Форма, ИмяЯчейки);
		#КонецЕсли
		Если ИмяСтраницыПанели = Неопределено Тогда
			Возврат;
		КонецЕсли;

		ИмяПоляТаблДокумента = "ТабличныйДокумент";

		Ключ = "_" + ВариантЗаполнения;
		Форма.мСтруктураЦветовРаскраски.Свойство(Ключ, ЦветФона);

		// КодПоказателяПоСтруктуре
		ЗначениеВКвадратах = РегламентированнаяОтчетностьКлиентСервер.ОбластьЯвляетсяЯчейкойСоставногоПоля(Форма, ИмяЯчейки);

		Если ВариантЗаполнения = 4 ИЛИ ВариантЗаполнения = 5 Тогда

			Если ЗначениеВКвадратах Тогда
				// если ЗНАЧЕНИЕ КВАДРАТИЧНОЕ
				РегламентированнаяОтчетностьКлиентСервер.СвойстваГрупповыхЗначений(Форма, ИмяЯчейки, "УстановитьЗащиту");
			Иначе
				Форма[ИмяПоляТаблДокумента].Области[ИмяЯчейки].Защита = Истина;
			КонецЕсли;

		Иначе

			Если ЗначениеВКвадратах Тогда
				// если ЗНАЧЕНИЕ КВАДРАТИЧНОЕ
				РегламентированнаяОтчетностьКлиентСервер.СвойстваГрупповыхЗначений(Форма, ИмяЯчейки, "СнятьЗащиту");
			Иначе
				Форма[ИмяПоляТаблДокумента].Области[ИмяЯчейки].Защита = Ложь;
			КонецЕсли;
			
		КонецЕсли;

		// установим цвет ячейки
		Если ЗначениеВКвадратах Тогда
			РегламентированнаяОтчетностьКлиентСервер.СвойстваГрупповыхЗначений(Форма, ИмяЯчейки, "ПроставитьЦветРаскраски", ЦветФона);
		Иначе
			Форма[ИмяПоляТаблДокумента].Области[ИмяЯчейки].ЦветФона = ЦветФона;
		КонецЕсли;

	Иначе
		// устанавливаем цвет фона всех автозаполняемых ячеек активной страницы

		#Если НаКлиенте Тогда
			ТаблицаВариантыЗаполнения = РегламентированнаяОтчетностьКлиент.ПолучитьТаблицуВариантовЗаполненияНаКлиенте(Форма, ИмяТекущейСтраницыПанели);
		#Иначе
			ТаблицаВариантыЗаполнения = РегламентированнаяОтчетностьВызовСервера.ПолучитьТаблицуВариантовЗаполненияНаСервере(Форма, ИмяТекущейСтраницыПанели);
		#КонецЕсли
		
		Если ТаблицаВариантыЗаполнения = Неопределено Тогда
			Возврат;
		КонецЕсли;

		Для Каждого Строка Из ТаблицаВариантыЗаполнения Цикл
			ИмяПоказателя            =  Строка.КодПоказателя;
			ВариантЗаполнения        =  Строка.ВариантЗаполнения;
			Комментарий              =  Строка.Комментарий;
			КодПоказателяПоСтруктуре =  Строка.КодПоказателяПоСтруктуре;

			КолвоСтрокВМногострочнойЧасти = РегламентированнаяОтчетностьКлиентСервер.ПоказательВходитВМногострочнуюЧасть(Форма, ИмяПоказателя);
			
			Если КолвоСтрокВМногострочнойЧасти > 0 Тогда
				Многострочность = Истина;
				БазоваяЧасть = ИмяПоказателя;
				ОписанияБлоков = РегламентированнаяОтчетностьКлиентСервер.ПолучитьСвойствоРаздела(Форма, ИмяТекущейСтраницыПанели, "МногострочностьВРазделе");

				Если ТипЗнч(ОписанияБлоков) = Тип("Число") Тогда
					ВБлокеВсеПоказателиЗаполняются = Истина;
				ИначеЕсли ТипЗнч(ОписанияБлоков) = Тип("ДанныеФормыКоллекция") Тогда
					ИмяГруппы = Сред(ИмяПоказателя, 1, 11);
					
					ПозицияXXXX = Найти(ИмяПоказателя, "XXXX");
					Если ПозицияXXXX = 0 Тогда
						ВБлокеВсеПоказателиЗаполняются = Истина;
					Иначе
						ИмяГруппы = Лев(ИмяПоказателя, ПозицияXXXX - 1);
						ВБлокеВсеПоказателиЗаполняются = НЕ ОписанияБлоков.НайтиСтроки(Новый Структура("ИдГруппы", ИмяГруппы))[0].НезаполняемыеПоказателиЕсть;
					КонецЕсли;
					
				КонецЕсли;

			Иначе
				Многострочность = Ложь;
				ВБлокеВсеПоказателиЗаполняются = Истина;
				КолвоСтрокВМногострочнойЧасти = 1;
			КонецЕсли;

			Для Инд = 1 по КолвоСтрокВМногострочнойЧасти Цикл

				Если Многострочность Тогда
					ИмяПоказателя = БазоваяЧасть + "_" + Формат(Инд, "ЧГ=0");
				КонецЕсли;

				ТекОбластьЯчеек = Форма.ТабличныйДокумент.Области[ИмяПоказателя];
				Если (Не ПустаяСтрока(Комментарий)) ИЛИ (Не ПустаяСтрока(ТекОбластьЯчеек.Примечание.Текст)) Тогда
					ТекОбластьЯчеек.Примечание.Текст = Комментарий;
				КонецЕсли;

				Ключ = "_" + ВариантЗаполнения;
				Форма.мСтруктураЦветовРаскраски.Свойство(Ключ, ЦветФона);

				ЗначениеВКвадратах = ?(ПустаяСтрока(КодПоказателяПоСтруктуре), Ложь, Истина);

				Если ВариантЗаполнения = 4 ИЛИ ВариантЗаполнения = 5 Тогда

					Если ЗначениеВКвадратах Тогда
						// если ЗНАЧЕНИЕ КВАДРАТИЧНОЕ
						РегламентированнаяОтчетностьКлиентСервер.СвойстваГрупповыхЗначений(Форма, ИмяПоказателя, "УстановитьЗащиту");
					Иначе
						Форма.ТабличныйДокумент.Области[ИмяПоказателя].Защита = Истина;
					КонецЕсли;

				Иначе

					Если ЗначениеВКвадратах Тогда
						// если ЗНАЧЕНИЕ КВАДРАТИЧНОЕ
						РегламентированнаяОтчетностьКлиентСервер.СвойстваГрупповыхЗначений(Форма, ИмяПоказателя, "СнятьЗащиту");
					Иначе
						Форма.ТабличныйДокумент.Области[ИмяПоказателя].Защита = Ложь;
					КонецЕсли;
				КонецЕсли;

				Если ЗначениеВКвадратах Тогда
					РегламентированнаяОтчетностьКлиентСервер.СвойстваГрупповыхЗначений(Форма, ИмяПоказателя, "ПроставитьЦветРаскраски", ЦветФона);
				Иначе
					Форма.ТабличныйДокумент.Области[ИмяПоказателя].ЦветФона = ЦветФона;
				КонецЕсли;
			КонецЦикла;

		КонецЦикла;
		
	КонецЕсли;
	
КонецПроцедуры // УстановитьЦветФонаЯчейки()

&НаКлиентеНаСервереБезКонтекста
Функция ПоказательВходитВМногострочнуюЧасть(Форма, ИмяПоказателя) Экспорт
    	
	ПозицияXXXX = Найти(ИмяПоказателя, "XXXX");
	Если ПозицияXXXX > 0 Тогда
		
		ИмяГруппы = Лев(ИмяПоказателя, ПозицияXXXX - 1);

	Иначе
		
		Возврат 0;
		
	КонецЕсли;
	
	СтруктураГруппы = Неопределено;

	Если НЕ Форма.мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы) Тогда
		Возврат 0;
	Иначе
		СтруктураГруппы = Форма[СтруктураГруппы];
		Возврат СтруктураГруппы.Количество();
	КонецЕсли;

КонецФункции


// ЗаполнитьСведенияОбОрганизацииНаСервере()
//
&НаСервере
Процедура ЗаполнитьСведенияОбОрганизацииНаСервере()
	
	ЗаполнитьСведенияОбОрганизации(ЭтаФорма);
		
КонецПроцедуры // ЗаполнитьСведенияОбОрганизацииНаСервере()

&НаСервереБезКонтекста
Процедура ЗаполнитьСведенияОбОрганизации(Форма)
	
	ЗаполнитьПоказательНаВсехЗакладках("HZ", "X", Форма, "|Филиалы|Заявление|");
	
	ГодОтчета   = Формат(Год(Форма.СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета),   "ЧГ=0");
	Если Форма.СтруктураРеквизитовФормы.мПериодичность = Форма.ПеречислениеПериодичностьМесяц Тогда
	    МесяцОтчета = Формат(Месяц(Форма.СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета), "ЧЦ=2; ЧВН=");
		КварталОтчета = "";
	Иначе	
		МесяцОтчета = "";
		КварталОтчета = Месяц(КонецКвартала(Форма.СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета))/3;
	КонецЕсли;
	
	ЗаполнитьПоказательНаСервере("HZY", ГодОтчета, Форма, "СлужебныеДанные");
	ПроставитьВКвадратыЗначенияНаВсехЗакладках(Форма, "Год_",  4, ГодОтчета, Ложь,,"");	
	
	ЗаполнитьПоказательНаСервере("HZM", МесяцОтчета, Форма, "СлужебныеДанные");
	ПроставитьВКвадратыЗначенияНаВсехЗакладках(Форма, "Мес_",  2, МесяцОтчета, Ложь,,"");	
	
	ЗаполнитьПоказательНаСервере("HZKV", КварталОтчета, Форма, "СлужебныеДанные");
	ЗаполнитьПоказательНаВсехЗакладках("Кв", КварталОтчета, Форма);

	Организация 				= Форма.СтруктураРеквизитовФормы.Организация;	
	ЗаполнитьПоказательНаВсехЗакладках("HNAME", Организация.НаименованиеПолное, Форма);
	
	СписокПоказателей = Новый СписокЗначений;
	СписокПоказателей.Добавить("","КодПоЕДРПОУ");
	СписокПоказателей.Добавить("","ИНН");
	СписокПоказателей.Добавить("","НалоговаяИнспекция");
	СписокПоказателей.Добавить("","ЮридическийАдрес");
	СписокПоказателей.Добавить("","Email");
	СписокПоказателей.Добавить("","Телефон");
	СписокПоказателей.Добавить("","Факс");
	СписокПоказателей.Добавить("","Индекс");

	Сведения = РегламентированнаяОтчетностьВызовСервера.ПолучитьСведенияОбОрганизации(Организация, Форма.СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета, СписокПоказателей);
	КодЕДРПОУ          = Сведения.КодПоЕДРПОУ;
	ИНН                = Сведения.ИНН;
	НалоговаяИнспекция = Сведения.НалоговаяИнспекция;
	ЮридическийАдрес   = Сведения.ЮридическийАдрес;
	HEMAIL  		   = Сведения.Email;	
	Телефон  	       = Сведения.Телефон;	
	Факс  		       = Сведения.Факс;	
	Индекс  		   = Сведения.Индекс;	
	
	ЗаполнитьПоказательНаСервере("TIN",  КодЕДРПОУ, Форма, "СлужебныеДанные");
	ЗаполнитьПоказательНаВсехЗакладках("HTIN", КодЕДРПОУ, Форма);
	
	ЗаполнитьПоказательНаВсехЗакладках("HNPDV", ИНН, Форма);
	
	ЗаполнитьПоказательНаСервере("HZIP", Индекс, Форма, "СлужебныеДанные");
	РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Декларация", "Инд_",  5, Индекс, Ложь);		

	ЗаполнитьПоказательНаСервере("HLOC", ЮридическийАдрес, Форма, "Декларация");

	ЗаполнитьПоказательНаСервере("HTEL", Телефон, Форма, "Декларация");
	
	ЗаполнитьПоказательНаСервере("HFAX", Факс,    Форма, "Декларация");
	   
	ЗаполнитьПоказательНаСервере("HEMAIL", HEMAIL, Форма, "Декларация");
		
	// налоговая инспекция из справочника налоговых инспекций
	Если ЗначениеЗаполнено(НалоговаяИнспекция) Тогда 
		ЗаполнитьПоказательНаСервере("HSTI", НалоговаяИнспекция.Наименование, 	Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("HSTI", НалоговаяИнспекция.Наименование, 	Форма, "Филиалы");
		ЗаполнитьПоказательНаСервере("HSTI", НалоговаяИнспекция.Наименование, 	Форма, "Приложение10");
		ЗаполнитьПоказательНаСервере("HSTI", НалоговаяИнспекция.Наименование, 	Форма, "Заявление");
		ЗаполнитьПоказательНаСервере("C_RAJ", НалоговаяИнспекция.КодАдмРайона, 	Форма, "СлужебныеДанные");
		ЗаполнитьПоказательНаСервере("C_REG", НалоговаяИнспекция.Родитель.Код, 	Форма, "СлужебныеДанные");
		ЗаполнитьПоказательНаСервере("C_STI_ORIG", НалоговаяИнспекция.Код, 		Форма, "СлужебныеДанные");
		ЗаполнитьПоказательНаСервере("C_STI", НалоговаяИнспекция.Код, 			Форма, "СлужебныеДанные");
	КонецЕсли;
	
	ЗаполнитьПоказательНаСервере("C_DOC_TYPE", 0, Форма, "СлужебныеДанные"); //номер исправленного доекумента. Для первого подающегося документа  = 0
	ЗаполнитьПоказательНаСервере("C_DOC_CNT",  1, Форма, "СлужебныеДанные");;
	ЗаполнитьПоказательНаВсехЗакладках("C_DOC_STAN", 1, Форма);
	
	СписокПоказателей = Новый СписокЗначений;
	СписокПоказателей.Добавить("","ФИОРук");
	СписокПоказателей.Добавить("","ФИОБух");
	СписокПоказателей.Добавить("","ИННРук");
	СписокПоказателей.Добавить("","ИННБух");
	СведенияДатаПодписи = РегламентированнаяОтчетностьВызовСервера.ПолучитьСведенияОбОрганизации(Организация, Форма.ДатаПодписи, СписокПоказателей);
	
	ФИОДиректора       = СведенияДатаПодписи.ФИОРук;
	ФИОГлавБуха        = СведенияДатаПодписи.ФИОБух;
	ИННДиректора       = СведенияДатаПодписи.ИННРук;
	ИННГлавБуха        = СведенияДатаПодписи.ИННБух;
	
	ФИОДиректора 		= РегламентированнаяОтчетностьВызовСервера.ПолучитьСведенияОбОрганизации(Организация, Форма.ДатаПодписи, СписокПоказателей).ФИОРук;
	// преобразуем ФИО в ИОФ :)
	ПозицияТочки = Найти(ФИОДиректора, ".");
	Если ПозицияТочки > 0 Тогда
		ФИОДиректора = Сред(ФИОДиректора, ПозицияТочки - 1) + " " + Лев(ФИОДиректора, ПозицияТочки - 3);	
	КонецЕсли;
	
	ФИОГлавБуха 		= РегламентированнаяОтчетностьВызовСервера.ПолучитьСведенияОбОрганизации(Организация, Форма.ДатаПодписи, СписокПоказателей).ФИОБух;
	// преобразуем ФИО в ИОФ
	ПозицияТочки = Найти(ФИОГлавБуха, ".");
	Если ПозицияТочки > 0 Тогда
		ФИОГлавБуха = Сред(ФИОГлавБуха, ПозицияТочки - 1) + " " + Лев(ФИОГлавБуха, ПозицияТочки - 3);	
	КонецЕсли;
	
	ЗаполнитьПоказательНаСервере("HKBOS",  ИННДиректора, Форма, "СлужебныеДанные");
	ЗаполнитьПоказательНаСервере("HKBUH",  ИННГлавБуха,  Форма, "СлужебныеДанные");
	
	ЗаполнитьПоказательНаВсехЗакладках("HBOS", ФИОДиректора, Форма);
	ЗаполнитьПоказательНаВсехЗакладках("HBUH", ФИОГлавБуха, Форма);
	
	Если Форма.СтруктураРеквизитовФормы.мПериодичность = Форма.ПеречислениеПериодичностьМесяц   Тогда    
		ЗаполнитьПоказательНаСервере("PERIOD_MONTH", МесяцОтчета, Форма, "СлужебныеДанные");
		ЗаполнитьПоказательНаСервере("PERIOD_TYPE",  1,  		  Форма, "СлужебныеДанные");
	Иначе   
		ЗаполнитьПоказательНаСервере("PERIOD_MONTH", КварталОтчета*3, Форма, "СлужебныеДанные");
		ЗаполнитьПоказательНаСервере("PERIOD_TYPE",  2,  		  Форма, "СлужебныеДанные");
	КонецЕсли;
	ЗаполнитьПоказательНаСервере("PERIOD_YEAR", ГодОтчета, Форма, "СлужебныеДанные");
	
	ЗаполнитьДатуПодписи(Форма);
	
	ПроставитьВКвадратыЗначенияНаВсехЗакладках(Форма, "ИННРук_",  10, ИННДиректора, Ложь,,"");	
	ПроставитьВКвадратыЗначенияНаВсехЗакладках(Форма, "ИННГБ_",   10, ИННГлавБуха,  Ложь,,"");	
	
	Форма.Модифицированность = Истина;

КонецПроцедуры

&НаСервере
Процедура ЗаполнитьПоказательНаВсехЗакладкахНаСервере(СписокЗначений, СписокИсключений = "")
	
	Для каждого УстанавливаемоеЗначение Из СписокЗначений Цикл
	
		ЗаполнитьПоказательНаВсехЗакладках(УстанавливаемоеЗначение.Представление, УстанавливаемоеЗначение.Значение, ЭтаФорма, СписокИсключений);	
	
	КонецЦикла;
	
КонецПроцедуры

&НаСервереБезКонтекста
Процедура ЗаполнитьПоказательНаВсехЗакладках(ИмяПоказателя, Значение, Форма, СписокИсключений = "")

	Если Найти(СписокИсключений, "|Декларация|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Декларация");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение1|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение1");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение2|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение2");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение3|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение3");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение4|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение4");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение5|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение5");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Справка|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Справка");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение7|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение7");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение8|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение8");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение9|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение9");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение10|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Приложение10");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Заявление|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Заявление");
	КонецЕсли;
	Если Найти(СписокИсключений, "|Филиалы|") = 0 Тогда
		ЗаполнитьПоказательНаСервере(ИмяПоказателя, Значение, Форма, "Филиалы");
	КонецЕсли;

КонецПроцедуры

&НаСервереБезКонтекста
Процедура ПроставитьВКвадратыЗначенияНаВсехЗакладках(Форма, ИмяПоказателя, Длина, Значение, ДополнитьЗначение = Ложь, НольКакНоль = Ложь, СписокИсключений = "")

	Если Найти(СписокИсключений, "|Декларация|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Декларация", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение1|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение1", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение2|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение2", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение3|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение3", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение4|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение4", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение5|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение5", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Справка|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Справка", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение7|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение7", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение8|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение8", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение9|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение9", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Приложение10|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Приложение10", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Заявление|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Заявление", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;
	Если Найти(СписокИсключений, "|Филиалы|") = 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(Форма, "Филиалы", ИмяПоказателя,  Длина, Значение, ДополнитьЗначение, НольКакНоль);		
	КонецЕсли;

КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Процедура ЗаполнитьПоказательНаСервере(ИмяОбласти, Значение, Форма, ИмяРазделаПоказателя);

	ТекРаздел = Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела;

	Если ТекРаздел = ИмяРазделаПоказателя Тогда
		
		Если НЕ Форма.ТабличныйДокумент.Области.Найти(ИмяОбласти) = Неопределено Тогда
		
			Форма.ТабличныйДокумент.Области[ИмяОбласти].Значение = Значение;
		
		КонецЕсли;
		
	Иначе	
		
		Форма["СтруктураДанных" + ИмяРазделаПоказателя].Вставить(ИмяОбласти, Значение);
		
	КонецЕсли;	
	
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Функция ПолучитьПоказательНаСервере(ИмяОбласти, Форма, ИмяРазделаПоказателя)

	ТекРаздел = Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела;

	Если ТекРаздел = ИмяРазделаПоказателя Тогда
		
		Возврат Форма.ТабличныйДокумент.Области[ИмяОбласти].Значение;
		
	Иначе	
		
		Значение = Неопределено;
		Форма["СтруктураДанных" + ИмяРазделаПоказателя].Свойство(ИмяОбласти, Значение);
		
		Если Значение = Неопределено Тогда
			
			ДанныеПоказателя = Форма.мТаблицаСоставПоказателей.НайтиСтроки(Новый Структура("ИмяПоляТаблДокумента, КодПоказателяПоФорме", ИмяРазделаПоказателя, ИмяОбласти));
			Если ДанныеПоказателя.Количество() > 0
				И (    ДанныеПоказателя[0].ТипДанныхПоказателя = "Ч"
				   ИЛИ ДанныеПоказателя[0].ТипДанныхПоказателя = "Е") Тогда
				Значение = 0;	   
			Иначе
				Значение = "";	
			КонецЕсли;
			
		КонецЕсли;
		
		Возврат Значение;
		
	КонецЕсли;	

КонецФункции // ()

// СобратьДанныеТекущегоТаблПоляНаСервере()
//
&НаСервере
Функция СобратьДанныеТекущегоТаблПоляНаСервере(ИмяТабличногоПоля) Экспорт
	
	Возврат СобратьДанныеТекущегоТаблПоля(ЭтаФорма, ИмяТабличногоПоля);

КонецФункции // СобратьДанныеТекущегоТаблПоляНаСервере()

// СобратьДанныеТекущегоТаблПоляНаКлиенте()
//
&НаКлиенте
Функция СобратьДанныеТекущегоТаблПоляНаКлиенте(ИмяТабличногоПоля) Экспорт
	
	Возврат СобратьДанныеТекущегоТаблПоля(ЭтаФорма, ИмяТабличногоПоля);
	
КонецФункции // СобратьДанныеТекущегоТаблПоляНаКлиенте()

&НаКлиентеНаСервереБезКонтекста
Функция СобратьДанныеТекущегоТаблПоля(Форма, ТабличноеПоле) Экспорт

	СтруктураДанныхПоля = Новый Структура;
	Для Каждого ТекущаяОбласть Из Форма[ТабличноеПоле].Области Цикл
		Если ТекущаяОбласть.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник И ТекущаяОбласть.СодержитЗначение = Истина Тогда
			СтруктураДанныхПоля.Вставить(ТекущаяОбласть.Имя, ТекущаяОбласть.Значение);
		КонецЕсли;
	КонецЦикла;
	
	Возврат СтруктураДанныхПоля;

КонецФункции // СобратьДанныеТекущегоТаблПоля()

// Обновляет структуру многострочнго раздела, заданного
// уникальным идентификатором. Заполняет таблицу значений
// многострочного раздела значениями соответствующих ячеек.
//
// Параметры:
//  ИмяГруппы - строка - идентификатор многострочного раздела.
//
&НаСервере
Процедура ОбновитьСтруктуруМногострочногоРазделаНаСервере(ИмяГруппы) Экспорт
	РегламентированнаяОтчетностьКлиентСервер.ОбновитьСтруктуруМногострочногоРаздела(ЭтаФорма, ИмяГруппы);
КонецПроцедуры // ОбновитьСтруктуруМногострочногоРазделаНаСервере()

// ОбновитьСтруктуруМногострочногоРазделаНаКлиенте()
//
&НаКлиенте
Процедура ОбновитьСтруктуруМногострочногоРазделаНаКлиенте(ИмяГруппы) Экспорт
	РегламентированнаяОтчетностьКлиентСервер.ОбновитьСтруктуруМногострочногоРаздела(ЭтаФорма, ИмяГруппы);
КонецПроцедуры // ОбновитьСтруктуруМногострочногоРазделаНаКлиенте()

// Восстанавливает сохраненные данные отчета.
//
&НаСервере
Процедура ВосстановитьСохраненныеДанные()
	Перем ДанныеМногострочныхРазделов;
	Перем ДанныеМногостраничныхРазделов;
	Перем ДанныеВариановАвтоЗаполнения;
	Перем ПоказателиОтчета;
	Перем Автозаполнение;
	Перем ТаблицаМногостраничногоДокумента;
    Перем ЕстьДуплекс;
	
	Если НЕ ЗначениеЗаполнено(СтруктураРеквизитовФормы.Организация) Тогда
		СтруктураРеквизитовФормы.Организация =	СтруктураРеквизитовФормы.мСохраненныйДок.Организация;
	КонецЕсли;
	
	ДатаПодписи			                              = СтруктураРеквизитовФормы.мСохраненныйДок.ДатаПодписи;
	СтруктураРеквизитовФормы.ЕдиницаИзмерения         = СтруктураРеквизитовФормы.мСохраненныйДок.ЕдиницаИзмерения;
	СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения = СтруктураРеквизитовФормы.мСохраненныйДок.ТочностьЕдиницыИзмерения;
	Комментарий					                      = СтруктураРеквизитовФормы.мСохраненныйДок.Комментарий;

	// восстанавливаем сохраненные данные отчета
	СписокСохранения = СтруктураРеквизитовФормы.мСохраненныйДок.ДанныеОтчета.Получить();
	
	// список листов, выводимых на печать
	ДеревоНастройкиСтраниц = СтруктураРеквизитовФормы.мСохраненныйДок.ДеревоНастройкиСтраниц.Получить();
	ЗначениеВРеквизитФормы(ДеревоНастройкиСтраниц.Скопировать(), "мДеревоСтраницОтчета");
	
	// восстанавливаем сохраненные данные многострочных разделов
	Если СписокСохранения.Свойство( "ДанныеМногострочныхРазделов", ДанныеМногострочныхРазделов) Тогда
				
		Для Каждого ЭлементСтруктуры Из ДанныеМногострочныхРазделов Цикл
			
			НайденноеЗначение = Неопределено;
			
			мСтруктураМногострочныхРазделов.Свойство(ЭлементСтруктуры.Ключ, НайденноеЗначение);
			
			Если НЕ НайденноеЗначение = Неопределено Тогда
				
				ЗначениеВДанныеФормы(ЭлементСтруктуры.Значение, ЭтаФорма[НайденноеЗначение]);
				
			КонецЕсли;
						
		КонецЦикла;
						
	КонецЕсли;
    	
	// восстанавливаем сохраненные данные вариантов автозаполнения ячеек
	Если СписокСохранения.Свойство("ДанныеВариантовАвтоЗаполнения", ДанныеВариановАвтоЗаполнения) Тогда
		
		Если НЕ ДанныеВариановАвтоЗаполнения = Неопределено Тогда
			
			мСтруктураВариантыЗаполнения.Очистить();
			
			Для Каждого ЭлементСтруктуры Из ДанныеВариановАвтоЗаполнения Цикл
				
				мСтруктураВариантыЗаполнения.Вставить(ЭлементСтруктуры.Ключ, ЭлементСтруктуры.Ключ);
				
				ЭтаФорма["ТаблицаВариантыЗаполнения" + ЭлементСтруктуры.Ключ].Очистить();
				
				Для Каждого ЭлементМассива Из ЭлементСтруктуры.Значение Цикл
										
					ТаблВарЗаполнения = ЭтаФорма["ТаблицаВариантыЗаполнения" + ЭлементСтруктуры.Ключ].Добавить().ТаблицаВариантовЗаполнения;
										
					ЗначениеВДанныеФормы(ЭлементМассива, ТаблВарЗаполнения);
					
				КонецЦикла;
				
			КонецЦикла;
			
		КонецЕсли;
		
	КонецЕсли;

	// восстановим сохраненные данные редактируемых ячеек
	СписокСохранения.Свойство("ПоказателиОтчета", ПоказателиОтчета);
	
	СписокСохранения.Свойство("СохранятьРасшифровку", СтруктураРеквизитовФормы.мСохранятьРасшифровку);
	Если СтруктураРеквизитовФормы.мСохранятьРасшифровку = Неопределено Тогда
		СтруктураРеквизитовФормы.мСохранятьРасшифровку = Истина;
	КонецЕсли;
	
	СписокСохранения.Свойство("Расшифровка", ТаблицаРасшифровки);
	Если ТипЗнч(ТаблицаРасшифровки) = Тип("ТаблицаЗначений") Тогда
		СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки = ПоместитьВоВременноеХранилище(ТаблицаРасшифровки, УникальныйИдентификатор);
		Элементы.Расшифровать.Доступность = Истина;
	КонецЕсли;
	
	Если НЕ СписокСохранения.Свойство("ОтчетЗаДваМесяца", 	   СтруктураРеквизитовФормы.ОтчетЗаДваМесяца) Тогда
		СтруктураРеквизитовФормы.ОтчетЗаДваМесяца = Ложь;	
	КонецЕсли;	
	Если НЕ СписокСохранения.Свойство("СпецРежим", 	   СтруктураРеквизитовФормы.СпецРежим) Тогда
		СтруктураРеквизитовФормы.СпецРежим = 0;	
	КонецЕсли;
	
	//ИНАГРО ++
	Если НЕ СписокСохранения.Свойство("К1", 	   СтруктураРеквизитовФормы.К1) Тогда
		СтруктураРеквизитовФормы.К1 = 0;	
	КонецЕсли;
	Если НЕ СписокСохранения.Свойство("К2", 	   СтруктураРеквизитовФормы.К2) Тогда
		СтруктураРеквизитовФормы.К2 = 0;	
	КонецЕсли;
	Если НЕ СписокСохранения.Свойство("К3", 	   СтруктураРеквизитовФормы.К3) Тогда
		СтруктураРеквизитовФормы.К3 = 0;	
	КонецЕсли;
	//ИНАГРО --
	
	Если НЕ СписокСохранения.Свойство("НеВыдаватьСообщенияОбОшибкахВРасчете", СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете) Тогда
		СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете = Ложь;
	КонецЕсли;	

	// восстанавливаем сохраненные данные многостраничных разделов
	Если СписокСохранения.Свойство("ДанныеМногостраничныхРазделов", ДанныеМногостраничныхРазделов) Тогда
		
		Для Каждого ЭлементСтруктуры Из ДанныеМногостраничныхРазделов Цикл
					
			НайденноеЗначение = Неопределено;
			
			мСтруктураМногостраничныхРазделов.Свойство(ЭлементСтруктуры.Ключ, НайденноеЗначение);
			
			Если НЕ НайденноеЗначение = Неопределено Тогда
				
				НайденноеЗначение = ЭтаФорма[НайденноеЗначение];
				
				ЗначениеВДанныеФормы(ЭлементСтруктуры.Значение, НайденноеЗначение);
									 				
				Если НайденноеЗначение[0].Свойство("Данные") Тогда
					
					Для Каждого СтрокаТаблЗнач Из НайденноеЗначение Цикл
						
						Если ТипЗнч(СтрокаТаблЗнач.Данные) = Тип("СписокЗначений") Тогда
							
							СтрокаТаблЗнач.Данные.Очистить();
							СтрокаТаблЗнач.Данные.Добавить(ЭлементСтруктуры.Значение[НайденноеЗначение.Индекс(СтрокаТаблЗнач)].Данные);
							
						КонецЕсли;
						
					КонецЦикла;
					
				КонецЕсли;
				
				Если НайденноеЗначение[0].Свойство("ДополнительныеДанные") Тогда
					
					Для Каждого СтрокаТаблЗнач Из НайденноеЗначение Цикл
						
						Если ТипЗнч(СтрокаТаблЗнач.ДополнительныеДанные) = Тип("СписокЗначений") Тогда
							
							СтрокаТаблЗнач.ДополнительныеДанные.Очистить();
							СтрокаТаблЗнач.ДополнительныеДанные.Добавить(ЭлементСтруктуры.Значение[НайденноеЗначение.Индекс(СтрокаТаблЗнач)].ДополнительныеДанные);
							
						КонецЕсли;
						
					КонецЦикла;
					
				КонецЕсли;
								
				Если НайденноеЗначение[0].Свойство("ДанныеДопСтрок") Тогда
					
					Ном = 0;
					
					Для Каждого СтрокаТаблЗнач Из ЭлементСтруктуры.Значение Цикл
						
						Если ТипЗнч(СтрокаТаблЗнач.ДанныеДопСтрок) = Тип("Структура") Тогда
							
							СтруктураДопСтрок = Новый Структура;
							
							Для Каждого ЭлСтруктуры Из СтрокаТаблЗнач.ДанныеДопСтрок Цикл
								
								ТаблЗнач = ЭлСтруктуры.Значение;
								
								СтрокаТаблЗначДанныеДопСтрок = ЭтаФорма["Хранилище" + ЭлСтруктуры.Ключ].Добавить().Таблица;
								
								ЗначениеВДанныеФормы(ТаблЗнач, СтрокаТаблЗначДанныеДопСтрок);
								
								СтруктураДопСтрок.Вставить(ЭлСтруктуры.Ключ, СтрокаТаблЗначДанныеДопСтрок);
                                								
							КонецЦикла;
							
							НайденноеЗначение[Ном].ДанныеДопСтрок.Добавить(СтруктураДопСтрок, "ДанныеФормыКоллекцияТаблицаДопСтрокРаздела");
							
						КонецЕсли;
						
						Ном = Ном + 1;
						
					КонецЦикла;
					
				КонецЕсли;
								   				
			КонецЕсли;
			
		КонецЦикла;
		
	КонецЕсли;
	
	Для Каждого Раздел Из мСтруктураМногостраничныхРазделов Цикл
		Для Каждого Страница Из ЭтаФорма[Раздел.Значение] Цикл
			Страница.АктивнаяСтраница = Ложь;
		КонецЦикла;
	КонецЦикла;

	СписокСохранения.Свойство("Автозаполнение", Автозаполнение);
	СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет = Автозаполнение;

	СписокСохранения.Свойство("ЕстьДуплекс", ЕстьДуплекс);
	Если ЕстьДуплекс = Неопределено Тогда
		ЕстьДуплекс = Ложь;
	КонецЕсли;
	СтруктураРеквизитовФормы.ЕстьДуплекс = ЕстьДуплекс;
	Элементы.ЕстьДуплекс.Пометка         = ЕстьДуплекс;
	
	СформироватьДеревоРазделовОтчетаНаСервере();
	
	Префикс = "ПолеТабличногоДокумента";
	
	Для Каждого Раздел Из мСвойстваРазделовДекларации.ПолучитьЭлементы() Цикл	
		
		Если НЕ Раздел.МногостраничностьВРазделе Тогда
			ЭтаФорма["СтруктураДанных" + Раздел.ИмяСтраницы] = ПоказателиОтчета[Префикс + Раздел.ИмяСтраницы];
		КонецЕсли;
	
	КонецЦикла;
	ИмяТекРаздела = "Декларация";
	ВывестиМакетВТаблДокНаСервере(ИмяТекРаздела, 1);
	
	РегламентированнаяОтчетность.ОперацииПриВосстановленииРегламентированногоОтчета(ЭтаФорма);

	КопироватьДанныеФормы(мДеревоСтраницОтчета, мДеревоВыбранныхСтраниц);

	Модифицированность   = Ложь;
	
КонецПроцедуры // ВосстановитьСохраненныеДанные()

// ВывестиРазделВТабличныйДокументНаКлиенте()
//
&НаКлиенте
Процедура ВывестиРазделВТабличныйДокументНаКлиенте(ИмяГруппы, СтруктураГруппы) Экспорт
	
	ВывестиРазделВТабличныйДокумент(ЭтаФорма, ИмяГруппы, СтруктураГруппы);
	
КонецПроцедуры // ВывестиРазделВТабличныйДокументНаКлиенте()

// Процедура выводит строки многострочного раздела в табличный документ.
// При отсутствии в табличном документе необходимого количества строк
// добавляет отсутствующие строки.
//
// Параметры:
//  ИмяГруппы       - строка, имя многострочного раздела;
//  СтруктураГруппы - таблица значений, содержащая значения показателей многострочного раздела.
//
&НаСервере
Процедура ВывестиРазделВТабличныйДокументНаСервере(ИмяГруппы, СтруктураГруппы) Экспорт
	ВывестиРазделВТабличныйДокумент(ЭтаФорма, ИмяГруппы, СтруктураГруппы);
КонецПроцедуры // ВывестиРазделВТабличныйДокументНаСервере()

// Процедура выводит строки многострочного раздела в табличный документ.
// При отсутствии в табличном документе необходимого количества строк
// добавляет отсутствующие строки.
//
// Параметры:
//  ИмяГруппы       - строка, имя многострочного раздела;
//  СтруктураГруппы - таблица значений, содержащая значения показателей многострочного раздела.
//  ПерерисоватьСтроки - Истина из процедуры удаления доп. строк, для перерисовки областей.
//
&НаКлиентеНаСервереБезКонтекста
Процедура ВывестиРазделВТабличныйДокумент(Форма, ИмяГруппы, СтруктураГруппы, ИмяКолонкиНомера = Неопределено, НомерПервойСтроки = Неопределено)
	Перем ИсходноеКоличествоСтрокГруппы;
	
	#Если НаКлиенте Тогда
		ТекущаяСтраница = Форма.ОпределитьТабличноеПолеПоИдМногострочногоРазделаНаКлиенте(ИмяГруппы);
	#Иначе
		ТекущаяСтраница = Форма.ОпределитьТабличноеПолеПоИдМногострочногоРазделаНаСервере(ИмяГруппы);
	#КонецЕсли
		
	// определим исходное колво строк многострочного раздела,
	// соответствующее бумажной форме отчета
	Форма.мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);
	
	// реальное кол-во строк (колво заполненных строк)
	ТекущееКоличествоСтрокГруппы = СтруктураГруппы.Количество();
		
	ТекТабличноеПолеИмя = "ТабличныйДокумент";
	
	ТекТабличноеПоле = Форма[ТекТабличноеПолеИмя];
		
	ПерерисоватьСтроки = (НЕ ТекущееКоличествоСтрокГруппы > ИсходноеКоличествоСтрокГруппы);
		
	Раздел = Форма[ТекТабличноеПолеИмя];
	
	КолонкиГруппы = Форма.СтруктураРеквизитовФормы.КолонкиМногострочныхРазделов[ИмяГруппы];		
	Если ИмяКолонкиНомера = Неопределено Тогда
		
		Для каждого Колонка Из КолонкиГруппы Цикл
			
			Если Найти(ВРЕГ(Колонка), "НОМЕРСТРОКИ") > 0 Тогда
				ИмяКолонкиНомера = Колонка;	
				Прервать;
			КонецЕсли;
		
		КонецЦикла;
		
	КонецЕсли;
	Если НомерПервойСтроки = Неопределено Тогда
		НомерПервойСтроки = 1;
	КонецЕсли;
	
	// При восстановлении сохраненных данных отчета сравниваем исходное кол-во
	// отображаемых в форме строк многострочного раздела с реальным количеством
	// созданных строк в сохраненном отчете.
	Если ТекущееКоличествоСтрокГруппы > ИсходноеКоличествоСтрокГруппы Тогда
		
		// Режим восстановления многострочных блоков. Из процедуры ВосстановитьСохраненныеДанные.
		НастройкиМнгЧ = РегламентированнаяОтчетностьКлиентСервер.ПолучитьСвойствоРаздела(Форма, ТекущаяСтраница, "МногострочностьВРазделе");
		
		КолонкиМногострочныхРазделов = Форма.СтруктураРеквизитовФормы.КолонкиМногострочныхРазделов;
		ИмяОбластиПечати			 = "";
		
		ДанныеОПечатиОтчета = Форма.мДеревоСтраницОтчета.ПолучитьЭлементы();
		Для Сч = 1 По ДанныеОПечатиОтчета.Количество() Цикл
			ДанныеОПечатиСтраницы = ДанныеОПечатиОтчета[Сч - 1];	
			Если ДанныеОПечатиСтраницы.ИмяСтраницы = ТекущаяСтраница Тогда
				ИмяОбластиПечати = ДанныеОПечатиСтраницы.ИмяОбластиТабличногоПоля;	
				Прервать;
			КонецЕсли;
		КонецЦикла; 
		
		РегламентированнаяОтчетностьВызовСервера.ВывестиРазделВТабличныйДокументНаСервере(НастройкиМнгЧ, ИмяГруппы, Раздел, СтруктураГруппы, КолонкиМногострочныхРазделов, ИмяОбластиПечати);
		
		Форма[ТекТабличноеПолеИмя] = Раздел;
		ТекТабличноеПоле           = Форма[ТекТабличноеПолеИмя];
		
	КонецЕсли;
	
	// выводим значения строк
	Для Каждого СтрокаТаблицы Из СтруктураГруппы Цикл
		НомерСтрокиВТаблице      = СтруктураГруппы.Индекс(СтрокаТаблицы);
		НомерСтрокиВФормеТаблицы = НомерСтрокиВТаблице + 1;
		НомерСтрокиВФормеТаблицыСтр = Формат(НомерСтрокиВФормеТаблицы, "ЧГ=0");
		
		Для Каждого КолонкаТаблицыИмя Из КолонкиГруппы Цикл
			
			Если СтруктураГруппы[0].Свойство(КолонкаТаблицыИмя) Тогда
				
				ЗначениеЯчейки           = СтрокаТаблицы[КолонкаТаблицыИмя];
				ИмяЯчейки                = КолонкаТаблицыИмя + "_" + НомерСтрокиВФормеТаблицыСтр;
				
				ОбластьЯчейкиТаблицы          = ТекТабличноеПоле.Области[ИмяЯчейки];
				
				Если ОбластьЯчейкиТаблицы.СодержитЗначение = Истина Тогда
					ОбластьЯчейкиТаблицы.Значение = ЗначениеЯчейки;
				Иначе
					ОбластьЯчейкиТаблицы.Текст = ЗначениеЯчейки;
				КонецЕсли;
				
			КонецЕсли;
			
		КонецЦикла;

	КонецЦикла;
	
	СтрокВГруппе 		= СтруктураГруппы.Количество();
	СтрокВТабличномПоле = Форма.мСтруктураИсхКолвоСтрокРазделов[ИмяГруппы];
	КоличествоСтрок = МАКС(СтрокВГруппе, СтрокВТабличномПоле);
	Если ИмяКолонкиНомера <> Неопределено Тогда
		
		Для НомерСтрокиВФормеТаблицы = 1 По КоличествоСтрок Цикл
			
			НомерСтрокиВФормеТаблицыСтр = Формат(НомерСтрокиВФормеТаблицы, "ЧГ=0");
			ИмяЯчейки                	= ИмяКолонкиНомера + "_" + НомерСтрокиВФормеТаблицыСтр;
			ОбластьЯчейкиТаблицы     	= ТекТабличноеПоле.Области[ИмяЯчейки];
	
			Если ОбластьЯчейкиТаблицы.СодержитЗначение = Истина Тогда
				ОбластьЯчейкиТаблицы.Значение = НомерСтрокиВФормеТаблицы + НомерПервойСтроки - 1;
			Иначе
				ОбластьЯчейкиТаблицы.Текст = НомерСтрокиВФормеТаблицы + НомерПервойСтроки - 1;
			КонецЕсли;
		
		КонецЦикла;
	
	КонецЕсли;
	
	
КонецПроцедуры // ВывестиРазделВТабличныйДокумент()

&НаКлиенте
Процедура СохранитьОтчет(Команда)
		
	СохранитьНаКлиенте();
		
КонецПроцедуры

// СохранитьНаКлиенте()
//
&НаКлиенте
Процедура СохранитьНаКлиенте(Автосохранение = Ложь, ВыполняемоеОповещение = Неопределено) Экспорт

	Если НЕ РегламентированнаяОтчетностьКлиент.ПриЗаписиРегламентированногоОтчетаНаКлиенте(ЭтаФорма, Автосохранение) Тогда
		Возврат;
	КонецЕсли;
	
	РезультатСохранения = ПередСохранением(Автосохранение, Элементы.РазделыОтчета.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим);
	
	ПослеСохраненияНаКлиенте(ВыполняемоеОповещение, РезультатСохранения);
				
КонецПроцедуры // СохранитьНаКлиенте()

&НаКлиенте
Процедура ПослеСохраненияНаКлиенте(ВыполняемоеОповещение, РезультатСохранения)
	
	КлючУникальности = СтруктураРеквизитовФормы.мСохраненныйДок;
	
	Если РезультатСохранения Тогда
		
		РегламентированнаяОтчетностьКлиент.ПослеЗаписиРегламентированногоОтчета(ЭтаФорма);
		
		Если ВыполняемоеОповещение <> Неопределено Тогда
			ВыполнитьОбработкуОповещения(ВыполняемоеОповещение);
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры


// ПередСохранением()
//
&НаСервере
Функция ПередСохранением(Автосохранение, НаимТекРаздела)
	
	СтруктураРеквизитовФормы.мЗаписываетсяНовыйДокумент = (СтруктураРеквизитовФормы.мСохраненныйДок = Неопределено ИЛИ СтруктураРеквизитовФормы.мСкопированаФорма <> Неопределено);
	
	Возврат Сохранить(Автосохранение, НаимТекРаздела);
		
КонецФункции // ПередСохранением()

// Формирует структуру данных отчета и помещает в реквизит типа ХранилищеЗначения
// документа РегламентированныйОтчет.
// 
// При первом сохранении данных отчета создает новый документ этого вида.
// Структура данных отчета состоит из элементов:
//   - значения редактируемых реквизитов отчета;
//   - данные по многострочным разделам отчета;
//   - данные по  многостраничным разделам отчета;
//   - данные по вариантам заполнения реквизитов,
//     участвующих в автозаполнении.
//
&НаСервере
Функция Сохранить(Автосохранение = Ложь, НаимТекРаздела) Экспорт	
	
	Если НЕ СтруктураРеквизитовФормы.мСохраненныйДок = Неопределено Тогда
		СтруктураРеквизитовФормы.мСохраненныйДок = СтруктураРеквизитовФормы.мСохраненныйДок.ПолучитьОбъект();
	КонецЕсли;
			
	Если НЕ РегламентированнаяОтчетность.ПриЗаписиРегламентированногоОтчетаНаСервере(ЭтаФорма, Автосохранение, СтруктураРеквизитовФормы.мСохраненныйДок) Тогда
		СтруктураРеквизитовФормы.мСохраненныйДок = СтруктураРеквизитовФормы.мСохраненныйДок.Ссылка;
		Возврат Ложь;
	КонецЕсли;
	
	// установим текущие значения реквизитов документа
	СтруктураРеквизитовФормы.мСохраненныйДок.ИсточникОтчета 			 = Метаданные.Отчеты[Сред(Лев(СтрЗаменить(ЭтаФорма.ИмяФормы, "Внешний", ""), Найти(СтрЗаменить(ЭтаФорма.ИмяФормы, "Внешний", ""), ".Форма.") - 1), 7)].Имя;
	СтруктураРеквизитовФормы.мСохраненныйДок.НаименованиеОтчета 		 = Метаданные.Отчеты[Сред(Лев(СтрЗаменить(ЭтаФорма.ИмяФормы, "Внешний", ""), Найти(СтрЗаменить(ЭтаФорма.ИмяФормы, "Внешний", ""), ".Форма.") - 1), 7)].ОсновнаяФорма.Синоним;
	
	СтруктураРеквизитовФормы.мСохраненныйДок.ДатаНачала               = СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета;
	СтруктураРеквизитовФормы.мСохраненныйДок.ДатаОкончания            = СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета;
	СтруктураРеквизитовФормы.мСохраненныйДок.Периодичность            = СтруктураРеквизитовФормы.мПериодичность;
	СтруктураРеквизитовФормы.мСохраненныйДок.ВыбраннаяФорма           = СтруктураРеквизитовФормы.мВыбраннаяФорма;
	СтруктураРеквизитовФормы.мСохраненныйДок.Организация              = СтруктураРеквизитовФормы.Организация;
	СтруктураРеквизитовФормы.мСохраненныйДок.ДатаПодписи              = ДатаПодписи;
	СтруктураРеквизитовФормы.мСохраненныйДок.ЕдиницаИзмерения         = СтруктураРеквизитовФормы.ЕдиницаИзмерения;
	СтруктураРеквизитовФормы.мСохраненныйДок.ТочностьЕдиницыИзмерения = СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения;
	СтруктураРеквизитовФормы.мСохраненныйДок.ВидОтчетности            = Перечисления.ВидыОтчетности.РегламентированнаяОтчетность;
	СтруктураРеквизитовФормы.мСохраненныйДок.Комментарий              = Комментарий;

	СохранитьДанныеРаздела(НаимТекРаздела, Ложь, Ложь);
	
	ЗаполнитьПустыеСтруктурыДанных();
	
	// формируем данные редактируемых ячеек таблицы
	ПоказателиОтчета = Новый Структура();
	
	ЗаполнитьПоказателиОтчетаНаСервере(ПоказателиОтчета);
	
	// формируем список сохранения
	СписокСохранения = Новый Структура();

	// вставляем данные редактируемых ячеек таблицы	
	СписокСохранения.Вставить("ПоказателиОтчета", ПоказателиОтчета);

	
	ДанныеМногострочныхРазделов = Новый Структура;
	
	Для Каждого ЭлементСтруктуры Из мСтруктураМногострочныхРазделов Цикл
		
		ДанныеМногострочныхРазделов.Вставить(ЭлементСтруктуры.Ключ, ДанныеФормыВЗначение(ЭтаФорма[ЭлементСтруктуры.Значение], Тип("ТаблицаЗначений")));
		
	КонецЦикла;
	
	// вставляем данные многострочных разделов
	СписокСохранения.Вставить("ДанныеМногострочныхРазделов", ДанныеМногострочныхРазделов);
	
	СписокСохранения.Вставить("ОтчетЗаДваМесяца",  		СтруктураРеквизитовФормы.ОтчетЗаДваМесяца);
	СписокСохранения.Вставить("СпецРежим", 				СтруктураРеквизитовФормы.СпецРежим);
	СписокСохранения.Вставить("НеВыдаватьСообщенияОбОшибкахВРасчете", СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете);

	//ИНАГРО ++
	СписокСохранения.Вставить("К1", СтруктураРеквизитовФормы.К1);
	СписокСохранения.Вставить("К2", СтруктураРеквизитовФормы.К2);
	СписокСохранения.Вставить("К3", СтруктураРеквизитовФормы.К3);
	//ИНАГРО --
	
	ДанныеМногостраничныхРазделов = Новый Структура;
	
	МассивТиповНеопределено = Новый Массив; 
	МассивТиповНеопределено.Добавить(Тип("Неопределено"));
	ОписаниеТиповНеопределено = Новый ОписаниеТипов(МассивТиповНеопределено);
	
	Для Каждого ЭлементСтруктуры Из мСтруктураМногостраничныхРазделов Цикл
		
		ДанныеМногостраничныхРазделов.Вставить(ЭлементСтруктуры.Ключ, ДанныеФормыВЗначение(ЭтаФорма[ЭлементСтруктуры.Значение], Тип("ТаблицаЗначений")));
		
		ТаблЗнач = Неопределено;
		
		Если ДанныеМногостраничныхРазделов.Свойство(ЭлементСтруктуры.Ключ, ТаблЗнач) Тогда
						
			Если НЕ ТаблЗнач.Колонки.Найти("Данные") = Неопределено Тогда
												
				ТаблЗнач.Колонки.Удалить("Данные");
				ТаблЗнач.Колонки.Добавить("Данные", ОписаниеТиповНеопределено);
				
				Ном = 0;
				
				Для Каждого СтрокаТаблЗнач Из ТаблЗнач Цикл
					
					СтрокаТаблЗнач.Данные = ЭтаФорма[ЭлементСтруктуры.Значение][Ном].Данные[0].Значение;
					
					Ном = Ном + 1;
					
				КонецЦикла;
				
			КонецЕсли;
			
			Если НЕ ТаблЗнач.Колонки.Найти("ДополнительныеДанные") = Неопределено Тогда
												
				ТаблЗнач.Колонки.Удалить("ДополнительныеДанные");
				ТаблЗнач.Колонки.Добавить("ДополнительныеДанные", ОписаниеТиповНеопределено);
				
				Ном = 0;
				
				Для Каждого СтрокаТаблЗнач Из ТаблЗнач Цикл
					
					СтрокаТаблЗнач.ДополнительныеДанные = ЭтаФорма[ЭлементСтруктуры.Значение][Ном].ДополнительныеДанные[0].Значение;
					
					Ном = Ном + 1;
					
				КонецЦикла;
				
			КонецЕсли;
						
			Если НЕ ТаблЗнач.Колонки.Найти("ДанныеДопСтрок") = Неопределено Тогда
															
				ТаблЗнач.Колонки.Удалить("ДанныеДопСтрок");
				ТаблЗнач.Колонки.Добавить("ДанныеДопСтрок", ОписаниеТиповНеопределено);
				
				Ном = 0;
				
				Для Каждого СтрокаТаблЗнач Из ТаблЗнач Цикл
						
					СтруктураДанныхДопСтрок = Новый Структура;
					
					Для Каждого ЭлСтруктуры Из ЭтаФорма[ЭлементСтруктуры.Значение][Ном].ДанныеДопСтрок[0].Значение Цикл
														
						СтруктураДанныхДопСтрок.Вставить(ЭлСтруктуры.Ключ, ДанныеФормыВЗначение(ЭлСтруктуры.Значение, Тип("ТаблицаЗначений")));	
							
					КонецЦикла;
					
					СтрокаТаблЗнач.ДанныеДопСтрок = СтруктураДанныхДопСтрок;
					
					Ном = Ном + 1;
			
				КонецЦикла;
				
			КонецЕсли;
						
		КонецЕсли;
				
	КонецЦикла;

		
	// вставляем данные многостраничных разделов
	СписокСохранения.Вставить("ДанныеМногостраничныхРазделов", ДанныеМногостраничныхРазделов);
	
	ДанныеВариантовАвтоЗаполнения = Новый Структура;
	
	Для Каждого ЭлементСтруктуры Из мСтруктураВариантыЗаполнения Цикл
		
		МассивТаблЗнач = Новый Массив;
		
		ДанныеВариантовАвтоЗаполнения.Вставить(ЭлементСтруктуры.Ключ, МассивТаблЗнач);
			
		Для Каждого ЭлементМассива Из ЭтаФорма["ТаблицаВариантыЗаполнения" + ЭлементСтруктуры.Ключ] Цикл
			
			МассивТаблЗнач.Добавить(ДанныеФормыВЗначение(ЭлементМассива.ТаблицаВариантовЗаполнения, Тип("ТаблицаЗначений")));
			
		КонецЦикла;
			
	КонецЦикла;
	
	// вставляем данные вариантов автозаполнения ячеек
	СписокСохранения.Вставить("ДанныеВариантовАвтоЗаполнения", ДанныеВариантовАвтоЗаполнения);
	
	// вствляем версию формы
	СписокСохранения.Вставить("ВерсияФормы", СтруктураРеквизитовФормы.мВерсияФормы);
	
	СписокСохранения.Вставить("СохранятьРасшифровку", СтруктураРеквизитовФормы.мСохранятьРасшифровку);
	
	Если СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки <> Неопределено Тогда
	
		ТаблицаРасшифровки = ПолучитьИзВременногоХранилища(СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки);

		Если СтруктураРеквизитовФормы.мСохранятьРасшифровку = Истина Тогда
			СписокСохранения.Вставить("Расшифровка", ТаблицаРасшифровки);
		КонецЕсли;
		
	КонецЕсли;
	
	// вствляем флажок ручной ввод ВРЕМЕННАЯ ОТМЕНА
	СписокСохранения.Вставить("Автозаполнение", СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет);
	
	СписокСохранения.Вставить("ЕстьДуплекс", СтруктураРеквизитовФормы.ЕстьДуплекс);
		
	Если СтруктураРеквизитовФормы.ПолучениеДанныхДляЗвит1С = Истина Тогда
		СписокСохранения.Вставить("СозданКакХранилищеПараметровДляЗвит1С", Истина);
	КонецЕсли;
	
	ХранилищеДанных = Новый ХранилищеЗначения(СписокСохранения);
	СтруктураРеквизитовФормы.мСохраненныйДок.ДанныеОтчета = ХранилищеДанных;

	// записываем документ, хранящий данные отчета	
	Попытка
		СтруктураРеквизитовФормы.мСохраненныйДок.Записать();
	Исключение
		Если НЕ Автосохранение Тогда
			
			Сообщение = Новый СообщениеПользователю;

			Сообщение.Текст = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='%1';uk='%1'"), РегламентированнаяОтчетностьКлиентСервер.СформироватьТекстСообщения(ОписаниеОшибки()));

			Сообщение.Сообщить();
			
		КонецЕсли;
		СтруктураРеквизитовФормы.мСохраненныйДок = СтруктураРеквизитовФормы.мСохраненныйДок.Ссылка;
		Возврат Ложь;
	КонецПопытки;
			
	Модифицированность   = Ложь;
	
	СохранитьДеревоНастройкиСтраниц(СтруктураРеквизитовФормы.мСохраненныйДок);
	
	СтруктураРеквизитовФормы.мСохраненныйДок = СтруктураРеквизитовФормы.мСохраненныйДок.Ссылка;
	
	Возврат Истина;

КонецФункции // Сохранить()

&НаСервере
Процедура ЗаполнитьПоказателиОтчетаНаСервере(ПоказателиОтчета)
	
	Префикс = "ПолеТабличногоДокумента";
	
	Для Каждого Раздел Из мСвойстваРазделовДекларации.ПолучитьЭлементы() Цикл
			
		Если НЕ Раздел.МногостраничностьВРазделе Тогда
			ПоказателиОтчета.Вставить(Префикс + Раздел.ИмяСтраницы, ЭтаФорма["СтруктураДанных" + Раздел.ИмяСтраницы]);
		КонецЕсли;
	
	КонецЦикла;
	
КонецПроцедуры // ЗаполнитьПоказателиОтчетаНаСервере()

&НаСервере
Процедура ЗаполнитьПустыеСтруктурыДанных()
	
	СохрТабличныйДокумент = Новый ТабличныйДокумент;
	
	СохрТабличныйДокумент.Вывести(ТабличныйДокумент);
	
	Для Каждого Раздел Из мСвойстваРазделовДекларации.ПолучитьЭлементы() Цикл
		
		Если НЕ Раздел.МногостраничностьВРазделе
		  И (ЭтаФорма["СтруктураДанных" + Раздел.ИмяСтраницы].Количество() = 0) Тогда
		  
			ТабличныйДокумент.Очистить();
			ТабличныйДокумент.Вывести(ОбъектОтчета(ЭтаФорма.ИмяФормы).ПолучитьМакет(Сред(ЭтаФорма.ИмяФормы, Найти(ЭтаФорма.ИмяФормы, "ФормаОтчета")) + "_" + Раздел.ИмяСтраницы));
			
			СохранитьДанныеРаздела(Раздел.ИмяСтраницы, Ложь);
			
		ИначеЕсли Раздел.МногостраничностьВРазделе
			    И (ЭтаФорма[мСтруктураМногостраничныхРазделов[Раздел.ИмяСтраницы]][0].Данные.Количество() = 0) Тогда
				
			ТабличныйДокумент.Очистить();
			ТабличныйДокумент.Вывести(ОбъектОтчета(ЭтаФорма.ИмяФормы).ПолучитьМакет(Сред(ЭтаФорма.ИмяФормы, Найти(ЭтаФорма.ИмяФормы, "ФормаОтчета")) + "_" + Раздел.ИмяСтраницы));
			
			ЗаполнитьПоказателиЗначениямиПоУмолчанию(Раздел.ИмяСтраницы);
			
		КонецЕсли;
		
		Если Раздел.ИмяСтраницы = "ПриложениеПН" Тогда
			Для Каждого Страница Из ЭтаФорма[мСтруктураМногостраничныхРазделов[Раздел.ИмяСтраницы]] Цикл
		   		Если Страница.ДополнительныеДанные.Количество() = 0 Тогда
					Страница.ДополнительныеДанные.Очистить();
					Страница.ДополнительныеДанные.Добавить(Новый Структура);
					Страница.ДополнительныеДанные[0].Пометка = Ложь;
				КонецЕсли;
				
		   		Если Страница.Данные.Количество() = 0 Тогда
					Страница.Данные.Очистить();
					Страница.Данные.Добавить(Новый Структура);
					Страница.Данные[0].Пометка = Ложь;
				КонецЕсли;
				
		   		Если Страница.ДанныеДопСтрок.Количество() = 0 Тогда
					Страница.ДанныеДопСтрок.Очистить();
					Страница.ДанныеДопСтрок.Добавить(Новый Структура);
					Страница.ДанныеДопСтрок[0].Пометка = Ложь;
				КонецЕсли;
				
			КонецЦикла;
		КонецЕсли;
	
	КонецЦикла;
	
	ТабличныйДокумент.Очистить();
	ТабличныйДокумент.Вывести(СохрТабличныйДокумент);
	
КонецПроцедуры // ЗаполнитьПустыеСтруктурыДанных()

&НаСервере
Процедура СохранитьДеревоНастройкиСтраниц(Знач мСохраненныйДок)
	
	Если мСохраненныйДок <> Неопределено Тогда
				
		Если ТипЗнч(мСохраненныйДок) = Тип("ДокументСсылка.РегламентированныйОтчет") Тогда
			мСохраненныйДок = мСохраненныйДок.ПолучитьОбъект();
		КонецЕсли;
		
		Если Не мСохраненныйДок.ЭтоНовый() Тогда
			// Сохраняем выбранные листы для печати в хранилище
			ХранилищеДанных = Новый ХранилищеЗначения(РеквизитФормыВЗначение("мДеревоСтраницОтчета"));
			мСохраненныйДок.ДеревоНастройкиСтраниц = ХранилищеДанных;
			Попытка
				мСохраненныйДок.Записать();
			Исключение
			КонецПопытки;
		КонецЕсли;
	КонецЕсли;
	
Конецпроцедуры // СохранитьДеревоНастройкиСтраниц()

&НаКлиенте
Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	
	РегламентированнаяОтчетностьКлиент.ПередЗакрытиемРегламентированногоОтчета(ЭтаФорма, Отказ, СтандартнаяОбработка);
	
КонецПроцедуры // ПередЗакрытием()

&НаКлиенте
Процедура ПриЗакрытии()
	
	ПриЗакрытииНаСервере();
		
КонецПроцедуры // ПриЗакрытии()

// ПриЗакрытииНаСервере()
//
&НаСервере
Процедура ПриЗакрытииНаСервере()
			
	СохранитьДеревоНастройкиСтраниц(СтруктураРеквизитовФормы.мСохраненныйДок);
	
	ОбщегоНазначения.ХранилищеОбщихНастроекСохранить("РегламентированнаяОтчетность", "ЕстьДуплекс", СтруктураРеквизитовФормы.ЕстьДуплекс);
	
	РегламентированнаяОтчетность.ПриЗакрытииРегламентированногоОтчета(ЭтаФорма);
	
КонецПроцедуры // ПриЗакрытииНаСервере()

// ПоказатьСтраницуМногостраничногоРазделаНаКлиенте()
//
&НаКлиенте
Процедура ПоказатьСтраницуМногостраничногоРазделаНаКлиенте(Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу = Ложь) Экспорт
	
	ПоказатьСтраницуМногостраничногоРаздела(ЭтаФорма, Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу);
	
КонецПроцедуры // ПоказатьСтраницуМногостраничногоРазделаНаКлиенте()

// ПоказатьСтраницуМногостраничногоРазделаНаСервере()
//
&НаСервере
Процедура ПоказатьСтраницуМногостраничногоРазделаНаСервере(Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу = Ложь) Экспорт
	
	ПоказатьСтраницуМногостраничногоРаздела(ЭтаФорма, Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу);
		
КонецПроцедуры // ПоказатьСтраницуМногостраничногоРазделаНаСервере()

// ПоказатьСтраницуМногостраничногоРаздела()
// Вариант версия 10.05.2005
// Выводит в табличный документ данные страницы многостраничного раздела формы.
// Одновременно убирая признак у активной страницы и сохраняя в неё данные текущего табличного поля
// Параметры:
//  Шаг                      - число,  количество перелистываемых страниц;
//  ИмяТекущейСтраницыПанели - строка, имя страницы основной панели формы, содержащий многостраничный раздел;
//  ПоказатьПоИндексу        - булево, управляет выводом страницы по заданному индексу в коллекции страниц.
//
&НаКлиентеНаСервереБезКонтекста
Процедура ПоказатьСтраницуМногостраничногоРаздела(Форма, Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу = Ложь)
	
	РегламентированнаяОтчетностьКлиентСервер.ПоказатьСтраницуМногостраничногоРаздела(Форма, Шаг, ИмяТекущейСтраницыПанели, ПоказатьПоИндексу);
	//Если ИмяТекущейСтраницыПанели = "Раздел2" Тогда
	//	#Если НаКлиенте Тогда
	//		Форма.ИзменитьЦветЯчеекНаКлиенте();
	//	#Иначе
	//		Форма.ИзменитьЦветЯчеекНаСервере();
	//	#КонецЕсли
	//КонецЕсли;
	
КонецПроцедуры // ПоказатьСтраницуМногостраничногоРаздела()

&НаКлиенте
Процедура ИзменитьЦветЯчеекНаКлиенте() Экспорт
	
	ИзменитьЦветЯчеек(ЭтаФорма);
	
КонецПроцедуры // ИзменитьЦветЯчеекНаКлиенте()

&НаСервере
Процедура ИзменитьЦветЯчеекНаСервере() Экспорт
	
	ИзменитьЦветЯчеек(ЭтаФорма);
	
КонецПроцедуры // ИзменитьЦветЯчеекНаСервере()

&НаКлиентеНаСервереБезКонтекста
Процедура ИзменитьЦветЯчеек(Форма)

	//КодОперации = СокрЛП(Форма.ТабличныйДокумент.Области.П000200007003.Значение);
	//
	//Если КодОперации = "1011705" ИЛИ КодОперации = "1011707" Тогда
	//	
	//	Если Форма.СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет Тогда
	//		ИзменитьВариантЗаполненияЯчейки(Форма, 0, "П000200006003");
	//	Иначе	
	//		ИзменитьВариантЗаполненияЯчейки(Форма, 4, "П000200006003");
	//	КонецЕсли;
	//
	//	ИзменитьВариантЗаполненияЯчейки(Форма, 0, "П000200008003");
	//	ИзменитьВариантЗаполненияЯчейки(Форма, 0, "П000200009003");
	//	ИзменитьВариантЗаполненияЯчейки(Форма, 0, "П000200010003");
	//	
	//Иначе	
	//	
	//	ИзменитьВариантЗаполненияЯчейки(Форма, 0, "П000200006003");
	//	ИзменитьВариантЗаполненияЯчейки(Форма, 5, "П000200008003");
	//	ИзменитьВариантЗаполненияЯчейки(Форма, 5, "П000200009003");
	//	ИзменитьВариантЗаполненияЯчейки(Форма, 5, "П000200010003");
	//	
	//	Форма.ТабличныйДокумент.Области.П000200008003.Значение = "";
	//	Форма.ТабличныйДокумент.Области.П000200009003.Значение = "";
	//	Форма.ТабличныйДокумент.Области.П000200010003.Значение = "";
	//			
	//КонецЕсли;
		
КонецПроцедуры // ИзменитьЦветЯчеек()

&НаКлиентеНаСервереБезКонтекста
Процедура ИзменитьВариантЗаполненияЯчейки(Форма, НовыйВариант, Показатель = Неопределено)
    		
	ИмяТекущейСтраницыПанели = Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела;
    		
	#Если НаКлиенте Тогда
		ТаблицаВариантыЗаполнения = РегламентированнаяОтчетностьКлиент.ПолучитьТаблицуВариантовЗаполненияНаКлиенте(Форма, ИмяТекущейСтраницыПанели);
	#Иначе
		ТаблицаВариантыЗаполнения = РегламентированнаяОтчетностьВызовСервера.ПолучитьТаблицуВариантовЗаполненияНаСервере(Форма, ИмяТекущейСтраницыПанели);
	#КонецЕсли
	
	Если ТаблицаВариантыЗаполнения = Неопределено Тогда
		Возврат;
	КонецЕсли;

	ТекущаяОбласть  = Форма.Элементы.ТабличныйДокумент.ТекущаяОбласть;
	Если Показатель = Неопределено Тогда
		ИмяПоказателя   = ТекущаяОбласть.Имя;
	Иначе
		ИмяПоказателя = Показатель;
	КонецЕсли;

	НайденнаяСтрока = ТаблицаВариантыЗаполнения.НайтиСтроки(Новый Структура("КодПоказателя", ИмяПоказателя));
	Если НайденнаяСтрока.Количество() > 0 Тогда
		НайденнаяСтрока = НайденнаяСтрока[0];
		НайденнаяСтрока.ВариантЗаполнения = НовыйВариант;
	КонецЕсли;

	УстановитьЦветФонаЯчейки(Форма, ИмяПоказателя, НовыйВариант);
		
КонецПроцедуры // ИзменитьВариантЗаполненияЯчейки()

// ОбновитьПеременныеМодуляНаСервере()
//
&НаСервере
Функция ОбновитьПеременныеМодуляНаСервере(ИмяПоказателя, ЗначениеПоказателя) Экспорт
	
	Возврат ОбновитьПеременныеМодуля(ЭтаФорма, ИмяПоказателя, ЗначениеПоказателя);
	
КонецФункции // ОбновитьПеременныеМодуляНаСервере()

// ОбновитьПеременныеМодуляНаКлиенте()
//
&НаКлиенте
Функция ОбновитьПеременныеМодуляНаКлиенте(ИмяПоказателя, ЗначениеПоказателя) Экспорт
	
	Возврат ОбновитьПеременныеМодуля(ЭтаФорма, ИмяПоказателя, ЗначениеПоказателя);
	
КонецФункции // ОбновитьПеременныеМодуляНаКлиенте()

&НаКлиентеНаСервереБезКонтекста
Функция ОбновитьПеременныеМодуля(Форма, ИмяПоказателя, ЗначениеПоказателя)
	
	ИзмененияПроизошли = Ложь;
	
	Если Лев(ИмяПоказателя, 1) = "_" Тогда
		ИзмененияПроизошли = Истина;
		Возврат ИзмененияПроизошли;
	КонецЕсли;
	
	////Если (ИмяПоказателя = "Сумма30Раздел1")
	//// Или (ИмяПоказателя = "Сумма40Раздел1")
	//// Или (ИмяПоказателя = "Сумма50Раздел1")
	//// Или (ИмяПоказателя = "Сумма60Раздел1") Тогда
	////	Форма.мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
	////	ИзмененияПроизошли = Истина;
	////ИначеЕсли ИмяПоказателя = "КБКРаздел1" Тогда
	////	Форма.мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
	////	ИзмененияПроизошли = Истина;
	////ИначеЕсли ИмяПоказателя = "ОКАТОРаздел1" Тогда
	////	Форма.мСтруктураПеременных.Вставить(ИмяПоказателя, ЗначениеПоказателя);
	////	ИзмененияПроизошли = Истина;
	////КонецЕсли;

	Возврат ИзмененияПроизошли;
	
КонецФункции // ОбновитьПеременныеМодуля()

// ОчиститьТабличноеПолеНаКлиенте()
//
&НаКлиенте
Процедура ОчиститьТабличноеПолеНаКлиенте(ВыбТабличноеПолеИмя) Экспорт

	ОчиститьТабличноеПоле(ЭтаФорма, ВыбТабличноеПолеИмя);

КонецПроцедуры // ОчиститьТабличноеПолеНаКлиенте()

// ОчиститьТабличноеПолеНаСервере()
//
&НаСервере
Процедура ОчиститьТабличноеПолеНаСервере(ВыбТабличноеПолеИмя) Экспорт

	ОчиститьТабличноеПоле(ЭтаФорма, ВыбТабличноеПолеИмя);

КонецПроцедуры // ОчиститьТабличноеПолеНаСервере()

// Процедура очищает содержимое редактируемых и вычисляемых ячеек
// поля табличного документа, переданного параметром ВыбТабличноеПоле.
//
// Параметры:
//  ВыбТабличноеПоле - поле табличного документа.
//
&НаКлиентеНаСервереБезКонтекста
Процедура ОчиститьТабличноеПоле(Форма, ВыбТабличноеПолеИмя)

	ВыбТабличноеПоле = Форма.ТабличныйДокумент;
	
	HZG = ПолучитьПоказательНаСервере("HZG",Форма,"Декларация");
	HSG = ПолучитьПоказательНаСервере("HSG",Форма,"Декларация");
	HLG = ПолучитьПоказательНаСервере("HLG",Форма,"Декларация");
	HRB = ПолучитьПоказательНаСервере("HRB",Форма,"Декларация");
	HNS = ПолучитьПоказательНаСервере("HNS",Форма,"Декларация");
	
	//для очистки защищенных областей итоговых ячеек
	//получим список итоговых ячеек, снимая с них защиту), а после очищения вернем защиту
	СписокИтоговыхЯчеек = Новый СписокЗначений;
	
	Для каждого Область Из ВыбТабличноеПоле.Области Цикл
		Если Область.ЦветФона = Форма.СтруктураРеквизитовФормы.ЦветЗаполняетсяАвтоАрифметика И Область.Защита Тогда
			Область.Защита = Ложь;
			СписокИтоговыхЯчеек.Добавить(Область.Имя);
		КонецЕсли;
	КонецЦикла;
	
	РегламентированнаяОтчетностьКлиентСервер.ОчиститьТабличноеПоле(Форма, ВыбТабличноеПолеИмя);
	
	ВыбТабличноеПоле = Форма.ТабличныйДокумент;
	
	// Непосредственно очищаем ячейки табличного документа. РегламентированнаяОтчетностьКлиентСервер.ОчиститьТабличноеПоле делает то же самое
	// Повторно, так как в результате расчета многостраничного многострочного блока заполняются итоговые ячейки, 
	// в арифметике которых есть показатели не из многострочного блока
	Для Инд = 0 По ВыбТабличноеПоле.Области.Количество() - 1 Цикл
		ТекущаяОбласть = ВыбТабличноеПоле.Области[Инд];

		Если Не ТекущаяОбласть.ТипОбласти = ТипОбластиЯчеекТабличногоДокумента.Прямоугольник Тогда
			Продолжить;
		КонецЕсли;

		Если ТекущаяОбласть.СодержитЗначение <> Истина Тогда
			Продолжить;
		КонецЕсли;

		Если ТекущаяОбласть.Защита Тогда
			Продолжить;
		КонецЕсли;

		Если Найти(Врег(ТекущаяОбласть.Имя), ВРег("Штампик")) > 0  Тогда
			Продолжить;
		КонецЕсли;
		
		ТекущаяОбласть.Очистить();
	КонецЦикла;
	
	Для каждого КодИтоговогоПоказателя Из СписокИтоговыхЯчеек Цикл
		ОбластьПоказателя=ВыбТабличноеПоле.Области.Найти(КодИтоговогоПоказателя.Значение);
		Если ОбластьПоказателя <> Неопределено Тогда
			ОбластьПоказателя.Защита = Истина;
		КонецЕсли;
	КонецЦикла;

	ЗаполнитьСведенияОбОрганизации(Форма);
	
	ЗаполнитьПоказательНаСервере("HZG",HZG,Форма,ВыбТабличноеПолеИмя);
	ЗаполнитьПоказательНаСервере("HSG",HSG,Форма,ВыбТабличноеПолеИмя);
	ЗаполнитьПоказательНаСервере("HLG",HLG,Форма,ВыбТабличноеПолеИмя);
	ЗаполнитьПоказательНаСервере("HRB",HRB,Форма,ВыбТабличноеПолеИмя);
	ЗаполнитьПоказательНаСервере("HNS",HNS,Форма,ВыбТабличноеПолеИмя);
	
КонецПроцедуры // ОчиститьТабличноеПоле()

// РасчетНаКлиенте()
//
&НаКлиенте
Процедура РасчетНаКлиенте(ИмяСтраницыПанели = "", ОбластьИмя = "") Экспорт

	Расчет(ЭтаФорма, ИмяСтраницыПанели, ОбластьИмя);

КонецПроцедуры // РасчетНаКлиенте()

// РасчетНаСервере()
//
&НаСервере
Процедура РасчетНаСервере(ИмяСтраницыПанели = "", ОбластьИмя = "") Экспорт

	Расчет(ЭтаФорма, ИмяСтраницыПанели, ОбластьИмя);

КонецПроцедуры // РасчетНаСервере()

// РАСЧЕТ()
// Выполняет расчет вычисляемых показателей на заданной странице отчета
// (ячеек, выделенных зеленым цветом). 
// В случае неуказания листа, ничего происходить не будет
// Параметры:
//  ИмяСтраницыПанели - строка, имя страницы основной панели формы.
//
&НаКлиентеНаСервереБезКонтекста
Процедура Расчет(Форма, ИмяСтраницыПанели = "", ОбластьИмя = "")
	Перем ТаблицаБлока;
	
	Если (Форма.СтруктураРеквизитовФормы.мРежимПечати) Тогда
		Возврат; // служебный вызов в процессе печати
	КонецЕсли;
	
	Если (Форма.СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет) Тогда
		Возврат; // отключен режим авторасчета
	КонецЕсли;
	
	// обновим данные многострочных групп
	Если Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела = ИмяСтраницыПанели Тогда

		ИдГрупп = Новый Структура;
		ИдГрупп.Вставить("мИдГруппы", Форма.СтруктураРеквизитовФормы.мИдГруппы);
		ИдГрупп.Вставить("мИдГруппы_2", Форма.СтруктураРеквизитовФормы.мИдГруппы_2);
		ИдГрупп.Вставить("мИдГруппы1", Форма.СтруктураРеквизитовФормы.мИдГруппы1);
		ИдГрупп.Вставить("мИдГруппы2", Форма.СтруктураРеквизитовФормы.мИдГруппы2);
		ИдГрупп.Вставить("мИдГруппы21", Форма.СтруктураРеквизитовФормы.мИдГруппы21);
		ИдГрупп.Вставить("мИдГруппы31", Форма.СтруктураРеквизитовФормы.мИдГруппы31);
		ИдГрупп.Вставить("мИдГруппы41", Форма.СтруктураРеквизитовФормы.мИдГруппы41);
		ИдГрупп.Вставить("мИдГруппы43", Форма.СтруктураРеквизитовФормы.мИдГруппы43);
		ИдГрупп.Вставить("мИдГруппы51", Форма.СтруктураРеквизитовФормы.мИдГруппы51);
		ИдГрупп.Вставить("мИдГруппы52", Форма.СтруктураРеквизитовФормы.мИдГруппы52);
		ИдГрупп.Вставить("мИдГруппы53", Форма.СтруктураРеквизитовФормы.мИдГруппы53);
		ИдГрупп.Вставить("мИдГруппыС1", Форма.СтруктураРеквизитовФормы.мИдГруппыС1);
		ИдГрупп.Вставить("мИдГруппыС2", Форма.СтруктураРеквизитовФормы.мИдГруппыС2);
		ИдГрупп.Вставить("мИдГруппыС3", Форма.СтруктураРеквизитовФормы.мИдГруппыС3);
		ИдГрупп.Вставить("мИдГруппы7", Форма.СтруктураРеквизитовФормы.мИдГруппы7);
		ИдГрупп.Вставить("мИдГруппы81", Форма.СтруктураРеквизитовФормы.мИдГруппы81);
		ИдГрупп.Вставить("мИдГруппыФ1", Форма.СтруктураРеквизитовФормы.мИдГруппыФ1);
		
		ИмяГруппыМассив =  ОпределитьИдМногострочногоРазделаПоАктивнойСтранице(ИмяСтраницыПанели, , ИдГрупп);
		Для каждого ИмяГруппы Из ИмяГруппыМассив Цикл
			РегламентированнаяОтчетностьКлиентСервер.ОбновитьСтруктуруМногострочногоРаздела(Форма, ИмяГруппы);
		КонецЦикла;
		
	КонецЕсли;
	
	ЭтоОбычнаяДекларация = ЗначениеЗаполнено(ПолучитьПоказательНаСервере("HZG", Форма, "Декларация"));
		
	ТекстСообщенияОбОшибкахРасчета = "";
											 
	////////////////////////////////////////////////
	// Расчет Приложения 1
	R001G4 = ПолучитьПоказательНаСервере("R0011G4", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0012G4", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0013G4", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0014G4", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0015G4", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0016G4", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R001G4", R001G4, Форма, "Приложение1"); 																
								  
	R001G5 = ПолучитьПоказательНаСервере("R0011G5", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0012G5", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0013G5", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0014G5", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0015G5", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0016G5", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R001G5", R001G5, Форма, "Приложение1"); 																
	
	R001G6 = ПолучитьПоказательНаСервере("R0011G6", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0012G6", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0013G6", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0014G6", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0015G6", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0016G6", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R001G6", R001G6, Форма, "Приложение1"); 																
	
	R001G7 = ПолучитьПоказательНаСервере("R0011G7", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0012G7", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0013G7", Форма, "Приложение1") 
									+ ПолучитьПоказательНаСервере("R0014G7", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0015G7", Форма, "Приложение1")
									+ ПолучитьПоказательНаСервере("R0016G7", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R001G7", R001G7, Форма, "Приложение1"); 																
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы1, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	R010G4 = ТаблицаБлока.Итог("T1RXXXXG4") + ПолучитьПоказательНаСервере("R001G4", Форма, "Приложение1");
	R010G5 = ТаблицаБлока.Итог("T1RXXXXG5") + ПолучитьПоказательНаСервере("R001G5", Форма, "Приложение1");
	R010G6 = ТаблицаБлока.Итог("T1RXXXXG6") + ПолучитьПоказательНаСервере("R001G6", Форма, "Приложение1");
	R010G7 = ТаблицаБлока.Итог("T1RXXXXG7") + ПолучитьПоказательНаСервере("R001G7", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R010G4", R010G4, Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R010G5", R010G5, Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R010G6", R010G6, Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R010G7", R010G7, Форма, "Приложение1");
	R70GA = ПолучитьПоказательНаСервере("R010G4", Форма, "Приложение1") + ПолучитьПоказательНаСервере("R010G7", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R70GA", R70GA, Форма, "Декларация");
	R70GB = ПолучитьПоказательНаСервере("R010G5", Форма, "Приложение1") + ПолучитьПоказательНаСервере("R010G6", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R70GB", R70GB, Форма, "Декларация");
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы2, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	ЗаполнитьПоказательНаСервере("R020G4", ТаблицаБлока.Итог("T2RXXXXG4"), Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R020G5", ТаблицаБлока.Итог("T2RXXXXG5"), Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R020G6", ТаблицаБлока.Итог("T2RXXXXG6"), Форма, "Приложение1");

	ЗаполнитьПоказательНаСервере("R022G4", ТаблицаБлока.Итог("T2RXXXXG4"), Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R022G5", ТаблицаБлока.Итог("T2RXXXXG5"), Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R022G6", ТаблицаБлока.Итог("T2RXXXXG6"), Форма, "Приложение1");

	R120GA = ПолучитьПоказательНаСервере("R022G4", Форма, "Приложение1");
	R120GB = ПолучитьПоказательНаСервере("R022G5", Форма, "Приложение1") + ПолучитьПоказательНаСервере("R022G6", Форма, "Приложение1");
	ЗаполнитьПоказательНаСервере("R120GA", R120GA, Форма, "Декларация");
	ЗаполнитьПоказательНаСервере("R120GB", R120GB, Форма, "Декларация");
	
	////////////////////////////////////////////////
	// Расчет Приложения 2
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы21, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	
	R02G5 = ОкруглитьЧислоПоФормату(Форма, ТаблицаБлока.Итог("П2T1RXXXXG5")) + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01G5", Форма, "Приложение2"));
	ЗаполнитьПоказательНаСервере("R02G5", R02G5, Форма, "Приложение2");
	////R02G6 = ОкруглитьЧислоПоФормату(Форма, ТаблицаБлока.Итог("П2T1RXXXXG6"));
	////ЗаполнитьПоказательНаСервере("R02G6", R02G6, Форма, "Приложение2");
	
	////////////////////////////////////////////////
	// Расчет Приложения 5
	
	
	R001G4 = ПолучитьПоказательНаСервере("R0011G4", Форма, "Приложение5")
									+ ПолучитьПоказательНаСервере("R0012G4", Форма, "Приложение5") 
									//+ ПолучитьПоказательНаСервере("R0013G4", Форма, "Приложение5") 
									+ ПолучитьПоказательНаСервере("R0014G4", Форма, "Приложение5")
									//+ ПолучитьПоказательНаСервере("R0015G4", Форма, "Приложение5")
									+ ПолучитьПоказательНаСервере("R0016G4", Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R001G4", R001G4, Форма, "Приложение5");
								  
	R001G5 = ПолучитьПоказательНаСервере("R0011G5", Форма, "Приложение5")
									+ ПолучитьПоказательНаСервере("R0012G5", Форма, "Приложение5") 
									//+ ПолучитьПоказательНаСервере("R0013G5", Форма, "Приложение5") 
									+ ПолучитьПоказательНаСервере("R0014G5", Форма, "Приложение5")
									//+ ПолучитьПоказательНаСервере("R0015G5", Форма, "Приложение5")
									+ ПолучитьПоказательНаСервере("R0016G5", Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R001G5", R001G5, Форма, "Приложение5");
	
	R001G6 = ПолучитьПоказательНаСервере("R0011G6", Форма, "Приложение5")
									+ ПолучитьПоказательНаСервере("R0012G6", Форма, "Приложение5") 
									//+ ПолучитьПоказательНаСервере("R0013G6", Форма, "Приложение5") 
									+ ПолучитьПоказательНаСервере("R0014G6", Форма, "Приложение5")
									//+ ПолучитьПоказательНаСервере("R0015G6", Форма, "Приложение5")
									+ ПолучитьПоказательНаСервере("R0016G6", Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R001G6", R001G6, Форма, "Приложение5");
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы51, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	R010G4 = ТаблицаБлока.Итог("П5T1RXXXXG4") + ПолучитьПоказательНаСервере("R001G4", Форма, "Приложение5");
	R010G5 = ТаблицаБлока.Итог("П5T1RXXXXG5") + ПолучитьПоказательНаСервере("R001G5", Форма, "Приложение5");
	R010G6 = ТаблицаБлока.Итог("П5T1RXXXXG6") + ПолучитьПоказательНаСервере("R001G6", Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R010G4", R010G4, Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R010G5", R010G5, Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R010G6", R010G6, Форма, "Приложение5");
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы52, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	ЗаполнитьПоказательНаСервере("R020G4", ТаблицаБлока.Итог("П5T2RXXXXG4"), Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R020G5", ТаблицаБлока.Итог("П5T2RXXXXG5"), Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R020G6", ТаблицаБлока.Итог("П5T2RXXXXG6"), Форма, "Приложение5");

	////ЗаполнитьПоказательНаСервере("R022G4", ТаблицаБлока.Итог("П5T2RXXXXG4"), Форма, "Приложение5");
	////ЗаполнитьПоказательНаСервере("R022G5", ТаблицаБлока.Итог("П5T2RXXXXG5"), Форма, "Приложение5");
	////ЗаполнитьПоказательНаСервере("R022G6", ТаблицаБлока.Итог("П5T2RXXXXG6"), Форма, "Приложение5");
	
	R023G4 = 0;R023G5 = 0;R023G6 = 0;
	R024G4 = 0;R024G5 = 0;R024G6 = 0;
	Для каждого Строка52 Из ТаблицаБлока Цикл
		Если ЗначениеЗаполнено(Строка52.П5T2RXXXXG41) Тогда
			R023G4 = R023G4 + Строка52.П5T2RXXXXG4;
			R023G5 = R023G5 + Строка52.П5T2RXXXXG5;
			R023G6 = R023G6 + Строка52.П5T2RXXXXG6;
			
			Если ЗначениеЗаполнено(Строка52.П5T2RXXXXG3A) И Строка52.П5T2RXXXXG3A > 0 И Строка52.П5T2RXXXXG3A < 13 И ЗначениеЗаполнено(Строка52.П5T2RXXXXG3B) Тогда
			
				ДатаСоставления = Дата(Строка52.П5T2RXXXXG3B, Строка52.П5T2RXXXXG3A,1);
				Если ДатаСоставления < '2015-07-01' Тогда
					R024G4 = R024G4 + Строка52.П5T2RXXXXG4;
					R024G5 = R024G5 + Строка52.П5T2RXXXXG5;
					R024G6 = R024G6 + Строка52.П5T2RXXXXG6;
				КонецЕсли;
				
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	ЗаполнитьПоказательНаСервере("R023G4", R023G4, Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R023G5", R023G5, Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R023G6", R023G6, Форма, "Приложение5");
	
	ЗаполнитьПоказательНаСервере("R024G4", R024G4, Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R024G5", R024G5, Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R024G6", R024G6, Форма, "Приложение5");
	
	Если Форма.СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете = Истина ИЛИ Форма.СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете ИЛИ НЕ ЭтоОбычнаяДекларация Тогда
	Иначе
		Если (ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R11GA", Форма, "Декларация") + ПолучитьПоказательНаСервере("R12GA", Форма, "Декларация") + ПолучитьПоказательНаСервере("R41GA", Форма, "Декларация") + ПолучитьПоказательНаСервере("R42GA", Форма, "Декларация")) <> ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R010G4", Форма, "Приложение5")))
				  или
			 (ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R11GB", Форма, "Декларация") + ПолучитьПоказательНаСервере("R41GB", Форма, "Декларация")) <> ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R010G5", Форма, "Приложение5")))
			      ИЛИ
			 (ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R12GB", Форма, "Декларация") + ПолучитьПоказательНаСервере("R42GB", Форма, "Декларация")) <> ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R010G6", Форма, "Приложение5"))) 	  Тогда
			 
			ТекстСообщенияОбОшибкахРасчета = ТекстСообщенияОбОшибкахРасчета + Символы.ПС + Символы.Таб 
			+ НСтр("ru='значения строк 1.1, 1.2, 4.1, 4.2 декларации не совпадает с итогом по таблице 1 Раздела I Приложения №5 к декларации';uk='значення у рядках 1.1, 1.2, 4.1, 4.2 декларації не співпадає з підсумком таблиці 1 Розділу I Додатку 5 до декларації'");
			
		КонецЕсли;
		
		Если (ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R101GA", Форма, "Декларация") + ПолучитьПоказательНаСервере("R102GA", Форма, "Декларация")) <> ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R020G4", Форма, "Приложение5")))
				или
			 (ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R101GB", Форма, "Декларация")) <> ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R020G5", Форма, "Приложение5")))
				или
			 (ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R102GB", Форма, "Декларация")) <> ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R020G6", Форма, "Приложение5")))	Тогда
			
			ТекстСообщенияОбОшибкахРасчета = ТекстСообщенияОбОшибкахРасчета + Символы.ПС + Символы.Таб 
			+ НСтр("ru='значения строк 10.1, 10.2 декларации не совпадает с итогом по таблице 2 Раздела II Приложения №5 к декларации!';uk='значення рядків 10.1, 10.2 декларації не співпадає з підсумком таблиці 2 Розділу II Додатку 5 до декларації'");
			
		КонецЕсли;
		
	КонецЕсли;
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы53, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	ЗаполнитьПоказательНаСервере("R030G4", ТаблицаБлока.Итог("П5T3RXXXXG4"), Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R030G5", ТаблицаБлока.Итог("П5T3RXXXXG5"), Форма, "Приложение5");
	ЗаполнитьПоказательНаСервере("R030G6", ТаблицаБлока.Итог("П5T3RXXXXG6"), Форма, "Приложение5");
	R031G5 = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R030G5", Форма, "Приложение5")) + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R030G6", Форма, "Приложение5"));
	ЗаполнитьПоказательНаСервере("R031G5", R031G5, Форма, "Приложение5");

	////////////////////////////////////////////////
	//Расчет для Приложения 6 (Справки к деларации)
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппыС1, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	ЗаполнитьПоказательНаСервере("R010G4", ТаблицаБлока.Итог("С1T1RXXXXG4"), Форма, "Справка");
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппыС2, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];                       
	ЗаполнитьПоказательНаСервере("R020G4", ТаблицаБлока.Итог("С1T2RXXXXG4"), Форма, "Справка");
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппыС3, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	R030G4 = ПолучитьПоказательНаСервере("R031G4", Форма, "Справка") + ТаблицаБлока.Итог("С1T3RXXXXG4");
	ЗаполнитьПоказательНаСервере("R030G4", R030G4, Форма, "Справка");
	
	R01G4 = ПолучитьПоказательНаСервере("R010G4", Форма, "Справка") 
		+ ПолучитьПоказательНаСервере("R020G4", Форма, "Справка")
		+ ПолучитьПоказательНаСервере("R030G4", Форма, "Справка");
	ЗаполнитьПоказательНаСервере("R01G4", R01G4, Форма, "Справка");
	ЗаполнитьПоказательНаСервере("R50GA", R01G4, Форма, "Декларация");

	////////////////////////////////////////////////
	//Расчет для Приложения 7
	// таблица 1
	Если ПолучитьПоказательНаСервере("R011G4", Форма, "Приложение7") > 0 Тогда
		R011G6 = Окр(ПолучитьПоказательНаСервере("R011G5", Форма, "Приложение7") / ПолучитьПоказательНаСервере("R011G4", Форма, "Приложение7"), 4) * 100;
		R011G7 = 100 - R011G6;
	Иначе	
	    R011G6 = 0;
		R011G7 = 0;
	КонецЕсли;
	ЗаполнитьПоказательНаСервере("R011G6", R011G6, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R011G7", R011G7, Форма, "Приложение7");
	
	Если ПолучитьПоказательНаСервере("R012G4", Форма, "Приложение7") > 0 Тогда
		R012G6 = Окр(ПолучитьПоказательНаСервере("R012G5", Форма, "Приложение7") / ПолучитьПоказательНаСервере("R012G4", Форма, "Приложение7"), 4) * 100;
		R012G7 = 100 - R012G6;
	Иначе	
	    R012G6 = 0;
		R012G7 = 0;
	КонецЕсли;
	ЗаполнитьПоказательНаСервере("R012G6", R012G6, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R012G7", R012G7, Форма, "Приложение7");
	
	Если ПолучитьПоказательНаСервере("R0131G4", Форма, "Приложение7") > 0 Тогда
		R0131G6 = Окр(ПолучитьПоказательНаСервере("R0131G5", Форма, "Приложение7") / ПолучитьПоказательНаСервере("R0131G4", Форма, "Приложение7"), 4) * 100;
		R0131G7 = 100 - R0131G6;
	Иначе	
	    R0131G6 = 0;
		R0131G7 = 0;
	КонецЕсли;
	ЗаполнитьПоказательНаСервере("R0131G6", R0131G6, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R0131G7", R0131G7, Форма, "Приложение7");
	
	Если ПолучитьПоказательНаСервере("R0132G4", Форма, "Приложение7") > 0 Тогда
		R0132G6 = Окр(ПолучитьПоказательНаСервере("R0132G5", Форма, "Приложение7") / ПолучитьПоказательНаСервере("R0132G4", Форма, "Приложение7"), 4) * 100;
		R0132G7 = 100 - R0132G6;
	Иначе	
	    R0132G6 = 0;
		R0132G7 = 0;
	КонецЕсли;
	ЗаполнитьПоказательНаСервере("R0132G6", R0132G6, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R0132G7", R0132G7, Форма, "Приложение7");
	
	Если ПолучитьПоказательНаСервере("R0133G4", Форма, "Приложение7") > 0 Тогда
		R0133G6 = Окр(ПолучитьПоказательНаСервере("R0133G5", Форма, "Приложение7") / ПолучитьПоказательНаСервере("R0133G4", Форма, "Приложение7"), 4) * 100;
		R0133G7 = 100 - R0133G6;
	Иначе	
	    R0133G6 = 0;
		R0133G7 = 0;
	КонецЕсли;
	ЗаполнитьПоказательНаСервере("R0133G6", R0133G6, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R0133G7", R0133G7, Форма, "Приложение7");
	
	Если    Форма.СтруктураРеквизитовФормы.мНеВыдаватьСообщенияОбОшибкахВРасчете = Истина
		ИЛИ Форма.СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете 
		ИЛИ НЕ ЭтоОбычнаяДекларация Тогда
	ИначеЕсли (ПолучитьПоказательНаСервере("R011G4", Форма, "Приложение7") > 0  И  ПолучитьПоказательНаСервере("R012G4", Форма, "Приложение7") > 0)
			ИЛИ 
			  (ПолучитьПоказательНаСервере("R011G5", Форма, "Приложение7") > 0  И  ПолучитьПоказательНаСервере("R012G5", Форма, "Приложение7") > 0)  Тогда									
		ТекстСообщенияОбОшибкахРасчета = ТекстСообщенияОбОшибкахРасчета + Символы.ПС + Символы.Таб 
		+ НСтр("ru = 'Внимание: В таблице 1 Приложения 7 заполнены обе строки 1 и 2. Заполнять можно только одну строку из двух!'; uk = 'Увага: В таблиці 1 Додатка 7 заповнені обидва рядки 1 и 2. Заповнювати можна тільки один з двох рядків!'");
	КонецЕсли;
	
	HCHV = ?(ПолучитьПоказательНаСервере("R011G6", Форма, "Приложение7") = 0, ПолучитьПоказательНаСервере("R012G6", Форма, "Приложение7"), ПолучитьПоказательНаСервере("R011G6", Форма, "Приложение7"));
	ЗаполнитьПоказательНаСервере("HCHV", HCHV, Форма, "Приложение7");
	
	// таблица 2
	Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы7, ТаблицаБлока);
	ТаблицаБлока = Форма[ТаблицаБлока];
	ЗаполнитьПоказательНаСервере("R02G6", ТаблицаБлока.Итог("П7T2RXXXXG6"), Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R02G7", ТаблицаБлока.Итог("П7T2RXXXXG7"), Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R02G8", ТаблицаБлока.Итог("П7T2RXXXXG8"), Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R02G9", ТаблицаБлока.Итог("П7T2RXXXXG9"), Форма, "Приложение7");
	
	R150GB = 0;
	
	R031G7 = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R031G6", Форма, "Приложение7")) - ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R031G5", Форма, "Приложение7"));
	R032G7 = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R032G6", Форма, "Приложение7")) - ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R032G5", Форма, "Приложение7"));
	R033G7 = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R033G6", Форма, "Приложение7")) - ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R033G5", Форма, "Приложение7"));
	
	R150GB = R150GB + R031G7 + R032G7 + R033G7;	
	
	ЗаполнитьПоказательНаСервере("R031G7", R031G7, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R032G7", R032G7, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R033G7", R033G7, Форма, "Приложение7");
	ЗаполнитьПоказательНаСервере("R150GB", R150GB, Форма, "Декларация");
	
	////////////////////////////////////////////////
	// Расчет Приложения 9
	СуммаПоСтолбцу3 = 0;
	СуммаПоСтолбцу4 = 0;
	СуммаПоСтолбцу5 = 0;
	СуммаПоСтолбцу6 = 0;
	СуммаПоСтолбцу7 = 0;
	СуммаПоСтолбцу8 = 0;
	
	ЗаполнитьПоказательНаСервере("R02G3", 0, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R02G4", 0, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R02G5", 0, Форма, "Приложение9");
	
	ЗаполнитьПоказательНаСервере("R03G6", 0, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R03G7", 0, Форма, "Приложение9");
	
	Для СтрНомер = 1 По 12 Цикл
		ИмяТекущейЯчейкиСтолбца3 = "R" +  Формат(СтрНомер,"ЧЦ=3;ЧВН=0;ЧГ=;") + "G3";
		ИмяТекущейЯчейкиСтолбца4 = "R" +  Формат(СтрНомер,"ЧЦ=3;ЧВН=0;ЧГ=;") + "G4";
		ИмяТекущейЯчейкиСтолбца5 = "R" +  Формат(СтрНомер,"ЧЦ=3;ЧВН=0;ЧГ=;") + "G5";
		ИмяТекущейЯчейкиСтолбца6 = "R" +  Формат(СтрНомер,"ЧЦ=3;ЧВН=0;ЧГ=;") + "G6";
		ИмяТекущейЯчейкиСтолбца7 = "R" +  Формат(СтрНомер,"ЧЦ=3;ЧВН=0;ЧГ=;") + "G7";
		ИмяТекущейЯчейкиСтолбца8 = "R" +  Формат(СтрНомер,"ЧЦ=3;ЧВН=0;ЧГ=;") + "G8";
		
		ЗначениеСтолбца6 = ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца3, Форма, "Приложение9") 
							+ ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца4, Форма, "Приложение9")
							+ ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца5, Форма, "Приложение9");
		ЗаполнитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца6, ЗначениеСтолбца6, Форма, "Приложение9");
		ЗначениеСтолбца8 = ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца6, Форма, "Приложение9") 
							+ ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца7, Форма, "Приложение9");
		ЗаполнитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца8, ЗначениеСтолбца8, Форма, "Приложение9");
																
		СуммаПоСтолбцу3 = СуммаПоСтолбцу3 + ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца3, Форма, "Приложение9");
		СуммаПоСтолбцу4 = СуммаПоСтолбцу4 + ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца4, Форма, "Приложение9");
		СуммаПоСтолбцу5 = СуммаПоСтолбцу5 + ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца5, Форма, "Приложение9");
		СуммаПоСтолбцу6 = СуммаПоСтолбцу6 + ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца6, Форма, "Приложение9");
		СуммаПоСтолбцу7 = СуммаПоСтолбцу7 + ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца7, Форма, "Приложение9");
		СуммаПоСтолбцу8 = СуммаПоСтолбцу8 + ПолучитьПоказательНаСервере(ИмяТекущейЯчейкиСтолбца8, Форма, "Приложение9");
	КонецЦикла;	
	
	ЗаполнитьПоказательНаСервере("R01G3", СуммаПоСтолбцу3, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R01G4", СуммаПоСтолбцу4, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R01G5", СуммаПоСтолбцу5, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R01G6", СуммаПоСтолбцу6, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R01G7", СуммаПоСтолбцу7, Форма, "Приложение9");
	ЗаполнитьПоказательНаСервере("R01G8", СуммаПоСтолбцу8, Форма, "Приложение9");
	
	Если Не СуммаПоСтолбцу6 = 0 Тогда
	    ЗаполнитьПоказательНаСервере("R02G3", 100 * СуммаПоСтолбцу3 / СуммаПоСтолбцу6, Форма, "Приложение9");
	    ЗаполнитьПоказательНаСервере("R02G4", 100 * СуммаПоСтолбцу4 / СуммаПоСтолбцу6, Форма, "Приложение9");
	    ЗаполнитьПоказательНаСервере("R02G5", 100 * СуммаПоСтолбцу5 / СуммаПоСтолбцу6, Форма, "Приложение9");
	Иначе
	    ЗаполнитьПоказательНаСервере("R02G3", 0, Форма, "Приложение9");
	    ЗаполнитьПоказательНаСервере("R02G4", 0, Форма, "Приложение9");
	    ЗаполнитьПоказательНаСервере("R02G5", 0, Форма, "Приложение9");
	КонецЕсли;
	
	Если Не СуммаПоСтолбцу8 = 0 Тогда
	    ЗаполнитьПоказательНаСервере("R03G6", 100 * СуммаПоСтолбцу6 / СуммаПоСтолбцу8, Форма, "Приложение9");
	    ЗаполнитьПоказательНаСервере("R03G7", 100 * СуммаПоСтолбцу7 / СуммаПоСтолбцу8, Форма, "Приложение9");
	Иначе
	    ЗаполнитьПоказательНаСервере("R03G6", 0, Форма, "Приложение9");
	    ЗаполнитьПоказательНаСервере("R03G7", 0, Форма, "Приложение9");
	КонецЕсли;		
	
	/////////////////////////////////////////////////////////////////
	// приложение 10
	R0104GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0101GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0103GB", Форма, "Приложение10"));
    ЗаполнитьПоказательНаСервере("R0104GB", R0104GB, Форма, "Приложение10");
	R0111GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01111GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01112GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01113GB", Форма, "Приложение10"));
    ЗаполнитьПоказательНаСервере("R0111GB", R0111GB, Форма, "Приложение10");
	R0112GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01051GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01052GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01061GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01062GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01063GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0107GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0108GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0109GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0110GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0111GB", Форма, "Приложение10"));
    ЗаполнитьПоказательНаСервере("R0112GB", R0112GB, Форма, "Приложение10");
											
	Если R0104GB > R0112GB Тогда
		R0113GB  = R0104GB - R0112GB;
		R01131GB = R0113GB * 0.85;
		R01132GB = R0113GB * 0.15;
		R0114GB  = 0;
	Иначе	
		R0113GB  = 0;
		R01131GB = 0;
		R01132GB = 0;
		R0114GB  = -(R0104GB - R0112GB);
	КонецЕсли;											
    ЗаполнитьПоказательНаСервере("R0113GB", R0113GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R01131GB", R01131GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R01132GB", R01132GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R0114GB", R0114GB, Форма, "Приложение10");
											
	R0204GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0201GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0203GB", Форма, "Приложение10"));
    ЗаполнитьПоказательНаСервере("R0204GB", R0204GB, Форма, "Приложение10");
	R0211GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02111GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02112GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02113GB", Форма, "Приложение10"));
    ЗаполнитьПоказательНаСервере("R0211GB", R0211GB, Форма, "Приложение10");
	R0212GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02051GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02052GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02061GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02062GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02063GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0207GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0208GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0209GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0210GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0211GB", Форма, "Приложение10"));
    ЗаполнитьПоказательНаСервере("R0212GB", R0212GB, Форма, "Приложение10");
											
	Если R0204GB > R0212GB Тогда
		R0213GB  = R0204GB - R0212GB;
		R02131GB = R0213GB * 0.2;
		R02132GB = R0213GB * 0.8;
		R0214GB  = 0;
	Иначе	
		R0213GB  = 0;
		R02131GB = 0;
		R02132GB = 0;
		R0214GB  = -(R0204GB - R0212GB);
	КонецЕсли;		
    ЗаполнитьПоказательНаСервере("R0213GB", R0213GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R02131GB", R02131GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R02132GB", R02132GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R0214GB", R0214GB, Форма, "Приложение10");
	
	R0304GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0301GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0303GB", Форма, "Приложение10"));
	ЗаполнитьПоказательНаСервере("R0304GB", R0304GB, Форма, "Приложение10");
	R0311GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03111GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03112GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03113GB", Форма, "Приложение10"));
	ЗаполнитьПоказательНаСервере("R0311GB", R0311GB, Форма, "Приложение10");
	R0312GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03051GB", Форма, "Приложение10")) 
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03052GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03061GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03062GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03063GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0307GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0308GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0309GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0310GB", Форма, "Приложение10"))
											+ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0311GB", Форма, "Приложение10"));
	ЗаполнитьПоказательНаСервере("R0312GB", R0312GB, Форма, "Приложение10");
											
											
	Если R0304GB > R0312GB Тогда
		R0313GB  = R0304GB - R0312GB;
		R03131GB = R0313GB * 0.5;
		R03132GB = R0313GB * 0.5;
		R0314GB  = 0;
	Иначе	
		R0313GB  = 0;
		R03131GB = 0;
		R03132GB = 0;
		R0314GB  = -(R0304GB - R0312GB);
	КонецЕсли;											
    ЗаполнитьПоказательНаСервере("R0313GB", R0313GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R03131GB", R03131GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R03132GB", R03132GB, Форма, "Приложение10");
    ЗаполнитьПоказательНаСервере("R0314GB", R0314GB, Форма, "Приложение10");
	
	Если НЕ ЭтоОбычнаяДекларация Тогда
		
		R11GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0101GA", Форма, "Приложение10"))
	                                        	+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0201GA", Форма, "Приложение10"))
												+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0301GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R11GA", R11GA, Форма, "Декларация");
		R11GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0101GB", Форма, "Приложение10"))
	                                        	+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0201GB", Форма, "Приложение10"))
												+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0301GB", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R11GB", R11GB, Форма, "Декларация");
   		ЗаполнитьПоказательНаСервере("R12GA", 0, Форма, "Декларация");
   		ЗаполнитьПоказательНаСервере("R12GB", 0, Форма, "Декларация");
		
		R20GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0102GA", Форма, "Приложение10"))
	                                        	+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0202GA", Форма, "Приложение10"))
												+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0302GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R20GA", R20GA, Форма, "Декларация");
		
   		ЗаполнитьПоказательНаСервере("R41GA", 0, Форма, "Декларация");
   		ЗаполнитьПоказательНаСервере("R41GB", 0, Форма, "Декларация");
   		ЗаполнитьПоказательНаСервере("R42GA", 0, Форма, "Декларация");
   		ЗаполнитьПоказательНаСервере("R42GB", 0, Форма, "Декларация");
		
		R70GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0103GA", Форма, "Приложение10"))
	                                        	+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0203GA", Форма, "Приложение10"))
												+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0303GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R70GA", R70GA, Форма, "Декларация");
		R70GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0103GB", Форма, "Приложение10"))
	                                        	+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0203GB", Форма, "Приложение10"))
												+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0303GB", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R70GB", R70GB, Форма, "Декларация");
		
		
		R101GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01051GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02051GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03051GA", Форма, "Приложение10"));
   		ЗаполнитьПоказательНаСервере("R101GA", R101GA, Форма, "Декларация");
		R101GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01051GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02051GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03051GB", Форма, "Приложение10"));
   		ЗаполнитьПоказательНаСервере("R101GB", R101GB, Форма, "Декларация");
												 
		R102GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01052GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02052GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03052GA", Форма, "Приложение10"));
   		ЗаполнитьПоказательНаСервере("R102GA", R102GA, Форма, "Декларация");
		R102GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01052GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02052GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03052GB", Форма, "Приложение10"));
   		ЗаполнитьПоказательНаСервере("R102GB", R102GB, Форма, "Декларация");
												 
		//R103GB = 0;
		
		R111GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01061GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02061GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03061GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R111GA", R111GA, Форма, "Декларация");
		R111GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01061GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02061GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03061GB", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R111GB", R111GB, Форма, "Декларация");
		
												 
		R112GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01062GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02062GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03062GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R112GA", R112GA, Форма, "Декларация");
		R112GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01062GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02062GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03062GB", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R112GB", R112GB, Форма, "Декларация");
		
		//R113GA = 0;		
		//R113GB = 0;
		
		R114GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01063GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02063GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03063GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R114GA", R114GA, Форма, "Декларация");
		R114GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01063GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02063GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03063GB", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R114GB", R114GB, Форма, "Декларация");
		
		R120GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0107GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0207GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0307GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R120GA", R120GA, Форма, "Декларация");
		R120GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0107GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0207GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0307GB", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R120GB", R120GB, Форма, "Декларация");
												 
		R130GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0108GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0208GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0308GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R130GA", R130GA, Форма, "Декларация");
		R130GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0108GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0208GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0308GB", Форма, "Приложение10"));													 
   		ЗаполнитьПоказательНаСервере("R130GA", R130GA, Форма, "Декларация");
												 
												 
		R140GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0109GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0209GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0309GB", Форма, "Приложение10"));													 
   		ЗаполнитьПоказательНаСервере("R140GB", R140GB, Форма, "Декларация");
												 
												 
		R150GA = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0110GA", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0210GA", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0310GA", Форма, "Приложение10"));	
   		ЗаполнитьПоказательНаСервере("R150GA", R150GA, Форма, "Декларация");
		R150GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0110GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0210GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0310GB", Форма, "Приложение10"));
   		ЗаполнитьПоказательНаСервере("R150GB", R150GB, Форма, "Декларация");
												 
		R162GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01112GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02112GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03112GB", Форма, "Приложение10"));
   		ЗаполнитьПоказательНаСервере("R162GB", R162GB, Форма, "Декларация");
												 
		R163GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R01113GB", Форма, "Приложение10"))
	                                        	 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R02113GB", Форма, "Приложение10"))
												 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R03113GB", Форма, "Приложение10"));
   		ЗаполнитьПоказательНаСервере("R163GB", R163GB, Форма, "Декларация");
												 
	КонецЕсли;
	
	/////////////////////////////////////////////////////////////////
	// Декларация, 
	R90GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R11GB", Форма, "Декларация"))
	                                        + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R12GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R41GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R42GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R60GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R70GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R80GB", Форма, "Декларация"));
	ЗаполнитьПоказательНаСервере("R90GB", R90GB, Форма, "Декларация");
	
	R160GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R161GB", Форма, "Декларация"))
											 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R162GB", Форма, "Декларация"))
											 + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R163GB", Форма, "Декларация"));
	ЗаполнитьПоказательНаСервере("R160GB", R160GB, Форма, "Декларация");
											 
	R170GB = ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R101GB", Форма, "Декларация"))
	                                        + ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R102GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R111GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R112GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R113GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R114GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R120GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R130GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R140GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R150GB", Форма, "Декларация"))
											+ ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R160GB", Форма, "Декларация"));
	ЗаполнитьПоказательНаСервере("R170GB", R170GB, Форма, "Декларация");
	
	Если НЕ ЭтоОбычнаяДекларация Тогда											
		
		R180GB  =   ПолучитьПоказательНаСервере("R0113GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R0213GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R0313GB", Форма, "Приложение10");
		ЗаполнитьПоказательНаСервере("R180GB", R180GB, Форма, "Декларация");
		R181GB  =   ПолучитьПоказательНаСервере("R01131GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R02131GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R03131GB", Форма, "Приложение10");
		ЗаполнитьПоказательНаСервере("R181GB", R181GB, Форма, "Декларация");											
		R182GB  =   ПолучитьПоказательНаСервере("R01132GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R02132GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R03132GB", Форма, "Приложение10");
		ЗаполнитьПоказательНаСервере("R182GB", R182GB, Форма, "Декларация");											
		R190GB  =   ПолучитьПоказательНаСервере("R0114GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R0214GB", Форма, "Приложение10")
													+ ПолучитьПоказательНаСервере("R0314GB", Форма, "Приложение10");
		ЗаполнитьПоказательНаСервере("R190GB", R190GB, Форма, "Декларация");
		
		//ИНАГРО ++	
		ЗаполнитьПоказательНаСервере("R191GB", 0, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R191G3", 0, Форма, "Декларация");
		//ИНАГРО --
		
	Иначе	
		
		R90GB = ПолучитьПоказательНаСервере("R90GB", Форма, "Декларация");
		R170GB = ПолучитьПоказательНаСервере("R170GB", Форма, "Декларация");
		Если R90GB > R170GB Тогда
			R180GB = R90GB - R170GB;
			R181GB  = R180GB;
			R190GB  = 0;
		Иначе	
			R180GB = 0;
			R181GB = 0;
			R190GB = -(R90GB - R170GB);
		КонецЕсли;
		
		ЗаполнитьПоказательНаСервере("R180GB", R180GB, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R181GB", R181GB, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R182GB", 0, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R190GB", R190GB, Форма, "Декларация");
		
		//ИНАГРО ++
		R190GB = ПолучитьПоказательНаСервере("R190GB", Форма, "Декларация");
		Если R190GB > 0 Тогда
			R191GB =  ОкруглитьЧислоПоФормату(Форма, R190GB) - ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R191G3", Форма, "Декларация"));
			R191GB = ?(R191GB < 0, 0, R191GB);
		Иначе											  
			R191GB = 0;
		КонецЕсли;
		ЗаполнитьПоказательНаСервере("R191GB", R191GB, Форма, "Декларация");
		//ИНАГРО --
		
	КонецЕсли;
	
	//ИНАГРО ++
	//R190GB = ПолучитьПоказательНаСервере("R190GB", Форма, "Декларация");
	//Если R190GB > 0 Тогда
	//	R191GB =  ОкруглитьЧислоПоФормату(Форма, R190GB)
	//											  - ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R191G3", Форма, "Декларация"));
	//	R191GB = ?(R191GB < 0, 0, R191GB);
	//Иначе											  
	//	R191GB = 0;
	//КонецЕсли;
	//ЗаполнитьПоказательНаСервере("R191GB", R191GB, Форма, "Декларация");
	//ИНАГРО --
	
	Если ЭтоОбычнаяДекларация Тогда
		
		R200GB =  ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R190GB", Форма, "Декларация"))
												  - ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R191GB", Форма, "Декларация"));
		ЗаполнитьПоказательНаСервере("R200GB", R200GB, Форма, "Декларация");

		R201GB = ПолучитьПоказательНаСервере("R201GB", Форма, "Декларация");
		Если R201GB > ОкруглитьЧислоПоФормату(Форма, R200GB) Тогда
			
			R201GB = ОкруглитьЧислоПоФормату(Форма, R200GB);
		
		КонецЕсли;										  
		ЗаполнитьПоказательНаСервере("R201GB", R201GB, Форма, "Декларация");

		////////////////////////////////////////////////
		// Расчет Приложения 3
		R010G3 = R200GB - R201GB;
		ЗаполнитьПоказательНаСервере("R010G3", R010G3, Форма, "Приложение3");
		
		Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы31, ТаблицаБлока);
		ТаблицаБлока = Форма[ТаблицаБлока];
		
		R01G5 = ОкруглитьЧислоПоФормату(Форма, ТаблицаБлока.Итог("П3T1RXXXXG5"));
		ЗаполнитьПоказательНаСервере("R01G5", R01G5, Форма, "Приложение3");
		
		R01G6 = ОкруглитьЧислоПоФормату(Форма, ТаблицаБлока.Итог("П3T1RXXXXG6"));
		ЗаполнитьПоказательНаСервере("R01G6", R01G6, Форма, "Приложение3");
		
		////R020G3 = ПолучитьПоказательНаСервере("R020G3", Форма, "Приложение3");
		R020G3 = ?(R01G6 > 0, R01G6, 0);
		ЗаполнитьПоказательНаСервере("R020G3", R020G3, Форма, "Приложение3");
		
		R030G3 =  ?(R020G3 < R010G3, R020G3, R010G3);
		ЗаполнитьПоказательНаСервере("R030G3", R030G3, Форма, "Приложение3");
												
		R202GB = R030G3;
		ЗаполнитьПоказательНаСервере("R202GB", R202GB, Форма, "Декларация");
		
		R2021GB = ПолучитьПоказательНаСервере("R2021GB", Форма, "Декларация");
		R2022GB = ПолучитьПоказательНаСервере("R2022GB", Форма, "Декларация");
		Если R2021GB + R2022GB > R202GB Тогда
		
			R2021GB = ОкруглитьЧислоПоФормату(Форма, МИН(R2021GB, R202GB));
			ЗаполнитьПоказательНаСервере("R2021GB", R2021GB, Форма, "Декларация");
			
			//ИНАГРО ++
			R2022GB = ОкруглитьЧислоПоФормату(Форма, R202GB) - ОкруглитьЧислоПоФормату(Форма, R2021GB);
			ЗаполнитьПоказательНаСервере("R2022GB", R2022GB, Форма, "Декларация");
			//ИНАГРО --
			
		КонецЕсли;
		
		R2022GB = ОкруглитьЧислоПоФормату(Форма, R202GB) 
												  - ОкруглитьЧислоПоФормату(Форма, R2021GB);
		ЗаполнитьПоказательНаСервере("R2022GB", R2022GB, Форма, "Декларация");
		R203GB = ОкруглитьЧислоПоФормату(Форма, R200GB)
												  -ОкруглитьЧислоПоФормату(Форма, R201GB)
												  -ОкруглитьЧислоПоФормату(Форма, R202GB);
		ЗаполнитьПоказательНаСервере("R203GB", R203GB, Форма, "Декларация");
		R210GB = ОкруглитьЧислоПоФормату(Форма, R191GB)
												  +ОкруглитьЧислоПоФормату(Форма, R203GB);
		ЗаполнитьПоказательНаСервере("R210GB", R210GB, Форма, "Декларация");
		
		////////////////////////////////////////////////
		// Расчет Приложения 4              
		ЗаполнитьПоказательНаСервере("R0303G2", Формат(Месяц(Форма.СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета), "ЧЦ=2; ЧВН="), Форма, "Приложение4");
		ЗаполнитьПоказательНаСервере("R0303G3", Формат(Год(Форма.СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета), "ЧЦ=4; ЧВН=; ЧГ=0"), Форма, "Приложение4");
		
		Если Окр(R2021GB, 0) > 0 Тогда
			СуммаСловами = Окр(R2021GB, 0);
			R0304G1S = ЧислоПрописью(СуммаСловами, "Л=uk_UA; ДП=Ложь","гривня,гривні,гривень,ж,,,,,0");
			R0304G2  = Окр(R2021GB, 0);
		Иначе
			R0304G1S = "";
			R0304G2  = 0;
		КонецЕсли;
		ЗаполнитьПоказательНаСервере("R0304G1S", R0304G1S, Форма, "Приложение4");
		ЗаполнитьПоказательНаСервере("R0304G2", R0304G2, Форма, "Приложение4");
		
		R0306G5 = Окр(R2022GB, 0);
		ЗаполнитьПоказательНаСервере("R0306G5", R0306G5, Форма, "Приложение4");
		
		Форма.мСтруктураМногострочныхРазделов.Свойство(Форма.СтруктураРеквизитовФормы.мИдГруппы43, ТаблицаБлока);
		ТаблицаБлока = Форма[ТаблицаБлока];
		Итог = 0;
		Для каждого Строка Из ТаблицаБлока Цикл
			
			СуммаСловами = Окр(Строка.П4T3RXXXXG5, 0);
			
			ИмяЯчейкиПрописью = "П4T3RXXXXG4S_"+Формат(ТаблицаБлока.Индекс(Строка) + 1, "ЧГ=;");
			
			Если СуммаСловами > 0 Тогда	
				Строка.П4T3RXXXXG4S = ЧислоПрописью(СуммаСловами, "Л=uk_UA; ДП=Ложь","гривня,гривні,гривень,ж,,,,,0");
			Иначе
		    	Строка.П4T3RXXXXG4S = "";
			КонецЕсли;
			
			ЗаполнитьПоказательНаСервере(ИмяЯчейкиПрописью, Строка.П4T3RXXXXG4S, Форма, "Приложение4");
			
			Итог = Итог + СуммаСловами; 
			
		КонецЦикла;
		
		Если    Форма.СтруктураРеквизитовФормы.мНеВыдаватьСообщенияОбОшибкахВРасчете = Истина 
			ИЛИ Форма.СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете Тогда
		ИначеЕсли Итог <> Окр(ПолучитьПоказательНаСервере("R0306G5", Форма, "Приложение4"), 0) Тогда
			ТекстСообщенияОбОшибкахРасчета = ТекстСообщенияОбОшибкахРасчета + Символы.ПС + Символы.Таб 
			+ НСтр("ru = 'Не совпадает значение строки 20.2.2 Декларации и сумма по строкам в таблице из Приложения 4, которая расшифровывает данную строку!'; uk = 'Не співпадають значення рядка 20.2.2 Декларації та сума по рядкам у таблиці Додатку 4, що розшифровує даний показник!'");
		КонецЕсли;			
		
		R0401G4  =  ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0401G1", Форма, "Приложение4"))
												- ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0401G2", Форма, "Приложение4"));
		ЗаполнитьПоказательНаСервере("R0401G4", R0401G4, Форма, "Приложение4");										
		R0401G5  =  ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0401G1", Форма, "Приложение4"))
												- ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0401G2", Форма, "Приложение4"))
												- ОкруглитьЧислоПоФормату(Форма, ПолучитьПоказательНаСервере("R0401G3", Форма, "Приложение4"));
		ЗаполнитьПоказательНаСервере("R0401G5", R0401G5, Форма, "Приложение4");
												
		R0402G2 = ПолучитьПоказательНаСервере("R0402G2", Форма, "Приложение4");
		Если Окр(R0402G2, 0) > 0 Тогда
			СуммаСловами = Окр(R0402G2, 0);
			R0402G1S = ЧислоПрописью(СуммаСловами, "Л=uk_UA; ДП=Ложь","гривня,гривні,гривень,ж,,,,,0");
		Иначе		
		    R0402G1S = "";
		КонецЕсли;
		ЗаполнитьПоказательНаСервере("R0402G1S", R0402G1S, Форма, "Приложение4");
												
		R0403G2 = ПолучитьПоказательНаСервере("R0403G2", Форма, "Приложение4");
		Если Окр(R0403G2, 0) > 0 Тогда
			СуммаСловами = Окр(R0403G2, 0);
			R0403G1S = ЧислоПрописью(СуммаСловами, "Л=uk_UA; ДП=Ложь","гривня,гривні,гривень,ж,,,,,0");
		Иначе		
		    R0403G1S = "";
		КонецЕсли;				
		ЗаполнитьПоказательНаСервере("R0403G1S", R0403G1S, Форма, "Приложение4");
		
	Иначе
		
		ЗаполнитьПоказательНаСервере("R200GB", 0, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R201GB", 0, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R202GB", 0, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R2021GB", 0, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R2022GB", 0, Форма, "Декларация");
		ЗаполнитьПоказательНаСервере("R203GB", 0, Форма, "Декларация");
		
		ЗаполнитьПоказательНаСервере("R210GB", ПолучитьПоказательНаСервере("R190GB", Форма, "Декларация"), Форма, "Декларация");
		
	КонецЕсли;
	
	Если    Форма.СтруктураРеквизитовФормы.мНеВыдаватьСообщенияОбОшибкахВРасчете = Истина 
		ИЛИ Форма.СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете Тогда
	ИначеЕсли ЗначениеЗаполнено(ТекстСообщенияОбОшибкахРасчета) Тогда
		ТекстСообщенияОбОшибкахРасчета = НСтр("ru = 'Обнаружены расхождения, обычно связанные с арифметической погрешностью либо ошибкой в данных. Проверьте следующие значения:'; uk = 'Виявлені розбіжности, зазвичай пов''язані з арифметичною похибкою або помилкою в даних. Перевірте наступні значення:'")
		                                + ТекстСообщенияОбОшибкахРасчета;
		Сообщить(ТекстСообщенияОбОшибкахРасчета);								
	КонецЕсли;		
	
КонецПроцедуры // Расчет()

// ОкруглитьЧислоПоФормату(Форма, )
//
&НаКлиентеНаСервереБезКонтекста
Функция ОкруглитьЧислоПоФормату(Форма, ИсходноеЧисло)
	
	Перем Делитель;
	
	Если Форма.СоответствиеЕдиницыИзмеренияДелителю.Свойство("Окр" + СтрЗаменить(Форма.СтруктураРеквизитовФормы.ЕдиницаИзмерения, " ", ""), Делитель) Тогда
		
		Возврат Окр(ИсходноеЧисло / Делитель, Форма.СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения) * Делитель;
		
	КонецЕсли;
	
КонецФункции // ОкруглитьЧислоПоФормату(Форма, )

&НаКлиенте
Процедура ДобавитьСтраницу(Команда)
	
	ВставитьДополнительнуюСтраницуНаСервере(Элементы.РазделыОтчета.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим);
	
	СтруктураРеквизитовФормы.НомерТекущейСтраницы = Элементы.РазделыОтчета.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета;
	
КонецПроцедуры

&НаКлиенте
Процедура УдалитьСтраницу(Команда)
	
	ПоказатьВопрос(Новый ОписаниеОповещения("УдалитьСтраницуЗавершение", ЭтотОбъект), НСтр("ru='Удалить текущую страницу?';uk='Видалити поточну сторінку?'"), РежимДиалогаВопрос.ДаНет, 60, КодВозвратаДиалога.Да);
			
КонецПроцедуры

&НаКлиенте
Процедура УдалитьСтраницуЗавершение(РезультатВопроса, ДополнительныеПараметры) Экспорт
    
    Если РезультатВопроса = КодВозвратаДиалога.Нет Тогда
        Возврат;
    КонецЕсли;
    
    ТекущиеДанные = Элементы.РазделыОтчета.ТекущиеДанные;
    
    КопияТекущиеДанные = ТекущиеДанные;
    
    ТекущиеДанные = ТекущиеДанные.ПолучитьРодителя();
    
    Если ТекущиеДанные = Неопределено Тогда
        Возврат;
    КонецЕсли;
    
    Если ТекущиеДанные.ПолучитьЭлементы().Количество() = 1 Тогда
        Возврат;
    КонецЕсли;
    
    ТекущаяСтраницаРазделаПослеУдаления = Неопределено;
    Если КопияТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета = ТекущиеДанные.ПолучитьЭлементы().Количество() Тогда
        ТекущаяСтраницаРазделаПослеУдаления = РегламентированнаяОтчетностьКлиентСервер.НайтиЭлементВДанныхФормыДерево(ТекущиеДанные.ПолучитьЭлементы(), "КолонкаНомерСтраницыРазделаОтчета", КопияТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета - 1);
        СтруктураРеквизитовФормы.НомерТекущейСтраницы = ТекущаяСтраницаРазделаПослеУдаления.КолонкаНомерСтраницыРазделаОтчета;
    КонецЕсли;
    
    УдалитьДополнительнуюСтраницуНаСервере(Элементы.РазделыОтчета.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим);
    
    ТекущиеДанные.ПолучитьЭлементы().Удалить(ТекущиеДанные.ПолучитьЭлементы().Индекс(КопияТекущиеДанные));
	
	НомерСтраницы = 1;
	
	Для Каждого СтраницаРаздела Из ТекущиеДанные.ПолучитьЭлементы() Цикл
	    
	    СтраницаРаздела.КолонкаРазделыОтчета              = НСтр("ru='Стр. ';uk='Стр. '") + НомерСтраницы;
	    СтраницаРаздела.КолонкаНомерСтраницыРазделаОтчета = НомерСтраницы;
	    
	    НомерСтраницы = НомерСтраницы + 1;
	    
	КонецЦикла;
    
    Если НЕ ТекущаяСтраницаРазделаПослеУдаления = Неопределено Тогда
        Элементы.РазделыОтчета.ТекущаяСтрока = ТекущаяСтраницаРазделаПослеУдаления.ПолучитьИдентификатор();
    КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура УдалитьВсеСтраницы(Команда)
	
	ТекущиеДанные = Элементы.РазделыОтчета.ТекущиеДанные;
	
	Если ТекущиеДанные.ПолучитьРодителя() = Неопределено
	   И ТекущиеДанные.ПолучитьЭлементы().Количество() <= 1 Тогда
		Возврат;
	КонецЕсли;
	
	Если НЕ ТекущиеДанные.ПолучитьРодителя() = Неопределено Тогда
		Если ТекущиеДанные.ПолучитьРодителя().ПолучитьЭлементы().Количество() <= 1 Тогда
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	РегламентированнаяОтчетностьКлиент.МеханизмыОчисткиРегламентированныхОтчетов(ЭтаФорма, "ОчиститьТекущийРаздел" + ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим);
	
	СтруктураРеквизитовФормы.НомерТекущейСтраницы = Элементы.РазделыОтчета.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета;
			
КонецПроцедуры

&НаСервере
Процедура ВставитьДополнительнуюСтраницуНаСервере(ИмяТекущейСтраницыПанели = Неопределено)

	Перем ТаблицаСтраницРаздела;
	Перем СтруктураДанныхДопСтрокРаздела;

	Если ИмяТекущейСтраницыПанели = Неопределено Тогда
		ИмяТекущейСтраницыПанели = СтруктураРеквизитовФормы.НаимТекущегоРаздела;
	КонецЕсли;
	
	СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Ложь;
	
	Если Не мСтруктураМногостраничныхРазделов.Свойство(ИмяТекущейСтраницыПанели, ТаблицаСтраницРаздела) Тогда
		Возврат;
	Иначе
		МаксКолвоЭкз = РегламентированнаяОтчетностьКлиентСервер.ПолучитьСвойствоРаздела(ЭтаФорма, ИмяТекущейСтраницыПанели, "МаксКолвоЭкз", 0);
		Если МаксКолвоЭкз <> 0 И ЭтаФорма[мСтруктураМногостраничныхРазделов[ИмяТекущейСтраницыПанели]].Количество() >= МаксКолвоЭкз Тогда
			ЗаголовокСтраницы = ИмяТекущейСтраницыПанели;
						
			Сообщение = Новый СообщениеПользователю;

			Сообщение.Текст = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='В разделе ""%1"" максимальное количество экземпляров страниц равно %2.';uk='В розділі ""%1"" максимальна кількість екземплярів сторінок дорівнює 
|%2.'"), ЗаголовокСтраницы, МаксКолвоЭкз);

			Сообщение.Сообщить();
			
			СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Истина;
			
			Возврат;
			
		КонецЕсли;
	КонецЕсли;
	
	ИмяТекТабличногоПоля     = "ТабличныйДокумент";
	ТекТабличноеПоле         = ЭтаФорма[ИмяТекТабличногоПоля];
		
	// Сначала сохраним данные текущей страницы.
	СтруктураДанныхТекущейТаблицы = СобратьДанныеТекущегоТаблПоля(ЭтаФорма, ИмяТекТабличногоПоля);

	// Для страниц многостраничного раздела, содержащих многострочную часть,
	// дополнительно сохраняем данные многострочной части.
	СтруктураДанныхДопСтрокРаздела = СформироватьСтруктуруДанныхДопСтрокСтраницы(ЭтаФорма, ИмяТекущейСтраницыПанели);	
	
	ТаблицаСтраницРаздела = ЭтаФорма[ТаблицаСтраницРаздела];
	
	// Найдем активную страницу
	СтрТаблицаСтраницы = ТаблицаСтраницРаздела.НайтиСтроки(Новый Структура ("АктивнаяСтраница", Истина));
	
	Если СтрТаблицаСтраницы.Количество() = 0 Тогда
		Возврат;
	Иначе
		СтрТаблицаСтраницы = СтрТаблицаСтраницы[0];
		СтрТаблицаСтраницы.АктивнаяСтраница = Ложь;
	КонецЕсли;
	
	ОпределитьПредставлениеДопСтраниц(ИмяТекущейСтраницыПанели);
	
	Если СтрТаблицаСтраницы.Данные.Количество() > 0 Тогда
		СтрТаблицаСтраницы.Данные[0].Значение = СтруктураДанныхТекущейТаблицы;
	Иначе
		СтрТаблицаСтраницы.Данные.Добавить(СтруктураДанныхТекущейТаблицы);
	КонецЕсли;
	Если (ИмяТекущейСтраницыПанели = "Декларация") Тогда
		
		Если СтрТаблицаСтраницы.ДанныеДопСтрок.Количество() > 0 Тогда
			СтрТаблицаСтраницы.ДанныеДопСтрок[0].Значение = СтруктураДанныхДопСтрокРаздела;
		Иначе
			СтрТаблицаСтраницы.ДанныеДопСтрок.Добавить(СтруктураДанныхДопСтрокРаздела, "ДанныеФормыКоллекцияТаблицаДопСтрокРаздела");
		КонецЕсли;
		
	КонецЕсли;
	
	// Добавляем новую страницу
	СтрНоваяСтраница = ТаблицаСтраницРаздела.Добавить();
	
	// Присваиваем представление по умолчанию
	СтрНоваяСтраница.Представление = НСтр("ru='Стр. ';uk='Стр. '") + ТаблицаСтраницРаздела.Количество();
	СтрНоваяСтраница.АвтоматическоеПредставление = Истина;
	
	// Ставим признак активной страницы
	СтрНоваяСтраница.АктивнаяСтраница = Истина;
	
	ПослеДобавленияДопСтрНаСервере(ИмяТекТабличногоПоля, ИмяТекущейСтраницыПанели);
	
	Модифицированность = Истина;
			
КонецПроцедуры // ВставитьДополнительнуюСтраницуНаСервере()

&НаСервере
Процедура ПослеДобавленияДопСтрНаСервере(ИмяТекТабличногоПоля, ИмяТекущейСтраницыПанели)
	
	ОчиститьТабличноеПолеНаСервере(ИмяТекущейСтраницыПанели);
		
	СохранитьДанныеМногостраничногоРазделаВактивнойСтраницеНаСервере(ИмяТекущейСтраницыПанели);
	
	ПослеВставкиДополнительнойСтраницыНаСервере(ИмяТекущейСтраницыПанели);
	
КонецПроцедуры // ПослеДобавленияДопСтрНаСервере()

&НаСервере
Процедура ПослеВставкиДополнительнойСтраницыНаСервере(ИмяТекущейСтраницыПанели)
	
	Если ИмяТекущейСтраницыПанели = "Декларация" Тогда
		ИзменитьЦветЯчеекНаСервере();
	КонецЕсли;
	
	РегламентированнаяОтчетность.ПослеВставкиДополнительнойСтраницыНаСервере(ЭтаФорма, ИмяТекущейСтраницыПанели);
		
КонецПроцедуры // ПослеВставкиДополнительнойСтраницыНаСервере()

&НаСервере
Процедура СохранитьДанныеМногостраничногоРазделаВактивнойСтраницеНаСервере(ИмяТекущейСтраницыПанели)
	
	//итоговые ячейки не очистились - необходимо провести расчет
	//для этого сохраним данные страницы
	РегламентированнаяОтчетностьКлиентСервер.СохранитьДанныеМногостраничногоРазделаВактивнойСтранице(ЭтаФорма, ИмяТекущейСтраницыПанели, Истина);
	
КонецПроцедуры // СохранитьДанныеМногостраничногоРазделаВактивнойСтраницеНаСервере()

&НаСервере
Процедура УдалитьДополнительнуюСтраницуНаСервере(ИмяТекущейСтраницыПанели = Неопределено)

	РегламентированнаяОтчетность.УдалитьДополнительнуюСтраницуНаСервере(ЭтаФорма, ИмяТекущейСтраницыПанели);
	
	РасчетНаСервере(СтруктураРеквизитовФормы.НаимТекущегоРаздела);
	
	СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Ложь;
		
КонецПроцедуры // УдалитьДополнительнуюСтраницуНаСервере()

// ДобавитьСтроку()
//
&НаКлиенте
Процедура ДобавитьСтроку(Команда)
	
	#Если ВебКлиент Тогда
		
		ВставитьДополнительнуюСтрокуНаСервере();
		
	#Иначе
		
		ВставитьДополнительнуюСтрокуНаКлиенте();
		
	#КонецЕсли
	
КонецПроцедуры // ДобавитьСтроку()

// УдалитьСтроку()
//
&НаКлиенте
Процедура УдалитьСтроку(Команда)
	
	ТекТабличноеПоле = ЭтаФорма["ТабличныйДокумент"];

	ТекущаяОбласть = ТекТабличноеПоле.ТекущаяОбласть;
	ИмяГруппы      = РегламентированнаяОтчетностьКлиент.РазделТекущейОбласти(ЭтаФорма, ТекущаяОбласть);
	
	Если ИмяГруппы = Неопределено Тогда
		
		Сообщение = Новый СообщениеПользователю;

		Сообщение.Текст = НСтр("ru='Не выбрана удаляемая строка многострочного раздела.';uk='Не обрано строку багаторядкового розділу, що видаляється'");
	
		Сообщение.Сообщить();
		
		Возврат;
		
	КонецЕсли;

	Ответ = Неопределено;

	ПоказатьВопрос(Новый ОписаниеОповещения("УдалитьСтрокуЗавершение", ЭтотОбъект), СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='Удалить выбранную строку?%1(Внимание! Данная операция необратима)';uk='Вилучити вибраний рядок?%1(Увага! Дана операція необоротна)'"), Символы.ПС), РежимДиалогаВопрос.ДаНет, , КодВозвратаДиалога.Да);
	
КонецПроцедуры

&НаКлиенте
Процедура УдалитьСтрокуЗавершение(РезультатВопроса, ДополнительныеПараметры) Экспорт
    
    Ответ = РезультатВопроса;
    
    Если Ответ <> КодВозвратаДиалога.Да Тогда
        Возврат;
    КонецЕсли;
    
    #Если ВебКлиент Тогда
        УдалитьДополнительнуюСтрокуНаСервере();
    #Иначе
        УдалитьДополнительнуюСтрокуНаКлиенте();
    #КонецЕсли
	
КонецПроцедуры // УдалитьСтроку()

&НаСервере
Процедура ВставитьДополнительнуюСтрокуНаСервере()
	
	ВставитьДополнительнуюСтроку(ЭтаФорма);
	
КонецПроцедуры // ВставитьДополнительнуюСтрокуНаСервере()

&НаКлиенте
Процедура ВставитьДополнительнуюСтрокуНаКлиенте()
	
	ВставитьДополнительнуюСтроку(ЭтаФорма);
	
КонецПроцедуры // ВставитьДополнительнуюСтрокуНаКлиенте()

// Создает новую строку многострочного раздела.
// Процедура вставляет строку в многострочный блок.
//
// Параметры:
//  Форма          - ссылка на форму отчета
//  ИмяГруппыБлока - имя группы, в том случае, если необходимо вставить строки в процедурах автозаполнения, без фокусировок.
//  СпециальноеДобавление - режим добавления строк по нестандартному алгоритму, когда в правой части распологаются данные.
//  ИмяКолонкиНомера - имя колонки, в которой необходимо проставлять номер при вставки строки.
//
&НаКлиентеНаСервереБезКонтекста
Процедура ВставитьДополнительнуюСтроку(Форма, ИмяГруппыБлока = Неопределено, СпециальноеДобавление = Ложь, ИмяКолонкиНомера = Неопределено, НомерПервойСтроки = 1) Экспорт
	Перем СтруктураГруппы;
	Перем МаксимальноеКоличествоСтрокГруппы;

	Если ИмяГруппыБлока = Неопределено Тогда
		// Сначала выполним проверку на активную страницу панели формы,
		// которая содержит многострочный раздел
			
		ТекущаяСтраница = Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела;
		ТекТабличноеПоле = Форма.ТабличныйДокумент;

		ТекущаяОбласть = Форма.Элементы["ТабличныйДокумент"].ТекущаяОбласть;
		#Если НаКлиенте Тогда
			ИмяГруппы = РегламентированнаяОтчетностьКлиент.РазделТекущейОбласти(Форма, ТекущаяОбласть);
		#Иначе
			ИмяГруппы = РегламентированнаяОтчетностьВызовСервера.РазделТекущейОбластиНаСервере(Форма, ТекущаяОбласть);
		#КонецЕсли

		Если ИмяГруппы = Неопределено Тогда
			
			Сообщение = Новый СообщениеПользователю;

			Сообщение.Текст = НСтр("ru='Не выбран многострочный раздел, в который необходимо добавить строку.';uk='Не обрано багаторядковий розділ, у який необхідно додати рядок.'");

			Сообщение.Сообщить();
			
			Возврат;
			
		КонецЕсли;
	Иначе
		ИмяГруппы = ИмяГруппыБлока;
	КонецЕсли;

	Если ИмяГруппы = "D6" И СпециальноеДобавление = Ложь Тогда
		ВставитьДополнительнуюСтроку(Форма, "DT1R", Истина);
	ИначеЕсли ИмяГруппы = "DT1R" И СпециальноеДобавление = Ложь Тогда
		ВставитьДополнительнуюСтроку(Форма, "D6", Истина);
	ИначеЕсли СпециальноеДобавление = Истина Тогда
		СпециальноеДобавление = Ложь;	
	КонецЕсли;
	
	// Исходное количество строк группы
	Форма.мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, МаксимальноеКоличествоСтрокГруппы);

	ТекТабличноеПолеИмя = "ТабличныйДокумент";
	
	ТекТабличноеПоле = Форма[ТекТабличноеПолеИмя];
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);
	
	СтруктураГруппы = Форма[СтруктураГруппы];

	// определяем последнюю строку многострочной группы
	КолСтрок = СтруктураГруппы.Количество();
	КолСтрокСтр = Формат(КолСтрок, "ЧГ=0");
	
	КолонкиГруппы = Форма.СтруктураРеквизитовФормы.КолонкиМногострочныхРазделов[ИмяГруппы];
	
	Если ИмяКолонкиНомера = Неопределено Тогда
		
		Для каждого Колонка Из КолонкиГруппы Цикл
			
			Если Найти(ВРЕГ(Колонка), "НОМЕРСТРОКИ") > 0 Тогда
				ИмяКолонкиНомера = Колонка;	
				Прервать;
			КонецЕсли;
		
		КонецЦикла;
		
	КонецЕсли;
	Если НомерПервойСтроки = Неопределено Тогда
		НомерПервойСтроки = 1;
	КонецЕсли;
	
	ИмяПервойКолонки = КолонкиГруппы[0];
	ИмяПервойЯчейкиПоследнейСтроки = ИмяПервойКолонки + "_" + КолСтрокСтр;

	// область первой ячейки последней строки многострочного раздела
	ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяПервойЯчейкиПоследнейСтроки];

	НастройкиМнгЧ = РегламентированнаяОтчетностьКлиентСервер.ПолучитьСвойствоРаздела(Форма, Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела, "МногострочностьВРазделе").НайтиСтроки(Новый Структура("ИдГруппы", ИмяГруппы))[0];
	ВысотаСтроки = НастройкиМнгЧ.ВысотаСтроки;
	
	// номера строк исходной области
	НомерВерхЯчейкиОбласти = ОбластьЯчейки.Верх;
	НомерНижнЯчейкиОбласти = ОбластьЯчейки.Верх + ВысотаСтроки - 1;
		
	СдвигСтрок = НомерНижнЯчейкиОбласти - НомерВерхЯчейкиОбласти + 1;

	// номера строк вставляемой области
	НомерВерхЯчейкиНовойОбласти = НомерВерхЯчейкиОбласти + СдвигСтрок;
	НомерНижнЯчейкиНовойОбласти = НомерНижнЯчейкиОбласти + СдвигСтрок;
	
	НазначитьИмяОбластиМЧ = Ложь;
	ВставляемаяОбласть = ТекТабличноеПоле.Область(НомерВерхЯчейкиОбласти, , НомерНижнЯчейкиОбласти, );
	Если Найти(ВставляемаяОбласть.Имя, "МногострочнаяЧасть") > 0 Тогда
		НазначитьИмяОбластиМЧ = Истина;
		ИмяМногострочнойЧасти = ВставляемаяОбласть.Имя;
	КонецЕсли;

	Если СпециальноеДобавление Тогда
		
	Иначе
				
		// добавляем в таблицу новую строку
		РегламентированнаяОтчетностьВызовСервера.ВставитьОбластьВТабличныйДокумент(ТекТабличноеПоле, НомерВерхЯчейкиОбласти, НомерНижнЯчейкиОбласти);
		
		Форма[ТекТабличноеПолеИмя] = ТекТабличноеПоле;
		
	КонецЕсли;
	
	Если НазначитьИмяОбластиМЧ Тогда
		ТекТабличноеПоле.Область(НомерНижнЯчейкиОбласти + 1, , НомерНижнЯчейкиОбласти + (НомерНижнЯчейкиОбласти - НомерВерхЯчейкиОбласти) + 1, ).Имя = "";
		ТекТабличноеПоле.Область(НомерВерхЯчейкиОбласти, , НомерНижнЯчейкиОбласти, ).Имя = ИмяМногострочнойЧасти;
	КонецЕсли;

	КолСтрокСтр1 = Формат(КолСтрок + 1, "ЧГ=0");
	
	Для Каждого ИмяКолонки ИЗ КолонкиГруппы Цикл
		
		// переопределяем имена вставленной области
		Если СтруктураГруппы[0].Свойство(ИмяКолонки) Тогда
			
			ИмяОбластиЯчейки    = ИмяКолонки + "_" + КолСтрокСтр;
			ИмяНовОбластиЯчейки = ИмяКолонки + "_" + КолСтрокСтр1;
			
			ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяОбластиЯчейки];
			ОбластьЯчейки.Имя = ИмяНовОбластиЯчейки;
			
			// определяем границы ячейки исходной области
			НомерВерхСтрокиЯчейки  = ОбластьЯчейки.Верх - СдвигСтрок;
			НомерНижнСтрокиЯчейки  = ОбластьЯчейки.Низ  - СдвигСтрок;
			НомерЛевоКолонкиЯчейки = ОбластьЯчейки.Лево;
			НомерПравКолонкиЯчейки = ОбластьЯчейки.Право;
			
			// Назначаем имя ячейки исходной области,
			// (т.к. в результате вставки новой области оно было очищено)
			ОбластьЯчейкиИсходнойОбласти = ТекТабличноеПоле.Область(НомерВерхСтрокиЯчейки, НомерЛевоКолонкиЯчейки, НомерНижнСтрокиЯчейки, НомерПравКолонкиЯчейки);
			ОбластьЯчейкиИсходнойОбласти.Имя = ИмяОбластиЯчейки;
			
			// очищаем значения ячеек вставленной области
			Если ОбластьЯчейки.СодержитЗначение = Истина Тогда
				ОбластьЯчейки.Очистить();
			КонецЕсли;
			
			Если ИмяКолонкиНомера <> Неопределено Тогда
				Если ИмяКолонкиНомера = ИмяКолонки Тогда
					Если ОбластьЯчейки.СодержитЗначение = Истина Тогда
						ОбластьЯчейки.Значение = КолСтрок + НомерПервойСтроки;
					Иначе
						ОбластьЯчейки.Текст = КолСтрок + НомерПервойСтроки;
					КонецЕсли;
				КонецЕсли;
			КонецЕсли;
			
		КонецЕсли;
		
	КонецЦикла;

	Если ИмяГруппыБлока = Неопределено Тогда

		// Назначим текущей областью таблицы первую редактируемую ячейку добавленной строки.
		// Определяем текущую область таблицы
		
		//ИмяТекущейОбласти = ИмяГруппы + "01_" + КолСтрокСтр1;
		ИмяТекущейОбласти = ИмяПервойКолонки + "_" + КолСтрокСтр1;

		Форма.Элементы[ТекТабличноеПолеИмя].ТекущаяОбласть = ТекТабличноеПоле.Области[ИмяТекущейОбласти];
				
		// установим фокус на поле табличн. документа
		ТекущийЭлемент = Форма.Элементы[ТекТабличноеПолеИмя];
		
	КонецЕсли;

	// добавляем в структуру многострочной группы новую строку
	СтруктураГруппы.Добавить();
	
	Форма.Модифицированность = Истина;
	
КонецПроцедуры // ВставитьДополнительнуюСтроку()

&НаСервере
Процедура УдалитьДополнительнуюСтрокуНаСервере()
	
	УдалитьДополнительнуюСтроку(ЭтаФорма);
	
КонецПроцедуры // УдалитьДополнительнуюСтрокуНаСервере()

&НаКлиенте
Процедура УдалитьДополнительнуюСтрокуНаКлиенте()
	
	УдалитьДополнительнуюСтроку(ЭтаФорма);
	
КонецПроцедуры // УдалитьДополнительнуюСтрокуНаКлиенте()

// Удаляет строку многострочного раздела формы.
&НаКлиентеНаСервереБезКонтекста
Процедура УдалитьДополнительнуюСтроку(Форма, СпециальноеДобавление = Ложь, ИмяКолонкиНомера = Неопределено, НомерПервойСтроки = 1) Экспорт
	Перем ИсходноеКоличествоСтрокГруппы;
	Перем СтруктураГруппы;
    	
	ТекущаяСтраница = Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела;
	ТекТабличноеПоле = Форма.ТабличныйДокумент;

	ТекущаяОбласть = Форма.Элементы["ТабличныйДокумент"].ТекущаяОбласть;
	ИмяЯчейки	   = ТекущаяОбласть.Имя;
	
	#Если НаКлиенте Тогда
		ИмяГруппы = РегламентированнаяОтчетностьКлиент.РазделТекущейОбласти(Форма, ТекущаяОбласть);
	#Иначе
		ИмяГруппы = РегламентированнаяОтчетностьВызовСервера.РазделТекущейОбластиНаСервере(Форма, ТекущаяОбласть);
	#КонецЕсли
	
	ПроизводитьРасчет = Истина;
	Если СпециальноеДобавление = Истина Тогда
		
		ПроизводитьРасчет     = Ложь;
		СпециальноеДобавление = Ложь;
		
		ИмяЯчейки = ИмяКолонкиНомера;  ИмяКолонкиНомера = Неопределено;
		ИмяГруппы = НомерПервойСтроки; НомерПервойСтроки = 1;
		
	ИначеЕсли ИмяГруппы = "D6" Тогда
		
		УдалитьДополнительнуюСтроку(Форма, Истина, "" + ИмяЯчейки, "DT1R");
		
	ИначеЕсли ИмяГруппы = "DT1R" Тогда	
		  
		  УдалитьДополнительнуюСтроку(Форма, Истина, "" + ИмяЯчейки, "D6");
		
	КонецЕсли;

	// исходное количество строк группы
	Форма.мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);

	ТекТабличноеПолеИмя = "ТабличныйДокумент";
	
	ТекТабличноеПоле = Форма[ТекТабличноеПолеИмя];
	
	Форма.мСтруктураМногострочныхРазделов.Свойство(ИмяГруппы, СтруктураГруппы);
	
	СтруктураГруппы  = Форма[СтруктураГруппы];
   	КолонкиГруппы    = Форма.СтруктураРеквизитовФормы.КолонкиМногострочныхРазделов[ИмяГруппы];
	ИмяПервойКолонки = КолонкиГруппы[0];
	
	Если ИмяКолонкиНомера = Неопределено Тогда
		
		Для каждого Колонка Из КолонкиГруппы Цикл
			
			Если Найти(ВРЕГ(Колонка), "НОМЕРСТРОКИ") > 0 Тогда
				ИмяКолонкиНомера = Колонка;	
				Прервать;
			КонецЕсли;
		
		КонецЦикла;
		
	КонецЕсли;
	Если НомерПервойСтроки = Неопределено Тогда
		НомерПервойСтроки = 1;
	КонецЕсли;
	
	// номер строки многострочного раздела определим
	// по имени выделенной ячейки
	НомУдаляемойСтроки = Число(Сред(ИмяЯчейки, Найти(ИмяЯчейки, "_") + 1));
	НомерСтрокиТаблицы = НомУдаляемойСтроки - 1; // нумерация строк в таблице значений начинается с нуля

	Если СтруктураГруппы.Количество() > ИсходноеКоличествоСтрокГруппы Тогда
		// удаляется добавленная строка
		
		//ИмяПервойЯчейкиУдаляемойСтроки = ИмяГруппы + "01_" + Формат(НомУдаляемойСтроки, "ЧГ=0");
		ИмяПервойЯчейкиУдаляемойСтроки = ИмяПервойКолонки + "_" + Формат(НомУдаляемойСтроки, "ЧГ=0");

		// область первой ячейки удаляемой строки многострочного раздела
		ОбластьЯчейки = ТекТабличноеПоле.Области[ИмяПервойЯчейкиУдаляемойСтроки];

		НастройкиМнгЧ = РегламентированнаяОтчетностьКлиентСервер.ПолучитьСвойствоРаздела(Форма, ТекущаяСтраница, "МногострочностьВРазделе").НайтиСтроки(Новый Структура("ИдГруппы", ИмяГруппы))[0];
		ВысотаСтроки = НастройкиМнгЧ.ВысотаСтроки;
		
		НомерВерхЯчейкиОбласти = ОбластьЯчейки.Верх;
		НомерНижнЯчейкиОбласти = ОбластьЯчейки.Верх + ВысотаСтроки - 1;
		
		МногострочностьВРазделе = РегламентированнаяОтчетностьКлиентСервер.ПолучитьСвойствоРаздела(Форма, ТекущаяСтраница, "МногострочностьВРазделе");
		МногострочностьВРазделеТип = ТипЗнч(МногострочностьВРазделе);
		Если МногострочностьВРазделеТип = Тип("Число") Тогда
			ИмяОбластиМнгЧ = "МногострочнаяЧасть";
		ИначеЕсли МногострочностьВРазделеТип = Тип("ДанныеФормыКоллекция") Тогда
			ИмяОбластиМнгЧ = МногострочностьВРазделе.НайтиСтроки(Новый Структура("ИдГруппы", ИмяГруппы))[0].Область;
		КонецЕсли;
		// Найдем координаты области, для последующего восстановления.

		Если ТекТабличноеПоле.Области.Найти(ИмяОбластиМнгЧ) <> Неопределено Тогда
			ОбластьВерх = ТекТабличноеПоле.Области[ИмяОбластиМнгЧ].Верх;
			ОбластьНиз = ТекТабличноеПоле.Области[ИмяОбластиМнгЧ].Низ;
		КонецЕсли;

		Если СпециальноеДобавление Тогда
			
		Иначе
					
			РегламентированнаяОтчетностьВызовСервера.УдалитьОбластьИзТабличногоДокумента(ТекТабличноеПоле, НомерВерхЯчейкиОбласти, НомерНижнЯчейкиОбласти);
		
			Форма[ТекТабличноеПолеИмя] = ТекТабличноеПоле;
			
		КонецЕсли;
		// Восстановим область.
		ТекТабличноеПоле.Область(ОбластьВерх, 0, ОбластьНиз, 0).Имя = ИмяОбластиМнгЧ;

		КолвоСдвигаемыхСтрок = СтруктураГруппы.Количество() - НомУдаляемойСтроки;

		// обновим имена ячеек сдвинутых строк
		Если КолвоСдвигаемыхСтрок > 0 Тогда

			Для НСтр = НомУдаляемойСтроки + 1 По СтруктураГруппы.Количество() Цикл

				ТекСтрока = СтруктураГруппы[НСтр - 1];

				НСтрСтр = Формат(НСтр, "ЧГ=0");
				НСтрСтр1 = Формат(НСтр - 1, "ЧГ=0");
				
				Для Каждого КолонкаИмя ИЗ КолонкиГруппы Цикл
					
					Если СтруктураГруппы[0].Свойство(КолонкаИмя) Тогда
						
						ИмяСдвинутойЯчейки = КолонкаИмя + "_" + НСтрСтр;
						НовоеИмяСдвинутойЯчейки = КолонкаИмя + "_" + НСтрСтр1;
						
						ОбластьСдвинутойЯчейки = ТекТабличноеПоле.Области[ИмяСдвинутойЯчейки];
						ОбластьСдвинутойЯчейки.Имя = НовоеИмяСдвинутойЯчейки;
						
						Если ИмяКолонкиНомера <> Неопределено Тогда
							Если ИмяКолонкиНомера = КолонкаИмя Тогда
								// обновляем порядковый номер строки
								
								НовыйПорядковыйНомер = НСтр - 1 + НомерПервойСтроки - 1;
								
								Если ОбластьСдвинутойЯчейки.СодержитЗначение = Истина Тогда
									ОбластьСдвинутойЯчейки.Значение = НовыйПорядковыйНомер;
								Иначе
									ОбластьСдвинутойЯчейки.Текст = НовыйПорядковыйНомер;
								КонецЕсли;
							КонецЕсли;
						КонецЕсли;
						
					КонецЕсли;
					
				КонецЦикла;

			КонецЦикла;
		КонецЕсли;

		// обновляем структуру многострочного раздела
		СтруктураГруппы.Удалить(НомерСтрокиТаблицы);

	Иначе
		// строка не удаляется в форме табличного документа,
		// а должна осуществляться сдвиг строк

		// обновляем структуру многострочного раздела
		// методом удаления выбранной строки и добавления пустой строки
		СтруктураГруппы.Удалить(НомерСтрокиТаблицы);

		ДобавляемаяСтрока = СтруктураГруппы.Добавить();

		// обновляем порядковые номера строк, выводимых в табличный документ
		Для Каждого СтрокаТаблицы Из СтруктураГруппы Цикл
			НомерСтрокиВТаблице = СтруктураГруппы.Индекс(СтрокаТаблицы);
			НомерСтрокиВФормеТаблицы = НомерСтрокиВТаблице + 1 + НомерПервойСтроки - 1;
			
			Для Каждого КолонкаТаблицыИмя ИЗ КолонкиГруппы Цикл
				
				Если СтруктураГруппы[0].Свойство(КолонкаТаблицыИмя) Тогда
					
					Если ИмяКолонкиНомера <> Неопределено Тогда
						Если ИмяКолонкиНомера = КолонкаТаблицыИмя Тогда
							// обновляем порядковый номер строки
							СтрокаТаблицы[КолонкаТаблицыИмя] = НомерСтрокиВФормеТаблицы;
						КонецЕсли;
					КонецЕсли;
					
				КонецЕсли;	
				
			КонецЦикла;
		
		КонецЦикла;

		// Данные в многострочном блоке обновляются в декларациях!
		// Форма.ОбновитьСтруктуруМногострочногоРаздела(ИмяГруппы);
		// Обновляем экранную форму табличного документа
		#Если НаКлиенте Тогда
			Форма.ВывестиРазделВТабличныйДокументНаКлиенте(ИмяГруппы, СтруктураГруппы);
		#Иначе
			Форма.ВывестиРазделВТабличныйДокументНаСервере(ИмяГруппы, СтруктураГруппы);
		#КонецЕсли
		
	КонецЕсли;

	// назначим текущей областью таблицы первую редактируемую ячейку
	// удаленной строки, если ее порядковый номер меньше кол-ва строк
	// многострочного раздела, или последней строки раздела в противном случае

	// определяем текущую область таблицы
	НомТекущейСтроки = Мин(НомУдаляемойСтроки, СтруктураГруппы.Количество());
	//ИмяТекущейОбласти = ИмяГруппы + "01_" + Формат(НомТекущейСтроки, "ЧГ=0");
	ИмяТекущейОбласти = ИмяПервойКолонки + "_" + Формат(НомТекущейСтроки, "ЧГ=0");
	
	Форма.Элементы[ТекТабличноеПолеИмя].ТекущаяОбласть = ТекТабличноеПоле.Области[ИмяТекущейОбласти];

	// установим фокус на поле табличн. документа
	ТекущийЭлемент = Форма.Элементы[ТекТабличноеПолеИмя];

	Форма.Модифицированность = Истина;
	
	Если ПроизводитьРасчет Тогда
		#Если НаКлиенте Тогда
			Форма.РасчетНаКлиенте(Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела);
		#Иначе
			Форма.РасчетНаСервере(Форма.СтруктураРеквизитовФормы.НаимТекущегоРаздела);
		#КонецЕсли
	КонецЕсли;

КонецПроцедуры // УдалитьДополнительнуюСтроку()
		
&НаКлиенте
Процедура ОбработкаВыбораВПолеТабличногоДокумента(Элемент, Область, СтандартнаяОбработка)
	
	Если РегламентированнаяОтчетностьКлиент.ВыбраннаяОбластьРегламентированногоОтчетаНеВерна(ЭтаФорма, Область, СтандартнаяОбработка) Тогда
		Возврат;
	КонецЕсли;
	
	ИмяЯчейки 			 = Область.Имя;
	НаименованиеТекЛиста = Элементы.РазделыОтчета.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим;
	
	 Если Врег(ЛЕВ(ИмяЯчейки, 5)) = "МЕСОШ" Тогда
		
		Значение = ТабличныйДокумент.Области.HZMP.Значение;
		ОписаниеОповещения = Новый ОписаниеОповещения("ВводПоказателяВПолеТабличногоДокументЗавершение",
													   ЭтаФорма, Новый Структура("ИмяЯчейки, ИмяСтраницы,
																				 |ИмяЯчейкиКвадратов, ИмяСтраницыКвадратов, 
																				 |Размерность, ДополнитьЗначение, НольКакНоль", 
																				 "HZMP",  НаименованиеТекЛиста,
																				 "МЕСОШ_", НаименованиеТекЛиста,
																				 2, Истина, Неопределено));
		
		ПоказатьВводЧисла(ОписаниеОповещения,Значение, НСтр("ru='Введите значение';uk='Введіть значення'"), 2,0);
		
	 ИначеЕсли Врег(ЛЕВ(ИмяЯчейки, 4)) = "КВОШ" Тогда
		
		Значение = ТабличныйДокумент.Области.HZKVP.Значение;
		ОписаниеОповещения = Новый ОписаниеОповещения("ВводПоказателяВПолеТабличногоДокументЗавершение",
													   ЭтаФорма, Новый Структура("ИмяЯчейки, ИмяСтраницы,
																				 |ИмяЯчейкиКвадратов, ИмяСтраницыКвадратов, 
																				 |Размерность, ДополнитьЗначение, НольКакНоль", 
																				 "HZKVP",  НаименованиеТекЛиста,
																				 , ,
																				 1, Ложь, Неопределено));
		
		ПоказатьВводЧисла(ОписаниеОповещения,Значение, НСтр("ru='Введите значение';uk='Введіть значення'"), 1,0);
		
		
	 ИначеЕсли Врег(ЛЕВ(ИмяЯчейки, 5)) = "ГОДОШ" Тогда
		
		Значение = ТабличныйДокумент.Области.HZYP.Значение;
		ОписаниеОповещения = Новый ОписаниеОповещения("ВводПоказателяВПолеТабличногоДокументЗавершение",
													   ЭтаФорма, Новый Структура("ИмяЯчейки, ИмяСтраницы,
																				 |ИмяЯчейкиКвадратов, ИмяСтраницыКвадратов, 
																				 |Размерность, ДополнитьЗначение, НольКакНоль", 
																				 "HZYP",  НаименованиеТекЛиста,
																				 "ГодОш_", НаименованиеТекЛиста,
																				 4, Ложь, Неопределено));
		
		ПоказатьВводЧисла(ОписаниеОповещения,Значение, НСтр("ru='Введите значение';uk='Введіть значення'"), 4,0);
		
		
	ИначеЕсли Врег(ЛЕВ(ИмяЯчейки, 3)) = "ИНД" Тогда
		
		Если НЕ НаименованиеТекЛиста = "Декларация" Тогда
			Возврат;
		КонецЕсли;
		
		Значение = СтруктураДанныхСлужебныеДанные.HZIP;
		ОписаниеОповещения = Новый ОписаниеОповещения("ВводПоказателяВПолеТабличногоДокументЗавершение",
													   ЭтаФорма, Новый Структура("ИмяЯчейки, ИмяСтраницы,
																				 |ИмяЯчейкиКвадратов, ИмяСтраницыКвадратов, 
																				 |Размерность, ДополнитьЗначение, НольКакНоль", 
																				 "HZIP",  "СлужебныеДанные",
																				 "Инд_", НаименованиеТекЛиста,
																				 5, Ложь, Неопределено));
		
		ПоказатьВводСтроки(ОписаниеОповещения,Значение, НСтр("ru='Введите значение';uk='Введіть значення'"), 5);
		
	ИначеЕсли Врег(ЛЕВ(ИмяЯчейки, 6)) = "ИННРУК" Тогда
		
		Если НЕ НаименованиеТекЛиста = "Декларация" Тогда
			Возврат;
		КонецЕсли;
		
		Значение = СтруктураДанныхСлужебныеДанные.HKBOS;
		ОписаниеОповещения = Новый ОписаниеОповещения("ВводПоказателяВПолеТабличногоДокументЗавершение",
													   ЭтаФорма, Новый Структура("ИмяЯчейки, ИмяСтраницы,
																				 |ИмяЯчейкиКвадратов, ИмяСтраницыКвадратов, 
																				 |Размерность, ДополнитьЗначение, НольКакНоль", 
																				 "HKBOS",  "СлужебныеДанные",
																				 "ИННРук_", НаименованиеТекЛиста,
																				 10, Ложь, Неопределено));
		
		ПоказатьВводСтроки(ОписаниеОповещения,Значение, НСтр("ru='Введите значение';uk='Введіть значення'"), 10);
		
	ИначеЕсли Врег(ЛЕВ(ИмяЯчейки, 5)) = "ИННГБ" Тогда
		
		Если НЕ НаименованиеТекЛиста = "Декларация" Тогда
			Возврат;
		КонецЕсли;
		
		Значение = СтруктураДанныхСлужебныеДанные.HKBUH;
		ОписаниеОповещения = Новый ОписаниеОповещения("ВводПоказателяВПолеТабличногоДокументЗавершение",
													   ЭтаФорма, Новый Структура("ИмяЯчейки, ИмяСтраницы,
																				 |ИмяЯчейкиКвадратов, ИмяСтраницыКвадратов, 
																				 |Размерность, ДополнитьЗначение, НольКакНоль", 
																				 "HKBUH",  "СлужебныеДанные",
																				 "ИННГБ_", НаименованиеТекЛиста,
																				 10, Ложь, Неопределено));
		
		ПоказатьВводСтроки(ОписаниеОповещения,Значение, НСтр("ru='Введите значение';uk='Введіть значення'"), 10);
		
	ИначеЕсли  ИмяЯчейки = "HZ" Тогда
		
		ТабличныйДокумент.Области["HZ"].Значение = "X";
		ТабличныйДокумент.Области["HZN"].Значение = "";
		Если (НЕ НаименованиеТекЛиста = "Декларация")
			И(НЕ НаименованиеТекЛиста = "Приложение8") Тогда
			ТабличныйДокумент.Области["HZU"].Значение = "";
		КонецЕсли;
		
		ТабличныйДокумент.Области["C_DOC_STAN"].Значение = 1;
		
	ИначеЕсли ИмяЯчейки = "HZN" Тогда
		
		ТабличныйДокумент.Области["HZ"].Значение = "";
		ТабличныйДокумент.Области["HZN"].Значение = "X";
		Если (НЕ НаименованиеТекЛиста = "Декларация")
			И(НЕ НаименованиеТекЛиста = "Приложение8") Тогда
			ТабличныйДокумент.Области["HZU"].Значение = "";
		КонецЕсли;
		
		ТабличныйДокумент.Области["C_DOC_STAN"].Значение = 2;
		
	ИначеЕсли ИмяЯчейки = "HZU" Тогда
		
		ТабличныйДокумент.Области["HZ"].Значение = "";
		ТабличныйДокумент.Области["HZN"].Значение = "";
		ТабличныйДокумент.Области["HZU"].Значение = "X";
		
		ТабличныйДокумент.Области["C_DOC_STAN"].Значение = 3;
		
	ИначеЕсли ИмяЯчейки = "HZG" Тогда
		
		Если НЕ НаименованиеТекЛиста = "Декларация" Тогда
			Возврат;
		КонецЕсли;
		
		СписокУстанавливаемыхЗначений = Новый СписокЗначений;
		СписокУстанавливаемыхЗначений.Добавить("X", "HZG");
		СписокУстанавливаемыхЗначений.Добавить("", "HSG");
		СписокУстанавливаемыхЗначений.Добавить("", "HLG");
		СписокУстанавливаемыхЗначений.Добавить("", "HRB");
		СписокУстанавливаемыхЗначений.Добавить("", "HNS");
		
		ЗаполнитьПоказательНаВсехЗакладкахНаСервере(СписокУстанавливаемыхЗначений, "|Приложение2|Приложение3|Приложение4|Заявление|Филиалы|");
		
		СтруктураРеквизитовФормы.СпецРежим = 0;
		Расчет(ЭтаФорма);

	ИначеЕсли ИмяЯчейки = "HSG"
		  ИЛИ ИмяЯчейки = "HLG" 
		  ИЛИ ИмяЯчейки = "HRB" Тогда		
		  
		Если НЕ НаименованиеТекЛиста = "Декларация" Тогда
			Возврат;
		КонецЕсли;
		
		СписокУстанавливаемыхЗначений = Новый СписокЗначений;
		СписокУстанавливаемыхЗначений.Добавить("", "HZG");
		СписокУстанавливаемыхЗначений.Добавить("", "HSG");
		СписокУстанавливаемыхЗначений.Добавить("", "HLG");
		СписокУстанавливаемыхЗначений.Добавить("", "HRB");
		СписокУстанавливаемыхЗначений.Добавить("", "HNS");
		СписокУстанавливаемыхЗначений.Добавить("X", ИмяЯчейки);
		
		ЗаполнитьПоказательНаВсехЗакладкахНаСервере(СписокУстанавливаемыхЗначений, "|Приложение2|Приложение3|Приложение4|Заявление|Филиалы|");
		
		СтруктураРеквизитовФормы.СпецРежим = 2;
		Расчет(ЭтаФорма);
		
	ИначеЕсли ИмяЯчейки = "HNS" Тогда
		
		Если НЕ НаименованиеТекЛиста = "Декларация" Тогда
			Возврат;
		КонецЕсли;
		
		СписокУстанавливаемыхЗначений = Новый СписокЗначений;
		СписокУстанавливаемыхЗначений.Добавить("", "HZG");
		СписокУстанавливаемыхЗначений.Добавить("", "HSG");
		СписокУстанавливаемыхЗначений.Добавить("", "HLG");
		СписокУстанавливаемыхЗначений.Добавить("", "HRB");
		СписокУстанавливаемыхЗначений.Добавить("X", "HNS");
		
		ЗаполнитьПоказательНаВсехЗакладкахНаСервере(СписокУстанавливаемыхЗначений, "|Приложение2|Приложение3|Приложение4|Заявление|Филиалы|");
		
		СтруктураРеквизитовФормы.СпецРежим = 3;
		Расчет(ЭтаФорма);
		
	ИначеЕсли ИмяЯчейки = "HVM"
		  ИЛИ ИмяЯчейки = "HSK" 
		  ИЛИ ИмяЯчейки = "HSP"
		  ИЛИ ИмяЯчейки = "HUR"
		  ИЛИ ИмяЯчейки = "HD1P"
		  ИЛИ ИмяЯчейки = "HD8"
		  ИЛИ ИмяЯчейки = "HJAR"
		  ИЛИ ИмяЯчейки = "HA"
		  ИЛИ ИмяЯчейки = "HM"
		  ИЛИ ИмяЯчейки = "HK" Тогда

		Область.Значение  = ?(ЗначениеЗаполнено(Область.Значение), "", "X");
		
	// приложение 4
	ИначеЕсли НаименованиеТекЛиста = "Приложение4"
		   И (ИмяЯчейки = "R0103G3" ИЛИ ИмяЯчейки = "R0104G3") Тогда 
		
		Область.Значение  = ?(ЗначениеЗаполнено(Область.Значение), "", "+");
		
	ИначеЕсли НаименованиеТекЛиста = "Приложение4"
		   И (ИмяЯчейки = "R0301G3") Тогда 
		
		ТабличныйДокумент.Области.R0301G3.Значение  = "+";
		ТабличныйДокумент.Области.R0302G3.Значение  = "";
		
	ИначеЕсли НаименованиеТекЛиста = "Приложение4"
		   И (ИмяЯчейки = "R0302G3") Тогда 
		
		ТабличныйДокумент.Области.R0301G3.Значение  = "";
		ТабличныйДокумент.Области.R0302G3.Значение  = "+";
		
	// приложение 5
	ИначеЕсли НаименованиеТекЛиста = "Приложение5"
		   И (ЛЕВ(ИмяЯчейки, 5) = "П5T2R")
		   И (Найти(ИмяЯчейки, "G41") > 0) Тогда 	
		
		Область.Значение  = ?(ЗначениеЗаполнено(Область.Значение), "", "+");
		
		Расчет(ЭтаФорма, "Приложение5");

	КонецЕсли;
	
КонецПроцедуры // ОбработкаВыбораВПолеТабличногоДокумента()

&НаКлиенте		
Процедура ВводПоказателяВПолеТабличногоДокументЗавершение(Значение, ДополнительныеПараметры) Экспорт
			
	Если Значение = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ИмяЯчейки = ДополнительныеПараметры.ИмяЯчейки;
	
	Если ИмяЯчейки = "HZMP" Тогда
	    Значение = Формат(Значение, "ЧЦ=2; ЧВН=; ЧГ=0");
	ИначеЕсли ТипЗнч(Значение) = Тип("Число") Тогда
		Значение = Формат(Значение, "ЧГ=0");
	КонецЕсли;
	
	ЗаполнитьПоказательНаСервере(ИмяЯчейки, Значение, ЭтаФорма, ДополнительныеПараметры.ИмяСтраницы);

	// заполнение кодов руководителей по всем приложениям
	Если    Найти(ДополнительныеПараметры.ИмяЯчейкиКвадратов, "ИННРук") > 0 
		ИЛИ Найти(ДополнительныеПараметры.ИмяЯчейкиКвадратов, "ИННГБ") > 0 Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Декларация",  ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение1", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение2", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение3", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение4", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение5", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Справка", 	  ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение7", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение8", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение9", ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Приложение10",ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Заявление",   ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, "Филиалы",     ДополнительныеПараметры.ИмяЯчейкиКвадратов, 10, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
		
	ИначеЕсли ИмяЯчейки = "HZKVP" Тогда
		ЗаполнитьПоказательНаСервере("КВОШ", Значение, ЭтаФорма, ДополнительныеПараметры.ИмяСтраницы);	
	КонецЕсли;
	
	Если ЗначениеЗаполнено(ДополнительныеПараметры.ИмяСтраницыКвадратов) Тогда
		РегламентированнаяОтчетностьКлиентСервер.ПроставитьВКвадратыЗначения(ЭтаФорма, ДополнительныеПараметры.ИмяСтраницыКвадратов, ДополнительныеПараметры.ИмяЯчейкиКвадратов, ДополнительныеПараметры.Размерность, Значение, ДополнительныеПараметры.ДополнитьЗначение, ДополнительныеПараметры.НольКакНоль);
	КонецЕсли;
	                         
	СтандартнаяОбработка = Ложь;
	Модифицированность = Истина;

КонецПроцедуры

&НаКлиенте
Процедура ТабличныйДокументВыбор(Элемент, Область, СтандартнаяОбработка)
	
	ОбработкаВыбораВПолеТабличногоДокумента(Элемент, Область, СтандартнаяОбработка);
	
КонецПроцедуры

&НаКлиенте
Процедура ОбработкаИзмененияСодержимогоВПолеТабличногоДокумента(Элемент, Область)
	
	Модифицированность = Истина;
		
	ПараметрВводаПоля = СвойстваПоказателей.НайтиСтроки(Новый Структура("Показатель", Область.Имя));
	ИмяОбласти = Область.Имя;
	ИмяРаздела = Элементы.РазделыОтчета.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим;
	
	РасчетНаКлиенте(СтруктураРеквизитовФормы.НаимТекущегоРаздела);
	
	Если ИмяРаздела = "Декларация" Тогда
		Если    ИмяОбласти = "HNAME"
			ИЛИ ИмяОбласти = "HDDGVIN" 
			ИЛИ ИмяОбласти = "HNDGVIN" 
			ИЛИ ИмяОбласти = "HTIN" 
			ИЛИ ИмяОбласти = "HNPDV" 
			ИЛИ ИмяОбласти = "HBUH" 
			ИЛИ ИмяОбласти = "HBOS" 
			Тогда
			СтруктураДанныхПриложение1[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			СтруктураДанныхПриложение2[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			СтруктураДанныхПриложение3[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			СтруктураДанныхПриложение4[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			СтруктураДанныхПриложение5[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			СтруктураДанныхСправка[ИмяОбласти]     = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			СтруктураДанныхПриложение7[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			СтруктураДанныхПриложение8[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			Если НЕ ИмяОбласти = "HDDGVIN" 
			   И НЕ ИмяОбласти = "HNDGVIN" Тогда
			
				СтруктураДанныхПриложение9[ИмяОбласти] = ТабличныйДокумент.Области[ИмяОбласти].Значение;
				СтруктураДанныхПриложение10[ИмяОбласти]= ТабличныйДокумент.Области[ИмяОбласти].Значение;
				СтруктураДанныхЗаявление[ИмяОбласти]   = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			
			КонецЕсли;
			СтруктураДанныхФилиалы[ИмяОбласти]     = ТабличныйДокумент.Области[ИмяОбласти].Значение;
			
			Если ИмяОбласти = "HTIN" Тогда
				СтруктураДанныхСлужебныеДанные["TIN"] = ТабличныйДокумент.Области[ИмяОбласти].Значение;	
			КонецЕсли;
			
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры // ОбработкаИзмененияСодержимогоВПолеТабличногоДокумента()

&НаКлиенте
Процедура ДатаПодписиПриИзменении(Элемент)
	
	ЗаполнитьДатуПодписиНаСервере();
	
	Модифицированность = Истина;
		
КонецПроцедуры // ДатаПодписиПриИзменении()

&НаСервере
Процедура ПослеСменыЕдИзмеренияИТочности()

	ЗаполнитьПустыеСтруктурыДанных();
	
	ПроверитьТочность();
	
	УстановитьФорматВыводаВПоляхВводаНаСервере(СтруктураРеквизитовФормы.НаимТекущегоРаздела);
	
	РасчетНаСервере();
	
	Модифицированность = Истина;
		
КонецПроцедуры // ПослеСменыЕдИзмеренияИТочности()

// Процедура контролирует корректность установленной точности указания
// суммовых (денежных) показателей при выборе единицы измерения.
//
&НаСервере
Процедура ПроверитьТочность()
	
	Если СтруктураРеквизитовФормы.ЕдиницаИзмерения = ПорядкиОкругленияОтчетности.ПеречислениеПорядкиОкругленияОтчетностиОкр1 Тогда

		Если СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения > 2 Тогда
									
			Сообщение = Новый СообщениеПользователю;

			Сообщение.Текст = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='%1: при выводе сумм в гривнах точность не может превышать 2 знака';uk='%1: при виведенні сум у гривнях точність не може перевищувати 2 знака'"), ЭтаФорма.Заголовок);

			Сообщение.Сообщить();
			
			СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения = 2;
			
		КонецЕсли;

	ИначеЕсли СтруктураРеквизитовФормы.ЕдиницаИзмерения = ПорядкиОкругленияОтчетности.ПеречислениеПорядкиОкругленияОтчетностиОкр1000 Тогда

		Если СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения > 3 Тогда
			
			Сообщение = Новый СообщениеПользователю;

			Сообщение.Текст = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='%1: при выводе сумм в тысячах гривен точность не может превышать 3 знака';uk='%1: при виведенні сум в тисячах гривень точність не може перевищувати 3 знака'"), ЭтаФорма.Заголовок);

			Сообщение.Сообщить();
			
			СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения = 3;
			
		КонецЕсли;

	ИначеЕсли СтруктураРеквизитовФормы.ЕдиницаИзмерения = ПорядкиОкругленияОтчетности.ПеречислениеПорядкиОкругленияОтчетностиОкр1000000 Тогда

		Если СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения > 6 Тогда
						
			Сообщение = Новый СообщениеПользователю;

			Сообщение.Текст = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='%1: при выводе сумм в миллионах гривен точность не может превышать 6 знаков';uk='%1: при виведенні сум у мільйонах гривень точність не може перевищувати 6 знаків'"), ЭтаФорма.Заголовок);

			Сообщение.Сообщить();
			
			СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения = 6;
			
		КонецЕсли;

	КонецЕсли;

КонецПроцедуры // ПроверитьТочность()

&НаКлиенте
Процедура Обновить(Команда)
	
	ЗаполнитьСведенияОбОрганизацииНаСервере();
		
КонецПроцедуры // Обновить()

&НаКлиенте
Процедура ОткрытьФормуНастроек(Команда)
	
	ОткрытьФормуВыбораСтраниц("ВыбратьДляНастройки");
	    
КонецПроцедуры // ОткрытьФормуНастроек()

// Открывает форму документа ФормаНастройкиОтчета с целью выбора 
// выводимых на печать листов отчета.
//
// Параметры:
//   ВариантВыбора - строка, назначение выбора страниц.
//
&НаКлиенте
Процедура ОткрытьФормуВыбораСтраниц(ВариантВыбора)
    Перем ТекущийРазделОтчетаСокрНаим;
	Перем НомерСтраницыРазделаОтчета;
	
	// Запоминаем текущий раздел, установленный в дереве разделов отчета.
	Если НЕ Элементы.РазделыОтчета.ТекущиеДанные = Неопределено Тогда
		ТекущийРазделОтчетаСокрНаим = Элементы.РазделыОтчета.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим;
		НомерСтраницыРазделаОтчета  = Элементы.РазделыОтчета.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета;
	КонецЕсли;
	
	мПараметры = Новый Структура;
	мПараметры.Вставить("Автосохранение", Ложь);
	Если СтруктураРеквизитовФормы.ОтображатьКнопкуРасшифровать Тогда
		мПараметры.Вставить("СохранятьРасшифровкуАвтозаполнения", СтруктураРеквизитовФормы.мСохранятьРасшифровку);
	КонецЕсли;
	
	ПараметрыФормы = Новый Структура;
	ПараметрыФормы.Вставить("ФлажокОтклАвтоРасчет",		СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет);
	ПараметрыФормы.Вставить("ЕдиницаИзмерения", 		СтруктураРеквизитовФормы.ЕдиницаИзмерения);
	ПараметрыФормы.Вставить("ТочностьЕдиницыИзмерения", СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения);
	ПараметрыФормы.Вставить("мПараметры", мПараметры);
					
	ФормаНастройкиОтчета = РегламентированнаяОтчетностьКлиент.ПолучитьОбщуюФормуПоИмени("НастройкиОтчета", ПараметрыФормы, ЭтаФорма);
    
	мДеревоВыбранныхСтраниц.ПолучитьЭлементы().Очистить();
    
	КопироватьДанныеФормы(мДеревоСтраницОтчета, ФормаНастройкиОтчета.Дерево);
	
	ЗначениеАвторасчета = СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет;
	ЗначениеЕдИзм       = СтруктураРеквизитовФормы.ЕдиницаИзмерения;
	ЗначениеЗпт         = СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения;
	
	ДополнительныеПараметры = Новый Структура("ЗначениеАвторасчета, ЗначениеЕдИзм, ЗначениеЗпт, НомерСтраницыРазделаОтчета, ТекущийРазделОтчетаСокрНаим", ЗначениеАвторасчета, ЗначениеЕдИзм, ЗначениеЗпт, НомерСтраницыРазделаОтчета, ТекущийРазделОтчетаСокрНаим);
	ОписаниеОповещения = Новый ОписаниеОповещения("ОткрытьФормуВыбораСтраницЗавершение", ЭтотОбъект, ДополнительныеПараметры);
	ФормаНастройкиОтчета.ОписаниеОповещенияОЗакрытии = ОписаниеОповещения;
	ФормаНастройкиОтчета.РежимОткрытияОкна = РежимОткрытияОкнаФормы.БлокироватьОкноВладельца;
	ФормаНастройкиОтчета.Открыть();
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьФормуВыбораСтраницЗавершение(РезультатВыбора, ДополнительныеПараметры) Экспорт
	
	ЗначениеАвторасчета = ДополнительныеПараметры.ЗначениеАвторасчета;
	ЗначениеЕдИзм = ДополнительныеПараметры.ЗначениеЕдИзм;
	ЗначениеЗпт = ДополнительныеПараметры.ЗначениеЗпт;
	НомерСтраницыРазделаОтчета = ДополнительныеПараметры.НомерСтраницыРазделаОтчета;
	ТекущийРазделОтчетаСокрНаим = ДополнительныеПараметры.ТекущийРазделОтчетаСокрНаим;
	
	Если РезультатВыбора <> Неопределено Тогда
		КопироватьДанныеФормы(РезультатВыбора, мДеревоВыбранныхСтраниц);
		РегламентированнаяОтчетностьКлиентСервер.ПрорисоватьПодменюПечать(ЭтаФорма);
		Модифицированность = Истина;
					
		флЗначенияИдентичны = Истина;
		
		Для Индекс = 0 По мДеревоСтраницОтчета.ПолучитьЭлементы().Количество() - 1 Цикл
			
			Если НЕ мДеревоСтраницОтчета.ПолучитьЭлементы()[Индекс].ПоказатьСтраницу = РезультатВыбора.ПолучитьЭлементы()[Индекс].ПоказатьСтраницу Тогда
				флЗначенияИдентичны = Ложь;
				Прервать;
			КонецЕсли;
			
		КонецЦикла;
		
		Если ЗначениеАвторасчета <> СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет Тогда
			
			#Если ВебКлиент Тогда
				ИзменитьТаблицуВариантовЗаполненияНаСервере();
			#Иначе
				РегламентированнаяОтчетностьКлиентСервер.ИзменитьТаблицуВариантовЗаполнения(ЭтаФорма, НЕ СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет);
			#КонецЕсли	
			
			Расчет(ЭтаФорма);
			
		КонецЕсли;
		
		Если ЗначениеЕдИзм <> СтруктураРеквизитовФормы.ЕдиницаИзмерения
		 ИЛИ ЗначениеЗпт <> СтруктураРеквизитовФормы.ТочностьЕдиницыИзмерения Тогда
			ПослеСменыЕдИзмеренияИТочности();
		КонецЕсли;
		
		// Управляем видимостью страниц основной панели формы
	    РегламентированнаяОтчетностьКлиент.ПоказатьСтраницыОтчетаНаКлиенте(ЭтаФорма);
		
		Если НЕ флЗначенияИдентичны Тогда
			
			СформироватьДеревоРазделовОтчетаНаКлиенте();
			
			Если НЕ ТекущийРазделОтчетаСокрНаим = Неопределено Тогда
				
				// Пытаемся найти ранее запомненный раздел.
				НайденнаяСтрока = РегламентированнаяОтчетностьКлиентСервер.НайтиЭлементВДанныхФормыДерево(РазделыОтчета.ПолучитьЭлементы(), "КолонкаРазделыОтчетаСокрНаим", ТекущийРазделОтчетаСокрНаим);
				
				Если НЕ НайденнаяСтрока = Неопределено 
					И НЕ НомерСтраницыРазделаОтчета = Неопределено 
					И НайденнаяСтрока.ПолучитьЭлементы().Количество() > 0 Тогда
					
					НайденнаяСтрока = РегламентированнаяОтчетностьКлиентСервер.НайтиЭлементВДанныхФормыДерево(НайденнаяСтрока.ПолучитьЭлементы(), "КолонкаНомерСтраницыРазделаОтчета", НомерСтраницыРазделаОтчета);
					
				КонецЕсли;
				
				// В случае успешного поиска, устанавливаем курсор на найденный раздел.
				Если НЕ НайденнаяСтрока = Неопределено Тогда
					Элементы.РазделыОтчета.ТекущаяСтрока = НайденнаяСтрока.ПолучитьИдентификатор();
				КонецЕсли;
				
			КонецЕсли;
			
			// обнулим информацию о выделенных областях, так как набор страниц были изменен.
			СтруктураРеквизитовФормы.ТекущиеОбластиСтраниц = Неопределено;
			
		КонецЕсли;
		
	Иначе
		КопироватьДанныеФормы(мДеревоСтраницОтчета, мДеревоВыбранныхСтраниц);
	КонецЕсли;
	
КонецПроцедуры // ОткрытьФормуВыбораСтраниц()

&НаСервере
Процедура ИзменитьТаблицуВариантовЗаполненияНаСервере()
	
	РегламентированнаяОтчетностьКлиентСервер.ИзменитьТаблицуВариантовЗаполнения(ЭтаФорма, НЕ СтруктураРеквизитовФормы.ФлажокОтклАвтоРасчет);
	
	РегламентированнаяОтчетность.ПолучитьСведенияОПоказателяхОтчета(ЭтаФорма);
	
КонецПроцедуры // ИзменитьТаблицуВариантовЗаполненияНаСервере()

&НаКлиенте
Процедура ОчиститьОтчет(Команда)
		
	РегламентированнаяОтчетностьКлиент.МеханизмыОчисткиРегламентированныхОтчетов(ЭтаФорма, "ОчиститьВесьОтчет");
	
	СтруктураРеквизитовФормы.НомерТекущейСтраницы = Элементы.РазделыОтчета.ТекущиеДанные.КолонкаНомерСтраницыРазделаОтчета;
	
	
КонецПроцедуры

&НаКлиенте
Процедура Очистить(ВыполняемоеОповещение = Неопределено) Экспорт
	
	РегламентированнаяОтчетностьКлиент.Очистить(ЭтаФорма, ВыполняемоеОповещение);
	
КонецПроцедуры

&НаКлиенте
Процедура ОчиститьТекущуюСтраницу(Команда)

	РегламентированнаяОтчетностьКлиент.МеханизмыОчисткиРегламентированныхОтчетов(ЭтаФорма, "ОчиститьТекущийЭкземплярМногостраничногоРаздела" + Элементы.РазделыОтчета.ТекущиеДанные.КолонкаРазделыОтчетаСокрНаим);

КонецПроцедуры

&НаСервере
Процедура ОчиститьНаСервере() Экспорт
	
	HZG = ПолучитьПоказательНаСервере("HZG",ЭтаФорма,"Декларация");
	HSG = ПолучитьПоказательНаСервере("HSG",ЭтаФорма,"Декларация");
	HLG = ПолучитьПоказательНаСервере("HLG",ЭтаФорма,"Декларация");
	HRB = ПолучитьПоказательНаСервере("HRB",ЭтаФорма,"Декларация");
	HNS = ПолучитьПоказательНаСервере("HNS",ЭтаФорма,"Декларация");
	
	СтруктураДанныхДекларация.Очистить();
	СтруктураДанныхПриложение1.Очистить();
	СтруктураДанныхПриложение2.Очистить();
	СтруктураДанныхПриложение3.Очистить();
	СтруктураДанныхПриложение4.Очистить();
	СтруктураДанныхПриложение5.Очистить();
	СтруктураДанныхПриложение7.Очистить();
	СтруктураДанныхПриложение8.Очистить();
	СтруктураДанныхПриложение9.Очистить();
	СтруктураДанныхПриложение10.Очистить();
	СтруктураДанныхЗаявление.Очистить();
	СтруктураДанныхСправка.Очистить();
	СтруктураДанныхФилиалы.Очистить();
	СтруктураДанныхСлужебныеДанные.Очистить();
	
	//ТаблицаСтраницыРаздела1.Очистить();
	//ИнициализацияМногостраничныхРазделов();
	
	Для Каждого мнгРаздел Из мСтруктураМногострочныхРазделов Цикл
		ЭтаФорма[мнгРаздел.Ключ].Очистить();
	КонецЦикла;
	
	НачальныеОперацииСМногострочнымиБлоками();
	
	ЗаполнитьПустыеСтруктурыДанных();
	
	ОчиститьТабличноеПолеНаСервере(СтруктураРеквизитовФормы.НаимТекущегоРаздела);
	
	ВывестиМакетСтраницыВТабличныйДокументНаСервере(СтруктураРеквизитовФормы.НаимТекущегоРаздела, 1);
		
	СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Ложь;
	
	РегламентированнаяОтчетностьКлиентСервер.ОчиститьВариантыЗаполнения(ЭтаФорма);
	
	ЗаполнитьСведенияОбОрганизацииНаСервере();
	
	СписокУстанавливаемыхЗначений = Новый СписокЗначений;
	СписокУстанавливаемыхЗначений.Добавить(HZG, "HZG");
	СписокУстанавливаемыхЗначений.Добавить(HSG, "HSG");
	СписокУстанавливаемыхЗначений.Добавить(HLG, "HLG");
	СписокУстанавливаемыхЗначений.Добавить(HRB, "HRB");
	СписокУстанавливаемыхЗначений.Добавить(HNS, "HNS");
	ЗаполнитьПоказательНаВсехЗакладкахНаСервере(СписокУстанавливаемыхЗначений, "|Приложение2|Приложение3|Приложение4|");
	
КонецПроцедуры // ОчиститьНаСервере()

&НаСервере
Процедура ОчиститьПоказателиОтчетаЗаполняемыеИзИБНаСервере(ИмяСтраницы)
	
	РегламентированнаяОтчетностьКлиентСервер.ОчиститьПоказателиОтчетаЗаполняемыеИзИБ(ЭтаФорма, ИмяСтраницы);
	
КонецПроцедуры // ОчиститьПоказателиОтчетаЗаполняемыеИзИБНаСервере()

&НаКлиенте
Функция НайтиСвойстваПоказателя(КодПоказателя)
	
	СвойстваПоказателя = СвойстваПоказателей.НайтиСтроки(Новый Структура("Показатель", КодПоказателя));
		
	Если СвойстваПоказателя.Количество() = 0 Тогда
		
		СвойстваПоказателя = Неопределено;
		
		Для Каждого Стр из СвойстваПоказателей Цикл
			Если Лев(КодПоказателя, СтрДлина(Стр.Показатель)) = Стр.Показатель Тогда
				СвойстваПоказателя = Стр;
				Прервать;
			КонецЕсли;
		КонецЦикла;
		
	Иначе
		
		СвойстваПоказателя = СвойстваПоказателя[0];
		
	КонецЕсли;
		
	Возврат СвойстваПоказателя;
	
КонецФункции // НайтиСвойстваПоказателя()


&НаКлиенте
Процедура Выгрузить(Команда)

	ВыгрузитьОтчет();

КонецПроцедуры // Выгрузить()      

&НаКлиенте
Процедура ВыгрузитьОтчет() Экспорт
		
	ОписаниеОповещения = Новый ОписаниеОповещения("ВыгрузитьОтчетЗавершение", ЭтотОбъект);
	
	Если Модифицированность Тогда
		СохранитьНаКлиенте(,ОписаниеОповещения);
	Иначе
		ВыполнитьОбработкуОповещения(ОписаниеОповещения);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ВыгрузитьОтчетЗавершение(Результат, ДополнительныеПараметры) Экспорт
	
	ФормаВыгрузкиРеглОтчета = ПолучитьФорму("Документ.ВыгрузкаРегламентированныхОтчетов.Форма.ФормаДокумента", , ЭтаФорма);
	
	СпДокОсн = Новый СписокЗначений;
	СпДокОсн.Добавить(СтруктураРеквизитовФормы.мСохраненныйДок);
	
	ФормаВыгрузкиРеглОтчета.Открыть();
	ФормаВыгрузкиРеглОтчета.СформироватьИЗаписать(СпДокОсн);
	
	
КонецПроцедуры

&НаКлиенте
Процедура АктивизироватьЯчейку(Ячейка) Экспорт

	РегламентированнаяОтчетностьКлиент.АктивизироватьЯчейку(ЭтаФорма, Ячейка);
		
КонецПроцедуры // АктивизироватьЯчейку()


// ПоказатьБланк()
//
&НаКлиенте
Процедура ПоказатьБланк(Команда)
	
	Печать(Команда.Имя);
	
КонецПроцедуры // ПоказатьБланк()

// ПечататьСразу()
//
&НаКлиенте
Процедура ПечататьСразу(Команда)
	
	Печать(Команда.Имя);
	
КонецПроцедуры // ПечататьСразу()

// Обрабатывает полученный из формы ФормаНастройкиОтчета дерево значений,
// определяет состав помеченных для вывода на печать листов.
//
// Параметры:
//  ВидПечати - строка, задающая способ печати:
//              "ПоказатьБланк" - непосредственный вывод на печать;
//              "ПечататьСразу" - с предварительным просмотром.
//
&НаКлиенте
Процедура Печать(ВидПечати, ЧтоИскать = Неопределено, НеИзФормыОтчета = Ложь) Экспорт
	
	Если НЕ РегламентированнаяОтчетность.ПринтерДоступен() Тогда
		ПоказатьПредупреждение(, СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='Перед формированием печатных форм необходимо определить в системе принтер и%1задать его в качестве используемого по умолчанию!';uk='Перед формуванням друкованих форм необхідно визначити в системі принтер%1задати його в якості використовуваного за замовчуванням!'"), Символы.ПС));				
		Возврат;
	КонецЕсли;
              	
	Состояние(СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='%1. Формируется печатная форма...';uk='%1. Формується друкована форма...'"), ЭтаФорма.Заголовок), , , БиблиотекаКартинок.Печать);
				
	ПечатьНаСервере(ВидПечати, ЧтоИскать);
		
	РегламентированнаяОтчетностьКлиент.ОткрытьФормуПредварительногоПросмотра(ЭтаФорма, ВидПечати, , СтруктураРеквизитовФормы.СписокПечатаемыхЛистов);
	
	СтруктураРеквизитовФормы.мРежимПечати = Ложь;

КонецПроцедуры // Печать()

// ПечатьНаСервере()
//
&НаСервере
Процедура ПечатьНаСервере(ВидПечати, ЧтоИскать = Неопределено);
				
	СтруктураРеквизитовФормы.мПечатныеФормы.Очистить();
	СтруктураРеквизитовФормы.мРежимПечати = Истина;
	
	СохранитьДанныеРаздела(СтруктураРеквизитовФормы.НаимТекущегоРаздела, Ложь, Ложь);
				
	сохрТаблДок = ТабличныйДокумент.ПолучитьОбласть();
	
	ОбщиеРеквизитыРазделов = Новый Структура();
	
	Для Каждого СтрокаУровня1 Из мДеревоВыбранныхСтраниц.ПолучитьЭлементы() Цикл
		
		Если СтрокаУровня1.ВыводНаПечать = 0 Тогда
			Продолжить;
		КонецЕсли;

		СтруктураПараметров = Новый Структура;
		СтруктураПараметров.Вставить("НаименованиеЛиста",  СтрокаУровня1.Представление);
		СтруктураПараметров.Вставить("ОриентацияЛиста",    СтрокаУровня1.ОриентацияСтраницы);
		СтруктураПараметров.Вставить("ИмяСтраницы",        СтрокаУровня1.ИмяСтраницы);
		Структурапараметров.Вставить("ИмяОбластиТаблПоля", СтрокаУровня1.ИмяОбластиТабличногоПоля);
		СтруктураПараметров.Вставить("ВидПечати",          ВидПечати);
		СтруктураПараметров.Вставить("ЕстьДуплекс",        СтруктураРеквизитовФормы.ЕстьДуплекс);
		
		Если НЕ мСтруктураМногостраничныхРазделов.Свойство(СтрокаУровня1.ИмяСтраницы) Тогда
			
			ВывестиМакетВТаблДокНаСервере(СтрокаУровня1.ИмяСтраницы, 0);
			ВывестиНаПечатьЛист(СтруктураПараметров, ОбщиеРеквизитыРазделов);
			
		Иначе
			
			СтруктураПараметров.Вставить("ИмяСтраницыПанели", СтрокаУровня1.ИмяСтраницы);
			ВывестиНаПечатьДополнительныеСтраницы(СтруктураПараметров, ОбщиеРеквизитыРазделов);
			
		КонецЕсли;
		
	КонецЦикла;
	
	ТабличныйДокумент.Очистить();
	ТабличныйДокумент.Вывести(сохрТаблДок);
	
	РегламентированнаяОтчетностьКлиентСервер.ПроставлениеНомеровЛистов(ЭтаФорма, , СтруктураРеквизитовФормы.СписокПечатаемыхЛистов);
	
КонецПроцедуры // ПечатьНаСервере()

// Процедура управляет выводом отдельных страниц отчета на печать.
//
// Параметры:
//   Парам1 - структура, содержащая параметры печаты страницы:
//      - Имя выводимого на печать листа;
//      - ориентация страницы;
//      - имя табличного поля, который выводится на печать;
//      - имя области дабличного документа, выводимой на печать;
//      - строка, задающая способ печати.Принимает значения:
//           "ПечататьСразу" - непосредственный вывод на печать;
//           "ПечататьБланк" - с предварительным просмотром.
//
&НаСервере
Процедура ВывестиНаПечатьЛист(Парам1, ОбщиеРеквизитыРазделов)
		
	РегламентированнаяОтчетность.ВывестиНаПечатьЛистОбщая(ЭтаФорма.Заголовок, Парам1, ТабличныйДокумент, СтруктураРеквизитовФормы.мПечатныеФормы);
		
КонецПроцедуры // ВывестиНаПечатьЛист()

&НаСервере
Процедура ВывестиНаПечатьДополнительныеСтраницы(СтруктураПараметровСтраницы, ОбщиеРеквизитыРазделов)
	Перем ИмяСтраницы;
	Перем ТаблицаСтраницРаздела;
	
	СтруктураПараметровСтраницы.Свойство("ИмяСтраницыПанели", ИмяСтраницы);

	Если Не мСтруктураМногостраничныхРазделов.Свойство(ИмяСтраницы, ТаблицаСтраницРаздела) Тогда
		Возврат;
	КонецЕсли;

	ТаблицаСтраницРаздела = ЭтаФорма[ТаблицаСтраницРаздела];
	
	Для Каждого Страница Из ТаблицаСтраницРаздела Цикл
		// выводим на печать каждую страницу многостраничного раздела
		ТекущийИндекс = ТаблицаСтраницРаздела.Индекс(Страница);
		СохрАктивнаяСтраница = ТаблицаСтраницРаздела[ТекущийИндекс].АктивнаяСтраница;
		ВывестиМакетВТаблДокНаСервере(ИмяСтраницы, ТекущийИндекс + 1);
		ТаблицаСтраницРаздела[ТекущийИндекс].АктивнаяСтраница = СохрАктивнаяСтраница;
		ВывестиНаПечатьЛист(СтруктураПараметровСтраницы, ОбщиеРеквизитыРазделов);
	КонецЦикла;
    		
КонецПроцедуры // ВывестиНаПечатьДополнительныеСтраницы()
      
&НаКлиенте
Процедура ПриОткрытии(Отказ)
		
	Если Найти(Заголовок, СтруктураРеквизитовФормы.СтрПериодОтчета) = 0 Тогда
		Заголовок = Заголовок + " за " + СтруктураРеквизитовФормы.СтрПериодОтчета;
	КонецЕсли;
	
	Заголовок = Заголовок + ?(Найти(ЭтаФорма.ИмяФормы, "Внешний") > 0, " - внешний отчет", "");
	
	ОргСтр = " (" + СтруктураРеквизитовФормы.НаимОрганизации + ")";
	Если Найти(Заголовок, ОргСтр) = 0 Тогда
		Заголовок = Заголовок + ОргСтр;
	КонецЕсли;
	
КонецПроцедуры // ПриОткрытии()

&НаСервере
Процедура ОчисткаРегламентированногоОтчетаНаСервере(ИмяСтраницы, ЗапускатьОтдельнуюОбработкуПослеОчисткиЛиста, РежимОчистки, Многостраничность, КолВоСтраницВРазделе) Экспорт
	
	УдалятьсяВсеДопЭкземпляры = Ложь;
	
	Если Найти(РежимОчистки, "ОчиститьТекущийРаздел") > 0 Тогда
		
		Если (Многостраничность) И (КолВоСтраницВРазделе > 1) Тогда
			
			ОчиститьПоказателиОтчетаЗаполняемыеИзИБНаСервере(ИмяСтраницы);
			
			УдалятьсяВсеДопЭкземпляры = Истина;
			
		Иначе
			
			ОчиститьТабличноеПолеНаСервере(ИмяСтраницы);
			
		КонецЕсли;
		
	ИначеЕсли Найти(РежимОчистки, "ОчиститьТекущийЭкземплярМногостраничногоРаздела") > 0 Тогда
		
		ОчиститьТабличноеПолеНаСервере(ИмяСтраницы);
		
	КонецЕсли;
			
	РегламентированнаяОтчетностьКлиентСервер.ПослеОчисткиРегламентированногоОтчета(ЭтаФорма, ИмяСтраницы, ЗапускатьОтдельнуюОбработкуПослеОчисткиЛиста);
	
	СформироватьДеревоРазделовОтчетаНаСервере();
	
	СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Ложь;
	
КонецПроцедуры 

&НаКлиенте
Процедура ОчисткаРегламентированногоОтчетаНаКлиенте(ИмяСтраницы, ЗапускатьОтдельнуюОбработкуПослеОчисткиЛиста, РежимОчистки, Многостраничность, КолВоСтраницВРазделе) Экспорт
	
	УдалятьсяВсеДопЭкземпляры = Ложь;
	
	Если Найти(РежимОчистки, "ОчиститьТекущийРаздел") > 0 Тогда
		
		Если (Многостраничность) И (КолВоСтраницВРазделе > 1) Тогда

			РегламентированнаяОтчетностьКлиентСервер.ОчиститьПоказателиОтчетаЗаполняемыеИзИБ(ЭтаФорма, ИмяСтраницы);

			УдалятьсяВсеДопЭкземпляры = Истина;
			
		Иначе

			ОчиститьТабличноеПолеНаКлиенте(ИмяСтраницы);

		КонецЕсли;
		
	ИначеЕсли Найти(РежимОчистки, "ОчиститьТекущийЭкземплярМногостраничногоРаздела") > 0 Тогда
		
		ОчиститьТабличноеПолеНаКлиенте(ИмяСтраницы);
		
	КонецЕсли;
	
	РегламентированнаяОтчетностьКлиентСервер.ПослеОчисткиРегламентированногоОтчета(ЭтаФорма, ИмяСтраницы, ЗапускатьОтдельнуюОбработкуПослеОчисткиЛиста);
	
	СформироватьДеревоРазделовОтчетаНаКлиенте();
	
КонецПроцедуры // ОчисткаРегламентированногоОтчетаНаКлиенте()

&НаКлиенте
Процедура ЗаполнитьАвто(Команда)
	
	//ИНАГРО ++
	Если СтруктураРеквизитовФормы.СпецРежим = 2 или СтруктураРеквизитовФормы.СпецРежим = 3 Тогда
		//Проверяем на заполненность коэффициентов распределения по направлением операций и общую сумму коэффициентов
		Если СтруктураРеквизитовФормы.К1 + СтруктураРеквизитовФормы.К2 + СтруктураРеквизитовФормы.К3 <> 100 Тогда
			Сообщить(Нстр("ru = 'Сумма процентов распределения не равна 100%. Заполнение на может быть выполнено!'; uk = 'Сумма відсотків для розподілу не дорівнює 100. Заповнення не може бути виконане!'"),СтатусСообщения.Важное);
			Возврат;
		КонецЕсли;
	КонецЕсли;
	//ИНАГРО --

	ПараметрыЗаполненияЗвит1С = Неопределено;
	
	ЗаполнитьАвтоНаСервере(ПараметрыЗаполненияЗвит1С);
	
	ДозаполнитьНаКлиенте(ПараметрыЗаполненияЗвит1С);
	
	СтруктураРеквизитовФормы.ВыводитьСтраницуВТаблДокНаСервере = Ложь;
	
	РегламентированнаяОтчетностьКлиент.ОбновитьДеревоРазделовВФормеОтчета(ЭтаФорма);
	
	Если НЕ Элементы.РазделыОтчета.ТекущиеДанные = Неопределено Тогда
		Если НЕ Элементы.РазделыОтчета.ТекущиеДанные.ПолучитьРодителя() = Неопределено Тогда
			Элементы.РазделыОтчета.ТекущаяСтрока = Элементы.РазделыОтчета.ТекущиеДанные.ПолучитьРодителя().ПолучитьЭлементы()[0].ПолучитьИдентификатор();
		КонецЕсли;
	КонецЕсли;
	
	Если Элементы.Расшифровать.Видимость Тогда
		Элементы.Расшифровать.Доступность = Истина;
	КонецЕсли;
	
КонецПроцедуры // ЗаполнитьАвто()

&НаСервере
Процедура ЗаполнитьАвтоНаСервере(ПараметрыЗаполненияЗвит1С)
	
	ОчиститьНаСервере();
	//ОчисткаРегламентированногоОтчетаНаСервере("Декларация",Ложь,"ОчиститьТекущийРаздел",Истина, 2);	

	СохранитьДанныеРаздела(СтруктураРеквизитовФормы.НаимТекущегоРаздела, Ложь);
	Заполнить(ПараметрыЗаполненияЗвит1С);
	ВывестиМакетВТаблДокНаСервере(СтруктураРеквизитовФормы.НаимТекущегоРаздела, 1);
	
	РасчетНаСервере();
	
	Модифицированность = Истина;
	
КонецПроцедуры

&НаСервере
Процедура ПодготовитьДанныеДляПриложения5ВРазрезеКонтрагентов(Таблица,МассивСтатей,ИмяКолонки,ИмяГруппы)
	
	//ОписаниеТиповЧисло  = СоздатьОписанияТипов("Число", 15, 2);
	МассивТипов = Новый Массив;
	МассивТипов.Добавить(Тип("Число"));
	ОписаниеТиповЧисло  = Новый ОписаниеТипов(МассивТипов, Новый КвалификаторыЧисла(15, 2));

	ОписаниеТиповСтрока =  СоздатьОписанияТипов("Строка", 254);
	СтрокиДекларацииНДС = Справочники.СтатьиНалоговыхДеклараций;

	ТаблицаКонтрагентов = Новый ТаблицаЗначений;
	ТаблицаКонтрагентов.Колонки.Добавить("Контрагент",		ОписаниеТиповСтрока);
	ТаблицаКонтрагентов.Колонки.Добавить("ИННКонтрагента",	СоздатьОписанияТипов("Строка",12));
	ТаблицаКонтрагентов.Колонки.Добавить("БазаНДС",			ОписаниеТиповЧисло);
	ТаблицаКонтрагентов.Колонки.Добавить("НДС",				ОписаниеТиповЧисло);
	ТаблицаКонтрагентов.Колонки.Добавить("НДС7",			ОписаниеТиповЧисло);
	ТаблицаКонтрагентов.Колонки.Добавить("Дата");	
	ТаблицаКонтрагентов.Колонки.Добавить("КассовыйМетод");
	
	Для i = 0 по МассивСтатей.Количество()- 1 Цикл
		
		СтатьяДекларации = МассивСтатей[i];
		
		Отбор = Новый Структура;
		Отбор.Вставить(ИмяКолонки, СтатьяДекларации);
		НужныеСтроки = Таблица.НайтиСтроки(Отбор);
		
		Для каждого строка Из НужныеСтроки Цикл
			
			КассовыйМетод = "";
			Если  ИмяГруппы = СтруктураРеквизитовФормы.мИдГруппы51 Тогда
				
				Если Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7 Тогда
					
					Если СтатьяДекларации = СтрокиДекларацииНДС.НДС_НОПоСтавке20ПоставкаОФ Тогда
						// такого быть не должно!
						Сообщить(НСтр("ru = 'Обнаружена поставка основных фондов по ставке 7%. Проверьте заполнение налоговых накладных!'; uk = 'Виявлено постачання основних засобів за ставкою ПДВ 7%. Перевірте заповнення податкових накладних!'"));		
					КонецЕсли;
					
					Если Строка.ЭтоУсловнаяПродажа = Истина Тогда
						R42GA = R42GA +  строка.БазаНДСОборот;
						R42GB = R42GB +  строка.НДСОборот;
					Иначе	
						R12GA = R12GA +  строка.БазаНДСОборот;
						R12GB = R12GB +  строка.НДСОборот;
					КонецЕсли;
					
				Иначе
					//20%
					
					Если СтатьяДекларации = СтрокиДекларацииНДС.НДС_НОПоСтавке20ПоставкаОФ Тогда
						R011G4 = R011G4 +  строка.БазаНДСОборот;
						R011G5 = R011G5 +  строка.НДСОборот;
					КонецЕсли;
					
					Если Строка.ЭтоУсловнаяПродажа = Истина Тогда
						R41GA = R41GA +  строка.БазаНДСОборот;
						R41GB = R41GB +  строка.НДСОборот;
					Иначе
						R11GA = R11GA +  строка.БазаНДСОборот;
						R11GB = R11GB +  строка.НДСОборот;
					КонецЕсли;
					
				КонецЕсли;
				
			ИначеЕсли ИмяГруппы = СтруктураРеквизитовФормы.мИдГруппы52 Тогда	
				
				Если  НЕ Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7
					И НЕ Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС20
					И НЕ Строка.СтавкаНДС = Перечисления.СтавкиНДС.СпецСт8 Тогда //ИНАГРО 

					R103GA = R103GA + строка.БазаНДСОборот;
				    Продолжить;
					
				КонецЕсли;
				
				Если РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
					ТипДокументаИмпорт = "ДокументСсылка.ТаможеннаяДекларацияИмпорт";
				Иначе
					ТипДокументаИмпорт = "ДокументСсылка.ГТДИмпорт";
				КонецЕсли;	
				Если ТипЗнч(Строка.Регистратор) = Тип(ТипДокументаИмпорт)
					ИЛИ (НЕ Строка.Регистратор = Неопределено И Строка.Регистратор.Метаданные().Имя = "ИНАГРО_ГТДИмпортБиологическихАктивов") Тогда //ИНАГРО 

					Если Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7 Тогда
						R112GA = R112GA + строка.БазаНДСОборот;
						R112GB = R112GB + строка.НДСОборот;
						
						// так как при заполнении строки 11.1 из нее вычитаются данные по ставке 7% (11.2)
						// покажем значение по ставке 7% также и в строке для 20%
						R111GA = R111GA + строка.БазаНДСОборот;
						R111GB = R111GB + строка.НДСОборот;
						
						//ИНАГРО ++
						Если (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 1 Тогда
							R01062GA = R01062GA + строка.БазаНДСОборот;
							R01062GB = R01062GB + строка.НДСОборот;
							
							R01061GA = R01061GA +  строка.БазаНДСОборот;
							R01061GB = R01061GB +  строка.НДСОборот;
						ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 2 Тогда
							R02062GA = R02062GA + строка.БазаНДСОборот;
							R02062GB = R02062GB + строка.НДСОборот;
							
							R02061GA = R02061GA +  строка.БазаНДСОборот;
							R02061GB = R02061GB +  строка.НДСОборот;
						ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 3 Тогда
							R03062GA = R03062GA + строка.БазаНДСОборот;
							R03062GB = R03062GB + строка.НДСОборот;
							
							R03061GA = R03061GA +  строка.БазаНДСОборот;
							R03061GB = R03061GB +  строка.НДСОборот;
						КонецЕсли;
						//ИНАГРО --
				
					Иначе
						R111GA = R111GA + строка.БазаНДСОборот;
						R111GB = R111GB + строка.НДСОборот;
						
						//ИНАГРО ++
						Если (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 1 Тогда
							R01061GA = R01061GA +  строка.БазаНДСОборот;
							R01061GB = R01061GB +  строка.НДСОборот;
						ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 2 Тогда
							R02061GA = R02061GA +  строка.БазаНДСОборот;
							R02061GB = R02061GB +  строка.НДСОборот;
						ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 3 Тогда
							R03061GA = R03061GA +  строка.БазаНДСОборот;
							R03061GB = R03061GB +  строка.НДСОборот;
						КонецЕсли;
						//ИНАГРО --
						
					КонецЕсли;
					
					Продолжить;
					
				КонецЕсли;
				
				Если    СтатьяДекларации = СтрокиДекларацииНДС.НДС_НКПокупкаСНДСвВРОблагПриобрОФ 
					ИЛИ СтатьяДекларации = СтрокиДекларацииНДС.НДС_НКПропорциональноНеВклВКредитПоставкаОФ
					ИЛИ СтатьяДекларации = СтрокиДекларацииНДС.НДС_НКПропорциональноВклВКредитПоставкаОФ Тогда
					
					R021G4 = R021G4 +  строка.БазаНДСОборот;
					
					Если Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7 Тогда
						Сообщить(НСтр("ru = 'Обнаружено приобретение основных фондов по ставке 7%. Проверьте заполнение входящих налоговых документов!'; uk = 'Виявлено придбання основних засобів за ставкою ПДВ 7%. Перевірте заповнення вхідних податкових накладних!'"));
					Иначе	
						R021G5 = R021G5 +  строка.НДСОборот;
					КонецЕсли;
					
				КонецЕсли;
				
				Если Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7 Тогда
					R102GA = R102GA +  строка.БазаНДСОборот;
					R102GB = R102GB +  строка.НДСОборот;
					
					//ИНАГРО ++
					Если (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 1 Тогда
						R01052GA = R01052GA +  строка.БазаНДСОборот;
						R01052GB = R01052GB +  строка.НДСОборот;
					ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 2 Тогда
						R02052GA = R02052GA +  строка.БазаНДСОборот;
						R02052GB = R02052GB +  строка.НДСОборот;
					ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 3 Тогда
						R03052GA = R03052GA +  строка.БазаНДСОборот;
						R03052GB = R03052GB +  строка.НДСОборот;
					//Сумму НДС необходимо распределить по 3-м таблицам согласно коэффициентам
					ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 0 Тогда
						ОсталосьРаспределитьБазаНДСОборот = Строка.БазаНДСОборот;
						ОсталосьРаспределитьНДСОборот = Строка.НДСОборот;
						ОсталосьРаспределитьПроцентов = 100;
						//Таблица 1
						ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К1;
						Если ОсталосьРаспределитьПроцентов <=0 Тогда
							R01052GA = R01052GA + ОсталосьРаспределитьБазаНДСОборот;
							R01052GB = R01052GB + ОсталосьРаспределитьНДСОборот;
							ОсталосьРаспределитьБазаНДСОборот = 0;
							ОсталосьРаспределитьНДСОборот = 0;
						Иначе
							R01052GA = R01052GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
							R01052GB = R01052GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
							ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
							ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
						КонецЕсли;
						//Таблица 2
						ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К2;
						Если ОсталосьРаспределитьПроцентов <=0 Тогда
							R02052GA = R02052GA + ОсталосьРаспределитьБазаНДСОборот;
							R02052GB = R02052GB + ОсталосьРаспределитьНДСОборот;
							ОсталосьРаспределитьБазаНДСОборот = 0;
							ОсталосьРаспределитьНДСОборот = 0;
						Иначе
							R02052GA = R02052GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
							R02052GB = R02052GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
							ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
							ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
						КонецЕсли;
						//Таблица 3
						ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К3;
						Если ОсталосьРаспределитьПроцентов <=0 Тогда
							R03052GA = R03052GA + ОсталосьРаспределитьБазаНДСОборот;
							R03052GB = R03052GB + ОсталосьРаспределитьНДСОборот;
							ОсталосьРаспределитьБазаНДСОборот = 0;
							ОсталосьРаспределитьНДСОборот = 0;
						Иначе
							R03052GA = R03052GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
							R03052GB = R03052GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
							ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
							ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
						КонецЕсли;
						
					КонецЕсли;
					//ИНАГРО --
					
				Иначе	
					R101GA = R101GA +  строка.БазаНДСОборот;
					R101GB = R101GB +  строка.НДСОборот;
					
					//ИНАГРО ++	
					Если (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 1 Тогда
						R01051GA = R01051GA +  строка.БазаНДСОборот;
						R01051GB = R01051GB +  строка.НДСОборот;
					ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 2 Тогда
						R02051GA = R02051GA +  строка.БазаНДСОборот;
						R02051GB = R02051GB +  строка.НДСОборот;
					ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 3 Тогда
						R03051GA = R03051GA +  строка.БазаНДСОборот;
						R03051GB = R03051GB +  строка.НДСОборот;
					//Сумму НДС необходимо распределить по 3-м таблицам согласно коэффициентам
					ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 0 Тогда
						ОсталосьРаспределитьБазаНДСОборот = Строка.БазаНДСОборот;
						ОсталосьРаспределитьНДСОборот = Строка.НДСОборот;
						ОсталосьРаспределитьПроцентов = 100;
						//Таблица 1
						ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К1;
						Если ОсталосьРаспределитьПроцентов <=0 Тогда
							R01051GA = R01051GA + ОсталосьРаспределитьБазаНДСОборот;
							R01051GB = R01051GB + ОсталосьРаспределитьНДСОборот;
							ОсталосьРаспределитьБазаНДСОборот = 0;
							ОсталосьРаспределитьНДСОборот = 0;
						Иначе
							R01051GA = R01051GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
							R01051GB = R01051GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
							ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
							ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
						КонецЕсли;
						//Таблица 2
						ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К2;
						Если ОсталосьРаспределитьПроцентов <=0 Тогда
							R02051GA = R02051GA + ОсталосьРаспределитьБазаНДСОборот;
							R02051GB = R02051GB + ОсталосьРаспределитьНДСОборот;
							ОсталосьРаспределитьБазаНДСОборот = 0;
							ОсталосьРаспределитьНДСОборот = 0;
						Иначе
							R02051GA = R02051GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
							R02051GB = R02051GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
							ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
							ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
						КонецЕсли;
						//Таблица 3
						ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К3;
						Если ОсталосьРаспределитьПроцентов <=0 Тогда
							R03051GA = R03051GA + ОсталосьРаспределитьБазаНДСОборот;
							R03051GB = R03051GB + ОсталосьРаспределитьНДСОборот;
							ОсталосьРаспределитьБазаНДСОборот = 0;
							ОсталосьРаспределитьНДСОборот = 0;
						Иначе
							R03051GA = R03051GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
							R03051GB = R03051GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
							ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
							ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
						КонецЕсли;
						
					КонецЕсли;
					//ИНАГРО --
					
				КонецЕсли;
			
				Если Строка.МоментОпределенияПервогоСобытия = Перечисления.МоментыОпределенияНалоговойБазы.ПоОплате Тогда
					
					КассовыйМетод = "+";
					
				КонецЕсли;
				
			КонецЕсли;
			
			Если ИмяГруппы = СтруктураРеквизитовФормы.мИдГруппы51 Тогда
			ИначеЕсли НЕ ЗначениеЗаполнено(Строка.ИННКонтрагента) Тогда	
				Если РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
					НаимКонтрагента = Строка.Контрагент;
				Иначе
					НаимКонтрагента = Строка.ДоговорКонтрагента.Владелец;
				КонецЕсли;	
				Сообщить(СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(Нстр("ru = 'Имеются входящие налоговые накладные от контрагента  %1 с незаполненным ИНН!'; uk = 'Є вхідні податкові налогові від контрагента  %1  з незаповненим ІПН!'"), НаимКонтрагента));
			КонецЕсли;	
			
			НоваяСтрока 		   = ТаблицаКонтрагентов.Добавить();  
			НоваяСтрока.Контрагент = СокрЛП(Строка.Контрагент);
			Если ПустаяСтрока(НоваяСтрока.Контрагент) Тогда
				НоваяСтрока.Контрагент = "<Кінцевий споживач>";
			КонецЕсли;
			
			НоваяСтрока.ИННКонтрагента = Формат(Строка.ИННКонтрагента,"ЧГ=0");  
			НоваяСтрока.БазаНДС 	   = строка.БазаНДСОборот;  
			
			Если  Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7 Тогда
				НоваяСтрока.НДС7 = строка.НДСОборот;                                      
			Иначе	
				НоваяСтрока.НДС  = строка.НДСОборот;                                      	
			КонецЕсли;
			
			Если ЗначениеЗаполнено(Строка.ПериодСоставленияНН) Тогда
				НоваяСтрока.Дата = КонецМесяца(Строка.ПериодСоставленияНН);
			КонецЕсли;
			
			
			НоваяСтрока.КассовыйМетод = КассовыйМетод;
				
		КонецЦикла;
	КонецЦикла;	
	
	ТаблицаСоответствияИНН = ТаблицаКонтрагентов.Скопировать();
	ТаблицаСоответствияИНН.Свернуть("Контрагент,ИННКонтрагента");
	
	ТаблицаКонтрагентов.Колонки.Добавить("КонтрагентСпецКода");
	Для каждого Строка Из ТаблицаКонтрагентов Цикл
		Если Прав(Строка.ИННКонтрагента, 11) = "00000000000" Тогда
			Строка.КонтрагентСпецКода = Строка.Контрагент;
		КонецЕсли;
	КонецЦикла;
	
	ТаблицаКонтрагентов.Свернуть("ИННКонтрагента,Дата,КассовыйМетод,КонтрагентСпецКода", "БазаНДС,НДС,НДС7");
	ТаблицаКонтрагентов.Сортировать("ИННКонтрагента,Дата");
	
	ТаблицаКонтрагентов.Колонки.Добавить("Контрагент");
	
	Отбор = Новый Структура;
	Для Каждого СтрокаТаблицыКонтрагентов Из ТаблицаКонтрагентов Цикл 
		 
		 Отбор.Вставить("ИННКонтрагента",СтрокаТаблицыКонтрагентов.ИннКонтрАгента);
		 
		 МассивКонтрагентов =  ТаблицаСоответствияИНН.НайтиСтроки(Отбор);
		 
		 НазванияКонтрагентов = "";
		 Для каждого Контрагент из МассивКонтрагентов Цикл
			 НазванияКонтрагентов = НазванияКонтрагентов + Символы.ПС + Контрагент.Контрагент;		 
		 КонецЦикла; 
		 НазванияКонтрагентов = Сред(НазванияКонтрагентов,2);
		 
		 СтрокаТаблицыКонтрагентов.Контрагент = НазванияКонтрагентов;
		 
		 Если ЗначениеЗаполнено(СтрокаТаблицыКонтрагентов.КонтрагентСпецКода) Тогда
		 	СтрокаТаблицыКонтрагентов.Контрагент = СтрокаТаблицыКонтрагентов.КонтрагентСпецКода;	
		 КонецЕсли;
		 
	 КонецЦикла;	 
	
	//далее здесь вносим в таблицу
	ВнестиИнфоВПриложение5(ТаблицаКонтрагентов, ИмяГруппы);
	
КонецПроцедуры	

//Процедура вносит строки в приложение 5, в том случае, если передаваемый ей параметр
//ЗначениеПараметра отличен от нуля
&НаСервере
Процедура ВнестиИнфоВПриложение5(Таблица, ИмяГруппы)
	
	перем СтруктураГруппы, ИсходноеКоличествоСтрокГруппы;

	ДанныеФормы 	= ЭтаФорма[ИмяГруппы];
	СтруктураГруппы = ДанныеФормыВЗначение(ДанныеФормы, Тип("ТаблицаЗначений"));		
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);
	
	ПрефиксИмениКолонки = ИмяГруппы+"XXXX";
	
	СчетчикСтрок = 0;
	Для каждого строка Из Таблица Цикл
		
		// отдельно выделенные строки под условные ИНН для первой таблицы
		Если ИмяГруппы = СтруктураРеквизитовФормы.мИдГруппы51 Тогда

			Если    Строка.ИННКонтрагента = "100000000000"
				ИЛИ Строка.ИННКонтрагента = "200000000000" 
//				ИЛИ Строка.ИННКонтрагента = "300000000000" 
				ИЛИ Строка.ИННКонтрагента = "400000000000" 
//				ИЛИ Строка.ИННКонтрагента = "500000000000" 
				ИЛИ Строка.ИННКонтрагента = "600000000000" Тогда
									
					КодСтроки = "R001" + Лев(Строка.ИННКонтрагента, 1) + "G";
					
					СтруктураДанныхПриложение5[КодСтроки + "4"] = СтруктураДанныхПриложение5[КодСтроки + "4"]  + Строка.БазаНДС;
					СтруктураДанныхПриложение5[КодСтроки + "5"] = СтруктураДанныхПриложение5[КодСтроки + "5"]  + Строка.НДС;
					СтруктураДанныхПриложение5[КодСтроки + "6"] = СтруктураДанныхПриложение5[КодСтроки + "6"]  + Строка.НДС7;
					
					Если НЕ Строка.БазаНДС = 0 Тогда
						_ДобавитьСтрокуРасшифровки(ЭтаФорма,КодСтроки + "4", "Показник ""Обсяг поставки (без ПДВ)"" графи ""Інші"" ("+Строка.ИННКонтрагента+") Додатку 5, Таблиці 1","+","" 					+ Строка.Контрагент, строка.БазаНДС,,,,,"Приложение5");
					КонецЕсли;
					Если НЕ Строка.НДС = 0 Тогда
						_ДобавитьСтрокуРасшифровки(ЭтаФорма,КодСтроки + "5", "Показник ""Сумма ПДВ, основна ставка"" графи ""Інші"" ("+Строка.ИННКонтрагента+") Додатку 5, ""Податкові зобов'язання""","+","" 			+ Строка.Контрагент, строка.НДС,,,,,"Приложение5");
					КонецЕсли;
					Если НЕ Строка.НДС7 = 0 Тогда
						_ДобавитьСтрокуРасшифровки(ЭтаФорма,КодСтроки + "6", "Показник ""Сумма ПДВ, ставка 7%"" графи ""Інші"" ("+Строка.ИННКонтрагента+") Додатку 5, Таблиці 1 ""Податкові зобов'язання""","+",""			+ Строка.Контрагент, строка.НДС7,,,,,"Приложение5");
					КонецЕсли;
					
					Продолжить;
					
				КонецЕсли;	
				
		КонецЕсли;			

		Если СчетчикСтрок < ИсходноеКоличествоСтрокГруппы Тогда
			ДобавленнаяСтрока = СтруктураГруппы[СчетчикСтрок];
		Иначе
			ДобавленнаяСтрока = СтруктураГруппы.Добавить();	
		КонецЕсли;

		СчетчикСтрок = СчетчикСтрок + 1;
		
        ДобавленнаяСтрока[ПрефиксИмениКолонки+"G2"] = строка.ИННКонтрагента;
		
		ИмяКолонки = ПрефиксИмениКолонки+ "Kontragent";
		Если НЕ СтруктураГруппы.Колонки.Найти(ИмяКолонки) = Неопределено Тогда
			ДобавленнаяСтрока[ПрефиксИмениКолонки+"Kontragent"] = строка.Контрагент;	
		КонецЕсли;
		
		Если ЗначениеЗаполнено(строка.Дата) Тогда
			ДобавленнаяСтрока[ПрефиксИмениКолонки+"G3A"] = Месяц(строка.Дата);
			ДобавленнаяСтрока[ПрефиксИмениКолонки+"G3B"] = Год(строка.Дата);
		КонецЕсли;
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G4"] = строка.БазаНДС;
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G5"] = строка.НДС;
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G6"] = строка.НДС7;
		
		ИмяКолонки = ПрефиксИмениКолонки+ "G41";
		Если НЕ СтруктураГруппы.Колонки.Найти(ИмяКолонки) = Неопределено Тогда
			ДобавленнаяСтрока[ПрефиксИмениКолонки+"G41"] = строка.КассовыйМетод;	
		КонецЕсли;
		
	КонецЦикла;	
	
	ЗначениеВРеквизитФормы(СтруктураГруппы, ИмяГруппы);
	
КонецПроцедуры

//Процедура вносит строки в Справку, в том случае, если передаваемый ей параметр
//ЗначениеПараметра отличен от нуля
&НаСервере
Процедура ВнестиИнфоВСправку(Таблица, ИмяГруппы)
	
	перем СтруктураГруппы, ИсходноеКоличествоСтрокГруппы;

	ДанныеФормы 	= ЭтаФорма[ИмяГруппы];
	СтруктураГруппы = ДанныеФормыВЗначение(ДанныеФормы, Тип("ТаблицаЗначений"));		
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);
	
	ПрефиксИмениКолонки = ИмяГруппы+"XXXX";
	
	Для каждого строка Из Таблица Цикл

		Если Таблица.Индекс(Строка)+1 <= ИсходноеКоличествоСтрокГруппы Тогда
			ДобавленнаяСтрока = СтруктураГруппы[Таблица.Индекс(Строка)];
		Иначе
			ДобавленнаяСтрока = СтруктураГруппы.Добавить();	
		КонецЕсли;

        ДобавленнаяСтрока[ПрефиксИмениКолонки+"G2S"] = строка.Операция;
		
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G3S"] = строка.Статья;
		
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G4"] = строка.БазаНДС;
		
	КонецЦикла;	
	
	ЗначениеВРеквизитФормы(СтруктураГруппы, ИмяГруппы);
	
КонецПроцедуры 
 
//Процедура выполняет поиск нужных строк в таблице результатов запроса
//по регистру "Книга продаж" или "Книга приобретений"
// Параметры:
//  СтатьяПоиска - значение типа Справочник.СтатьиНалоговыхДеклараций - статья, для которого требуется
//                 получить итог.
//  ПоказательГрафыА    - наименование показателя графы А формы декларации.
//  ПоказательГрафыБ    - наименование показателя графы Б формы декларации.
//  ПрПоляПоиска        - признак поля поиска (где нужно искать строку:
//  в таблице результатов запроса к регистру "Книга продаж" или "Книга приобретений")                                                       
&НаСервере
Процедура РасчетПоСтатье(СтатьяПоискаИлиМассив,ПоказательГрафыА,ПоказательГрафыБ,ИмяПоказателяГрафыА="",ИмяПоказателяГрафыБ="",ПрПоляПоиска,ДопСтруктураПоиска = Неопределено)
	Перем НайденнаяСтрока;
	Перем БазаНДСОборот, НДСОборот;
	
	Если  ТипЗнч(СтатьяПоискаИлиМассив) = Тип("Массив") Тогда
		
		МассивСтатей = СтатьяПоискаИлиМассив; 
		
	Иначе
		
		МассивСтатей = Новый Массив;
		МассивСтатей.Добавить(СтатьяПоискаИлиМассив);
	
	КонецЕсли;
	
		
	БазаНДСОборот = 0;
	НДСОборот = 0;
	
	Для каждого СтатьяПоиска Из МассивСтатей Цикл
		
		СтруктураПоиска = Новый Структура(?(ПрПоляПоиска = 1, ИмяКолонкиНО, ИмяКолонкиНК), СтатьяПоиска);
		Если ТипЗнч(ДопСтруктураПоиска) = Тип("Структура") Тогда
			Для каждого ЭлементДопСтруктуры Из ДопСтруктураПоиска Цикл
				СтруктураПоиска.Вставить(ЭлементДопСтруктуры.Ключ, ЭлементДопСтруктуры.Значение);
			КонецЦикла;
		КонецЕсли;
		
		НайденныеСтроки = ТаблицаРезультатов.НайтиСтроки(СтруктураПоиска);
		
		Для каждого Строка Из НайденныеСтроки Цикл
		   БазаНДСОборот = БазаНДСОборот + Строка.БазаНДСОборот;
		   НДСОборот 	 = НДСОборот 	 + Строка.НДСОборот;
		КонецЦикла;
	
	КонецЦикла;
	
	Если СтрДлина (ИмяПоказателяГрафыА) > 0 Тогда
		ПоказательГрафыА = ПоказательГрафыА + БазаНДСОборот;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыБ) > 0 Тогда
		ПоказательГрафыБ = ПоказательГрафыБ + НДСОборот;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыА) > 0 Тогда
		СтруктураДанныхДекларация[ИмяПоказателяГрафыА] = ПоказательГрафыА;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыБ) > 0 Тогда
		СтруктураДанныхДекларация[ИмяПоказателяГрафыБ] = ПоказательГрафыБ;
	КонецЕсли;	
	
КонецПроцедуры

&НаСервере
Процедура ПодготовитьДанныеДляСправки(Таблица,ИмяКолонки,Статья,ИмяГруппы)
	
	ОписаниеТиповЧисло = СоздатьОписанияТипов("Число", 15, 2);
	ОписаниеТиповСтрока =  СоздатьОписанияТипов("Строка", 254);

	ТаблицаКонтрагентов = Новый ТаблицаЗначений;
	ТаблицаКонтрагентов.Колонки.Добавить("Операция",		ОписаниеТиповСтрока);
	ТаблицаКонтрагентов.Колонки.Добавить("Статья",			ОписаниеТиповСтрока);
	ТаблицаКонтрагентов.Колонки.Добавить("БазаНДС",			ОписаниеТиповЧисло);
	
	Отбор = Новый Структура;
	Отбор.Вставить(ИмяКолонки, Статья);
	НужныеСтроки = Таблица.НайтиСтроки(Отбор);
	
	Для каждого строка Из НужныеСтроки Цикл
		
		НоваяСтрока 			   = ТаблицаКонтрагентов.Добавить();  
		НоваяСтрока.Операция       = Строка.ОперацияД6;
		НоваяСтрока.Статья     	   = Строка.СтатьяД6;
		НоваяСтрока.БазаНДС 	   = строка.БазаНДСОборот;  
		
	КонецЦикла;
	
	ТаблицаКонтрагентов.Свернуть("Статья, Операция", "БазаНДС");
	ТаблицаКонтрагентов.Сортировать("Статья, Операция");
	
	//далее здесь вносим в таблицу
	ВнестиИнфоВСправку(ТаблицаКонтрагентов, ИмяГруппы);
	
КонецПроцедуры	

&НаСервере
Процедура ПодготовитьДанныеДляПриложения1ВРазрезеКонтрагентов(Таблица,ИмяКолонки,Статья,Признак)

	Если (Признак = "НО")  Тогда
		ИмяТаблицы = СтруктураРеквизитовФормы.мИдГруппы1;
	Иначе
		ИмяТаблицы = СтруктураРеквизитовФормы.мИдГруппы2;
	КонецЕсли;

	Если НЕ ТипЗнч(Статья) = Тип("Массив") Тогда
	
		МассивСтатей = Новый Массив;
		МассивСтатей.Добавить(Статья);
		
	Иначе
		
		МассивСтатей = Статья
		
	КонецЕсли;
	
	//ОписаниеТиповЧисло  = СоздатьОписанияТипов("Число", 15, 2);
	МассивТипов = Новый Массив;
	МассивТипов.Добавить(Тип("Число"));
	ОписаниеТиповЧисло  = Новый ОписаниеТипов(МассивТипов, Новый КвалификаторыЧисла(15, 2));
	
	ОписаниеТиповСтрока = СоздатьОписанияТипов("Строка", 254);
	СтрокиДекларацииНДС = Справочники.СтатьиНалоговыхДеклараций;
	
	ТаблицаКонтрагентов = Новый ТаблицаЗначений;
	ТаблицаКонтрагентов.Колонки.Добавить("Контрагент",		ОписаниеТиповСтрока);
	ТаблицаКонтрагентов.Колонки.Добавить("ИННКонтрагента",	СоздатьОписанияТипов("Строка",12));
	ТаблицаКонтрагентов.Колонки.Добавить("БазаНДС",			ОписаниеТиповЧисло);
	ТаблицаКонтрагентов.Колонки.Добавить("НДС",				ОписаниеТиповЧисло);
	ТаблицаКонтрагентов.Колонки.Добавить("НДС7",			ОписаниеТиповЧисло);
	ТаблицаКонтрагентов.Колонки.Добавить("БазаНДСБезНДС",   ОписаниеТиповЧисло);
	ТаблицаКонтрагентов.Колонки.Добавить("Дата");	
	
	Для Каждого СтатьяДекларации из МассивСтатей Цикл
		
		Отбор = Новый Структура;
		Отбор.Вставить(ИмяКолонки,СтатьяДекларации);
		НайденныеСтроки = Таблица.НайтиСтроки(Отбор);
		
		Для каждого строка Из НайденныеСтроки Цикл
			
			СтрокаТаб = ТаблицаКонтрагентов.Добавить();
			
			СтрокаТаб.Контрагент = СокрЛП(Строка.ИмяКонтрагента);
			Если ПустаяСтрока(СтрокаТаб.Контрагент) Тогда
				СтрокаТаб.Контрагент = "<Кінцевий споживач>";
			КонецЕсли;
			
			СтрокаТаб.ИННКонтрагента = Формат(Строка.ИННКонтрагента,"ЧГ=0");
			
			СтрокаТаб.БазаНДС = Строка.БазаНДСОборот;
			
			Если Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7 Тогда
				
				СтрокаТаб.НДС7 = Строка.НДСОборот;
				
			ИначеЕсли Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС20
				ИЛИ Строка.СтавкаНДС = Перечисления.СтавкиНДС.СпецСт8 Тогда //ИНАГРО				

				СтрокаТаб.НДС = Строка.НДСОборот;
				
			Иначе	
				
				СтрокаТаб.БазаНДСБезНДС = Строка.БазаНДСОборот;
				СтрокаТаб.БазаНДС = 0;
				
			КонецЕсли;
			
			//ИНАГРО ++
			Если (Признак = "НО") или (Строка.БазаНДСОборот <> 0 И Строка.НДСОборот = 0) Тогда
				
			Иначе				
				Если (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 1 Тогда
					R0107GA = R0107GA +  строка.БазаНДСОборот;
					R0107GB = R0107GB +  строка.НДСОборот;
				ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 2 Тогда
					R0207GA = R0207GA +  строка.БазаНДСОборот;
					R0207GB = R0207GB +  строка.НДСОборот;
				ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 3 Тогда
					R0307GA = R0307GA +  строка.БазаНДСОборот;
					R0307GB = R0307GB +  строка.НДСОборот;
					
				//Сумму НДС необходимо распределить по 3-м таблицам согласно коэффициентам
				ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 0 Тогда
					ОсталосьРаспределитьБазаНДСОборот = Строка.БазаНДСОборот;
					ОсталосьРаспределитьНДСОборот = Строка.НДСОборот;
					ОсталосьРаспределитьПроцентов = 100;
					//Таблица 1
					ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К1;
					Если ОсталосьРаспределитьПроцентов <=0 Тогда
						R0107GA = R0107GA + ОсталосьРаспределитьБазаНДСОборот;
						R0107GB = R0107GB + ОсталосьРаспределитьНДСОборот;
						ОсталосьРаспределитьБазаНДСОборот = 0;
						ОсталосьРаспределитьНДСОборот = 0;
					Иначе
						R0107GA = R0107GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
						R0107GB = R0107GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
						ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
						ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
					КонецЕсли;
					//Таблица 2
					ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К2;
					Если ОсталосьРаспределитьПроцентов <=0 Тогда
						R0207GA = R0207GA + ОсталосьРаспределитьБазаНДСОборот;
						R0207GB = R0207GB + ОсталосьРаспределитьНДСОборот;
						ОсталосьРаспределитьБазаНДСОборот = 0;
						ОсталосьРаспределитьНДСОборот = 0;
					Иначе
						R0207GA = R0207GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
						R0207GB = R0207GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
						ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
						ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
					КонецЕсли;
					//Таблица 3
					ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К3;
					Если ОсталосьРаспределитьПроцентов <=0 Тогда
						R0307GA = R0307GA + ОсталосьРаспределитьБазаНДСОборот;
						R0307GB = R0307GB + ОсталосьРаспределитьНДСОборот;
						ОсталосьРаспределитьБазаНДСОборот = 0;
						ОсталосьРаспределитьНДСОборот = 0;
					Иначе
						R0307GA = R0307GA + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
						R0307GB = R0307GB + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
						ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
						ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
					КонецЕсли;
					
				КонецЕсли;
			КонецЕсли;
			//ИНАГРО --
			
			ПериодКорректируемыхНН = "";	
			Если ЗначениеЗаполнено(Строка.ННизП2) Тогда
				СтрокаТаб.Дата = КонецМесяца(Строка.ДатаННизП2);
			КонецЕсли;
			
			Если (Признак = "НО") Тогда
				Если    Строка[ИмяКолонки] = СтрокиДекларацииНДС.НДС_НККорректировкаПропорциональноВклВКредитПоставкаОФ
					ИЛИ Строка[ИмяКолонки] = СтрокиДекларацииНДС.НДС_НККорректировкаПропорциональноНеВклВКредитПоставкаОФ Тогда
					
					R021G4 = R021G4 + Строка.БазаНДСОборот;		
					
					Если Строка.СтавкаНДС = Перечисления.СтавкиНДС.НДС7 Тогда
					Иначе	
						R021G5 = R021G5 + Строка.НДСОборот;		
					КонецЕсли;
				
				КонецЕсли;
				
			КонецЕсли;
			
		КонецЦикла; 		

	КонецЦикла; 		
		
	ТаблицаСоответствияИНН = ТаблицаКонтрагентов.Скопировать();
	ТаблицаСоответствияИНН.Свернуть("Контрагент,ИННКонтрагента");
	
	ТаблицаКонтрагентов.Колонки.Добавить("КонтрагентСпецКода");
	Для каждого Строка Из ТаблицаКонтрагентов Цикл
		Если Прав(Строка.ИННКонтрагента, 11) = "00000000000" Тогда
			Строка.КонтрагентСпецКода = Строка.Контрагент;
		КонецЕсли;
	КонецЦикла;
	
	ТаблицаКонтрагентов.Свернуть("ИННКонтрагента,Дата,КонтрагентСпецКода", "БазаНДС,НДС,НДС7,БазаНДСБезНДС");
	ТаблицаКонтрагентов.Сортировать("ИННКонтрагента,Дата");
	
	ТаблицаКонтрагентов.Колонки.Добавить("Контрагент");
	
	Отбор = Новый Структура;
	Для Каждого СтрокаТаблицыКонтрагентов Из ТаблицаКонтрагентов Цикл 
		 
		 Отбор.Вставить("ИННКонтрагента",СтрокаТаблицыКонтрагентов.ИннКонтрАгента);
		 
		 МассивКонтрагентов =  ТаблицаСоответствияИНН.НайтиСтроки(Отбор);
		 
		 НазванияКонтрагентов = "";
		 Для каждого Контрагент из МассивКонтрагентов Цикл
			 НазванияКонтрагентов = НазванияКонтрагентов + Символы.ПС + Контрагент.Контрагент;		 
		 КонецЦикла; 
		 НазванияКонтрагентов = Сред(НазванияКонтрагентов,2);
		 
		 СтрокаТаблицыКонтрагентов.Контрагент = НазванияКонтрагентов;
		 
		 Если ЗначениеЗаполнено(СтрокаТаблицыКонтрагентов.КонтрагентСпецКода) Тогда
		 	СтрокаТаблицыКонтрагентов.Контрагент = СтрокаТаблицыКонтрагентов.КонтрагентСпецКода;	
		 КонецЕсли;
		 
	КонецЦикла;		
	
	ВнестиИнфоВПриложение1(ТаблицаКонтрагентов, ИмяТаблицы);
	
КонецПроцедуры	

&НаСервере
Процедура ВнестиИнфоВПриложение1(Таблица,ИмяГруппы)
	
	перем СтруктураГруппы, ИсходноеКоличествоСтрокГруппы;

	ДанныеФормы 	= ЭтаФорма[ИмяГруппы];
	СтруктураГруппы = ДанныеФормыВЗначение(ДанныеФормы, Тип("ТаблицаЗначений"));
	мСтруктураИсхКолвоСтрокРазделов.Свойство(ИмяГруппы, ИсходноеКоличествоСтрокГруппы);
	
	ПрефиксИмениКолонки = ИмяГруппы+"XXXX";
	
	СчетчикСтрок = 0;
	Для каждого Строка Из Таблица Цикл
		
		// отдельно выделенные строки под условные ИНН для первой таблицы
		Если ИмяГруппы = СтруктураРеквизитовФормы.мИдГруппы1 Тогда

			Если    Строка.ИННКонтрагента = "100000000000"
				ИЛИ Строка.ИННКонтрагента = "200000000000" 
				ИЛИ Строка.ИННКонтрагента = "300000000000" 
				ИЛИ Строка.ИННКонтрагента = "400000000000" 
				ИЛИ Строка.ИННКонтрагента = "500000000000" 
				ИЛИ Строка.ИННКонтрагента = "600000000000" Тогда
								
				КодСтроки = "R001" + Лев(Строка.ИННКонтрагента, 1) + "G";
				
				СтруктураДанныхПриложение1[КодСтроки + "4"] = СтруктураДанныхПриложение1[КодСтроки + "4"] + Строка.БазаНДС;
				
				СтруктураДанныхПриложение1[КодСтроки + "5"] = СтруктураДанныхПриложение1[КодСтроки + "5"] + Строка.НДС;
				СтруктураДанныхПриложение1[КодСтроки + "6"] = СтруктураДанныхПриложение1[КодСтроки + "6"] + Строка.НДС7;
				СтруктураДанныхПриложение1[КодСтроки + "7"] = СтруктураДанныхПриложение1[КодСтроки + "7"] + Строка.БазаНДСБезНДС;

				Если НЕ Строка.БазаНДС = 0 Тогда
					_ДобавитьСтрокуРасшифровки(ЭтаФорма,КодСтроки + "4", "Показник ""Обсяг поставки (без ПДВ)"" графи ""Інші"" ("+Строка.ИННКонтрагента+") Додатку 1, Таблиці 1","+","" 						   + Строка.Контрагент, строка.БазаНДС,,,,,"Приложение1");
				КонецЕсли;
				Если НЕ Строка.НДС = 0 Тогда
					_ДобавитьСтрокуРасшифровки(ЭтаФорма,КодСтроки + "5", "Показник ""Сумма ПДВ, основна ставка"" графи ""Інші"" ("+Строка.ИННКонтрагента+") Додатку 1, ""Податкові зобов'язання""","+","" 				   + Строка.Контрагент, строка.НДС,,,,,"Приложение1");
				КонецЕсли;
				Если НЕ Строка.НДС7 = 0 Тогда
					_ДобавитьСтрокуРасшифровки(ЭтаФорма,КодСтроки + "6", "Показник ""Сумма ПДВ, ставка 7%"" графи ""Інші"" ("+Строка.ИННКонтрагента+") Додатку 1, Таблиці 1 ""Податкові зобов'язання""","+",""			   + Строка.Контрагент, строка.НДС7,,,,,"Приложение1");
				КонецЕсли;
				Если НЕ Строка.БазаНДСБезНДС = 0 Тогда
					_ДобавитьСтрокуРасшифровки(ЭтаФорма,КодСтроки + "7", "Показник ""Обсяг поставки по якій не нараховувався ПДВ"" графи ""Інші"" ("+Строка.ИННКонтрагента+") Додатку 1, Таблиці 1 ""Податкові зобов'язання""","+","" + Строка.Контрагент, строка.БазаНДСБезНДС,,,,,"Приложение1");
				КонецЕсли;
				
				Продолжить;
				
			КонецЕсли;	
				
			// нулевые корректировки не показываем в Приложении 1
			Если строка.НДС = 0 И строка.НДС7 = 0 И строка.БазаНДС = 0 И строка.БазаНДСБезНДС = 0 Тогда
				Продолжить;
			КонецЕсли;
				
		Иначе
			
			// нулевые корректирвки, в т.ч. от неплательщиков или по ставкам Без НДС - не показываем в Приложении 1
			Если строка.НДС = 0 И строка.НДС7 = 0 Тогда
				Продолжить;
			КонецЕсли;
			
		КонецЕсли;			
		
		Если СчетчикСтрок < ИсходноеКоличествоСтрокГруппы Тогда
			ДобавленнаяСтрока = СтруктураГруппы[СчетчикСтрок];
		Иначе
			ДобавленнаяСтрока = СтруктураГруппы.Добавить();	
		КонецЕсли;

		СчетчикСтрок = СчетчикСтрок + 1;

        ДобавленнаяСтрока[ПрефиксИмениКолонки+"G2"] = строка.ИННКонтрагента;
		
		ИмяКолонки = ПрефиксИмениКолонки+ "Kontragent";
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"Kontragent"] = строка.Контрагент;	
		
		Если ЗначениеЗаполнено(строка.Дата) Тогда
			ДобавленнаяСтрока[ПрефиксИмениКолонки+"G3A"] = Месяц(строка.Дата);
			ДобавленнаяСтрока[ПрефиксИмениКолонки+"G3B"] = Год(строка.Дата);
		КонецЕсли;
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G4"] = строка.БазаНДС;
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G5"] = строка.НДС;
		ДобавленнаяСтрока[ПрефиксИмениКолонки+"G6"] = строка.НДС7;
		
		Если ИмяГруппы = СтруктураРеквизитовФормы.мИдГруппы1 Тогда
			ДобавленнаяСтрока[ПрефиксИмениКолонки+"G7"] = строка.БазаНДСБезНДС;	
		КонецЕсли;
		
	КонецЦикла;	
	
	ЗначениеВРеквизитФормы(СтруктураГруппы, ИмяГруппы);
	
КонецПроцедуры 


&НаСервере
Процедура Заполнить(ПараметрыЗаполненияЗвит1С)

	Перем СтрокиДекларацииНДС;

 	Перем СтруктураГруппы;
	Перем СтруктураГруппы1,СтруктураГруппы1_2,СтруктураГруппы1_3,СтруктураГруппы1_4,СтруктураГруппы2,СтруктураГруппы2_2,СтруктураГруппы3;
	Перем СтруктураГруппы21;
	Перем СтруктураГруппы51,СтруктураГруппы52,СтруктураГруппы53;
	
	ТаблицаРасшифровки = Неопределено;
	Если СтруктураРеквизитовФормы.Свойство("АдресВременногоХранилищаРасшифровки") И ЗначениеЗаполнено(СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки) Тогда
		ТаблицаРасшифровки = ПолучитьИзВременногоХранилища(СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки);
	КонецЕсли;
	
	Если ТаблицаРасшифровки = Неопределено Тогда
		ТаблицаРасшифровки = Новый ТаблицаЗначений;
		ТаблицаРасшифровки.Колонки.Добавить("ИмяПоказателя");
		ТаблицаРасшифровки.Колонки.Добавить("НаименованиеПоказателя");
		ТаблицаРасшифровки.Колонки.Добавить("ЗнакОперации");
		ТаблицаРасшифровки.Колонки.Добавить("НаименованиеСлагаемого");
		ТаблицаРасшифровки.Колонки.Добавить("Сумма");
		ТаблицаРасшифровки.Колонки.Добавить("ИмяРаздела");
		ТаблицаРасшифровки.Колонки.Добавить("ДополнительныеПараметры");
	КонецЕсли;
	
	ТаблицаРасшифровки.Очистить();
	
	ОбщиеПараметрыРасшифровки = Новый Структура;
	ОбщиеПараметрыРасшифровки.Вставить("Организация", СтруктураРеквизитовФормы.Организация);
	ОбщиеПараметрыРасшифровки.Вставить("НачалоПериода", СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета);
	ОбщиеПараметрыРасшифровки.Вставить("КонецПериода", СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
	
	СтрокиДекларацииНДС = Справочники.СтатьиНалоговыхДеклараций;

	СтруктураОтбора = Новый Структура("Организация, СпецРежимНалогообложения", СтруктураРеквизитовФормы.Организация, СтруктураРеквизитовФормы.СпецРежим);
	ТаблицаКоэффициентов = РегистрыСведений.КоэффициентыПропорциональногоОтнесенияНДСНаКредит.СрезПоследних(СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета, СтруктураОтбора);
	Если ТаблицаКоэффициентов.Количество() = 0 Тогда
		мКоэффициентПропорциональногоНДС =  0;		
	Иначе
		мКоэффициентПропорциональногоНДС = ТаблицаКоэффициентов[0].Коэффициент;		
	КонецЕсли;
	
	КоличествоСтрокПриложения1 = Новый Структура;

	СтруктураДанныхДекларация.HZ = "X";
	СтруктураДанныхПриложение1.HZ = "X";
	СтруктураДанныхПриложение2.HZ = "X";
	СтруктураДанныхПриложение3.HZ = "X";
	СтруктураДанныхПриложение4.HZ = "X";
	СтруктураДанныхПриложение5.HZ = "X";
	СтруктураДанныхСправка.HZ = "X";
	СтруктураДанныхПриложение7.HZ = "X";
	СтруктураДанныхПриложение8.HZ = "X";
	СтруктураДанныхПриложение9.HZ = "X";
	СтруктураДанныхПриложение10.HZ = "X";

	Если РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
		ИмяРегистраНО = "НДСРеестрВыданныхНалоговыхДокументов";
		ИмяРегистраНК = "НДСРеестрПолученныхНалоговыхДокументов";
	Иначе
		ИмяРегистраНО = "НДСНалоговыеОбязательства";
		ИмяРегистраНК = "НДСНалоговыйКредит";
	КонецЕсли;
	
	//ИНАГРО ++
	Если СтруктураРеквизитовФормы.СпецРежим = 2 Или СтруктураРеквизитовФормы.СпецРежим = 3 Тогда
		ВнестиИнфоВПриложение9();
	КонецЕсли;
	//ИНАГРО --
	
	ИмяКолонкиНО  = "СтатьяДекларацииНДСНалоговыеОбязательства";
	ИмяКолонкиНК  = "СтатьяДекларацииНДСНалоговыйКредит";
	
	ВидОперацииЗКП =  "ВидыОперацийРегистрацияВходящегоНалоговогоДокумента";
	
	ИмяДокументаЗКП = "РегистрацияВходящегоНалоговогоДокумента";

	Если РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
		ТекстЗапросаНалоговыеОбва = "ВЫБРАТЬ
									
									|	НДСНалоговыеОбязательстваОбороты.Регистратор КАК Регистратор,
									|	НДСНалоговыеОбязательстваОбороты."+ИмяКолонкиНО+" КАК "+ИмяКолонкиНО+",
									|	НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Организация КАК Организация,
									|	НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Договор КАК ДоговорКонтрагента,
									
									|	МАКСИМУМ(НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Договор.МоментОпределенияБазыНДС) КАК МоментОпределенияПервогоСобытия,
									
									|	НДСНалоговыеОбязательстваОбороты.СтавкаНДС КАК СтавкаНДС,
									|	НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены КАК ПродажаНижеОбычнойЦены,
									
									|	МАКСИМУМ(ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.СпецРежимНалогообложения, 0)) КАК СпецРежимНалогообложения,
									
									|	МАКСИМУМ(НДСНалоговыеОбязательстваОбороты.Регистратор.Дата) КАК ПериодСоставленияНН,
									|   МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&УсловнаяПродажа) ТОГДА Истина ИНАЧЕ Ложь КОНЕЦ) КАК ЭтоУсловнаяПродажа,
									
									|	СУММА(НДСНалоговыеОбязательстваОбороты.СуммаБезНДС) КАК БазаНДСОборот,
									|	СУММА(НДСНалоговыеОбязательстваОбороты.СуммаНДС)     КАК НДСОборот,
									
									|	МАКСИМУМ(НАЧАЛОПЕРИОДА(НДСНалоговыеОбязательстваОбороты.Период, ДЕНЬ)) КАК Период,
									|	МАКСИМУМ(ВЫРАЗИТЬ(НДСНалоговыеОбязательстваОбороты.Регистратор.Комментарий КАК Строка(200))) КАК Комментарий,
									
									
									|	МАКСИМУМ(ВЫБОР КОГДА     НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная 
									|               ИЛИ НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной 
									|	    ТОГДА ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций) 
									|					  ТОГДА """"
									|					  ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент
									|			  КОНЕЦ 
									|		ИНАЧЕ НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Договор.Контрагент 
									|	КОНЕЦ) КАК Контрагент,
									
									|	МАКСИМУМ(ВЫБОР КОГДА  НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ИЛИ НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|					    ТОГДА 
									|							ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций)
									|                                   ТОГДА &НаименованиеОрганизации
									|								  КОГДА ЕстьNULL(ПОДСТРОКА(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИННПлательщикаНДС,1,1), """") = """" 
									|                                   ТОГДА ""Неплатник""
									|                                 ИНАЧЕ ВЫРАЗИТЬ(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.НаименованиеПолное КАК СТРОКА (200))
									|                            КОНЕЦ
									|					ИНАЧЕ ВЫРАЗИТЬ(НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Контрагент.НаименованиеПолное КАК СТРОКА(200)) 
									|			 КОНЕЦ) КАК	ИмяКонтрагента,			
									
									|	МАКСИМУМ(ВЫБОР КОГДА  НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ИЛИ НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|					    ТОГДА 
									|    					 ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.Дата < ДАТАВРЕМЯ(2016,04,01)
									|                          ТОГДА
									// ИНН контрагента определяем по правилам до 01.04.2016
									|								ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&УслугиОтНерезидента) ТОГДА
									|                              	   	ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.УслугиНерезидентаДляНехозДеят = Истина
									|                              	     	ТОГДА ""200000000000""
									|                              	         ИНАЧЕ ""500000000000""
									|                              	     КОНЕЦ
									|									  КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены, Ложь) = Истина
									|										ТОГДА &ИННОрганизации						
									|									  КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций)
									|                              	     ТОГДА ""400000000000""
									|									  КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная.ПоставкаДипПредставительству, НДСНалоговыеОбязательстваОбороты.Регистратор.ПоставкаДипПредставительству) = Истина И Регистратор.ТипПричиныНевыдачиПокупателю <= 2
									|                              	     ТОГДА ""400000000000""
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 7
									|                              	     ТОГДА ""300000000000""
									|									  КОГДА ЕстьNULL(ПОДСТРОКА(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИННПлательщикаНДС,1,1), """") = """" 
									|                              	     ТОГДА ""100000000000""
									|                              	   ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИННПлательщикаНДС
									|                            	КОНЕЦ
									//===============================================  
									|                         ИНАЧЕ
									// ИНН контрагента определяем по правилам после 01.04.2016, приказ 1307
									|								ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&УслугиОтНерезидента) 
									|                              	   		ТОГДА ""500000000000""
									|									  КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены, Ложь) = Истина
									|										ТОГДА &ИННОрганизации						
									|									  КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации = &СводнаяУсловнаяПродажа
									|                              	     	ТОГДА ""600000000000""
									|									  КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций)
									|                              	     	ТОГДА ВЫБОР КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная.Сводная, НДСНалоговыеОбязательстваОбороты.Регистратор.Сводная) Тогда ""600000000000"" ИНАЧЕ ""400000000000"" КОНЕЦ
									////|                              	    ТОГДА ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.Сводная Тогда ""600000000000"" ИНАЧЕ ""400000000000"" КОНЕЦ
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 1
									|                              	     	ТОГДА ""100000000000""
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 12
									|                              	     	ТОГДА ""200000000000""
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 7
									|                              	     	ТОГДА ""300000000000""
									|									  КОГДА ЕстьNULL(ПОДСТРОКА(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИННПлательщикаНДС,1,1), """") = """" 
									|                              	     	ТОГДА ""100000000000""
									|                              	   ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИННПлательщикаНДС
									|                            	КОНЕЦ
									//===============================================  
									|                         КОНЕЦ
									|					ИНАЧЕ НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Контрагент.ИННПлательщикаНДС 
									|			 КОНЕЦ) КАК	ИННКонтрагента,			
									|							
									
									|	МАКСИМУМ(ВЫБОР
									|		КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|			ТОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная
									|		ИНАЧЕ NULL
									|	КОНЕЦ) КАК ННизП2,
									
									|	МАКСИМУМ(ВЫБОР
									|		КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|			ТОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная.Дата, НДСНалоговыеОбязательстваОбороты.Регистратор.Дата)
									|		ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Дата
									|	КОНЕЦ) КАК ДатаННизП2,
									
									|	МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ТОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ЛьготаНДСОписание КОНЕЦ) КАК ОперацияД6,
									|	МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ТОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ЛьготаНДС КОНЕЦ) КАК СтатьяД6
									|	
									|ИЗ
									|	РегистрНакопления."+ИмяРегистраНО+" КАК НДСНалоговыеОбязательстваОбороты
									|ГДЕ
									|        НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Организация = &Организация
									|   И    НДСНалоговыеОбязательстваОбороты.Активность
									|   И    НДСНалоговыеОбязательстваОбороты.Период >= &НачДата
									|   И    НДСНалоговыеОбязательстваОбороты.Период <= &КонДата
									|	И НЕ ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.ВключаетсяВУточняющийРасчет, ЛОЖЬ)
									|	И    (   ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.СпецРежимНалогообложения, 0) = &СпецРежим
									//ИНАГРО ++
									//|		   ИЛИ ВЫБОР КОГДА &СпецРежим = 0 ТОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.СпецРежимНалогообложения, 0) = 7 ИНАЧЕ ЛОЖЬ КОНЕЦ)
									|		   ИЛИ ВЫБОР КОГДА &СпецРежим = 0 ТОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.СпецРежимНалогообложения, 0) = 7 ИНАЧЕ ЛОЖЬ КОНЕЦ ИЛИ НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены )
									//ИНАГРО --
									|СГРУППИРОВАТЬ ПО 
									|	НДСНалоговыеОбязательстваОбороты.Регистратор,
									|	НДСНалоговыеОбязательстваОбороты."+ИмяКолонкиНО+",
									|	НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Организация,
									|	НДСНалоговыеОбязательстваОбороты.АналитикаУчетаПоПартнерам.Договор,
									|	НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены,
									|	НДСНалоговыеОбязательстваОбороты.СтавкаНДС
									|";
									
		ТекстЗапросаНалоговыйКредит = "ВЫБРАТЬ
									  |	НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Организация,
									  |	НДСНалоговыйКредитОбороты." + ИмяКолонкиНК + ",
									  |	НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Договор,
									  |	НДСНалоговыйКредитОбороты.СтавкаНДС,
									  |	МАКСИМУМ(НАЧАЛОПЕРИОДА(НДСНалоговыйКредитОбороты.Период, ДЕНЬ)) КАК Период,
									  |	НДСНалоговыйКредитОбороты.Регистратор,
									  |	НДСНалоговыйКредитОбороты.Регистратор.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
									  |	НДСНалоговыйКредитОбороты.Регистратор.ДатаВходящегоДокумента КАК ПериодСоставленияНН,
									  
									  |	НДСНалоговыйКредитОбороты.Регистратор.Дата КАК Дата,
									  |	СУММА(НДСНалоговыйКредитОбороты.СуммаБезНДС) КАК БазаНДСОборот,
									  |	СУММА(НДСНалоговыйКредитОбороты.СуммаНДС) КАК НДСОборот,
									  
									  |	МАКСИМУМ(НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Договор.МоментОпределенияБазыНДС) КАК МоментОпределенияПервогоСобытия,
									  
  									  |	МАКСИМУМ(ВЫБОР КОГДА     НДСНалоговыйКредитОбороты.Регистратор ССЫЛКА Документ.РегистрацияВходящегоНалоговогоДокумента 
									  |	    ТОГДА ВЫБОР КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций) 
									  |					  ТОГДА """"
									  |					  ИНАЧЕ НДСНалоговыйКредитОбороты.Регистратор.Контрагент
									  |			  КОНЕЦ 
									  |		ИНАЧЕ НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Договор.Контрагент 
									  |	КОНЕЦ) КАК Контрагент,
									  |	МАКСИМУМ(ВЫРАЗИТЬ(НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Контрагент.НаименованиеПолное КАК СТРОКА(1000))) КАК ИмяКонтрагента,
									  
									  //|	НДСНалоговыйКредитОбороты.ДоговорКонтрагента.Владелец.ИНН КАК ИННКонтрагента,
									  | МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = &ЗКПРаботыОтНерезидента
									  |		ТОГДА ""500000000000""
									  | ИНАЧЕ НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Контрагент.ИННПлательщикаНДС
									  | КОНЕЦ) КАК ИННКонтрагента,
									  
									  | НДСНалоговыйКредитОбороты.Регистратор.ДатаВходящегоДокумента  КАК ДатаНН,
									  |	МАКСИМУМ(ВЫБОР
									  |		КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиВозврат)
									  |				ИЛИ НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиКорректировка)
									  |			ТОГДА ""КорректируемаяНН""
									  |		ИНАЧЕ NULL
									  |	КОНЕЦ) КАК ННизП2,
									  |	МАКСИМУМ(ВЫБОР
									  |		КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиВозврат)
									  |				ИЛИ НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиКорректировка)
									  |			ТОГДА НДСНалоговыйКредитОбороты.Регистратор.ДатаКорректируемогоВходящегоДокумента
									  |		ИНАЧЕ NULL
									  |	КОНЕЦ) КАК ДатаННизП2,
									  |	МАКСИМУМ(ВЫБОР
									  |		КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".ВосстановлениеНалоговогоКредита)
								      |		ТОГДА ИСТИНА
									  |		ИНАЧЕ ЛОЖЬ
									  |	КОНЕЦ) КАК ЭтоВосстановлениеНалоговогоКредита
									  |
									  |ИЗ
									  |РегистрНакопления."+ИмяРегистраНК+" КАК НДСНалоговыйКредитОбороты
									  |ГДЕ
									  |        НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Организация = &Организация
									  |   И    НДСНалоговыйКредитОбороты.Активность
									  |   И    НДСНалоговыйКредитОбороты.Период >= &НачДата
									  |   И    НДСНалоговыйКредитОбороты.Период <= &КонДата
									  |	И НЕ ЕстьNULL(НДСНалоговыйКредитОбороты.Регистратор.ВключаетсяВУточняющийРасчет, ЛОЖЬ)
									  |	И ЕстьNULL(НДСНалоговыйКредитОбороты.Регистратор.СпецРежимНалогообложения, 0) = &СпецРежим
									  |СГРУППИРОВАТЬ ПО 
									  |	НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Организация,
									  |	НДСНалоговыйКредитОбороты." + ИмяКолонкиНК + ",
									  |	НДСНалоговыйКредитОбороты.АналитикаУчетаПоПартнерам.Договор,
									  |	НДСНалоговыйКредитОбороты.СтавкаНДС,
									  |	НАЧАЛОПЕРИОДА(НДСНалоговыйКредитОбороты.Период, ДЕНЬ),
									  |	НДСНалоговыйКредитОбороты.Регистратор
									  |";
									  
	Иначе
		ТекстЗапросаНалоговыеОбва = "ВЫБРАТЬ
									
									|	НДСНалоговыеОбязательстваОбороты.Регистратор КАК Регистратор,
									|	НДСНалоговыеОбязательстваОбороты."+ИмяКолонкиНО+" КАК "+ИмяКолонкиНО+",
									|	НДСНалоговыеОбязательстваОбороты.Организация КАК Организация,
									|	НДСНалоговыеОбязательстваОбороты.ДоговорКонтрагента КАК ДоговорКонтрагента,
									
									|	МАКСИМУМ(НДСНалоговыеОбязательстваОбороты.ДоговорКонтрагента.СхемаНалоговогоУчета.МоментОпределенияБазыНДСПоПродажам) КАК МоментОпределенияПервогоСобытия,
									
									|	НДСНалоговыеОбязательстваОбороты.СтавкаНДС КАК СтавкаНДС,
									|	НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены КАК ПродажаНижеОбычнойЦены,
									
									|	МАКСИМУМ(ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.СпецРежимНалогообложения, 0)) КАК СпецРежимНалогообложения,
									
									|	МАКСИМУМ(НДСНалоговыеОбязательстваОбороты.Регистратор.Дата) КАК ПериодСоставленияНН,
									|   МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&УсловнаяПродажа) ТОГДА Истина ИНАЧЕ Ложь КОНЕЦ) КАК ЭтоУсловнаяПродажа,
									
									|	СУММА(НДСНалоговыеОбязательстваОбороты.БазаНДС) КАК БазаНДСОборот,
									|	СУММА(НДСНалоговыеОбязательстваОбороты.НДС)     КАК НДСОборот,
									
									|	МАКСИМУМ(НАЧАЛОПЕРИОДА(НДСНалоговыеОбязательстваОбороты.Период, ДЕНЬ)) КАК Период,
									|	МАКСИМУМ(ВЫРАЗИТЬ(НДСНалоговыеОбязательстваОбороты.Регистратор.Комментарий КАК Строка(200))) КАК Комментарий,
									
									
									|	МАКСИМУМ(ВЫБОР КОГДА     НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная 
									|               ИЛИ НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной 
									|	    ТОГДА ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций) 
									|					  ТОГДА """"
									|					  ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент
									|			  КОНЕЦ 
									|		ИНАЧЕ НДСНалоговыеОбязательстваОбороты.ДоговорКонтрагента.Владелец 
									|	КОНЕЦ) КАК Контрагент,
									
									|	МАКСИМУМ(ВЫБОР КОГДА  НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ИЛИ НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|					    ТОГДА 
									|							ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций)
									|                                   ТОГДА &НаименованиеОрганизации
									|								  КОГДА ЕстьNULL(ПОДСТРОКА(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИНН,1,1), """") = """" 
									|                                   ТОГДА ""Неплатник""
									|                                 ИНАЧЕ ВЫРАЗИТЬ(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.НаименованиеПолное КАК СТРОКА (200))
									|                            КОНЕЦ
									|					ИНАЧЕ ВЫРАЗИТЬ(НДСНалоговыеОбязательстваОбороты.ДоговорКонтрагента.Владелец.НаименованиеПолное КАК СТРОКА(200)) 
									|			 КОНЕЦ) КАК	ИмяКонтрагента,			
									
									|	МАКСИМУМ(ВЫБОР КОГДА  НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ИЛИ НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|					    ТОГДА 
									|    					 ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.Дата < ДАТАВРЕМЯ(2016,04,01)
									|                          ТОГДА
									// ИНН контрагента определяем по правилам до 01.04.2016
									|								ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&УслугиОтНерезидента) ТОГДА
									|                              	   	ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.УслугиНерезидентаДляНехозДеят = Истина
									|                              	     	ТОГДА ""200000000000""
									|                              	         ИНАЧЕ ""500000000000""
									|                              	     КОНЕЦ
									|									  КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены, Ложь) = Истина
									|										ТОГДА &ИННОрганизации						
									|									  КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций)
									|                              	     ТОГДА ""400000000000""
									|									  КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная.ПоставкаДипПредставительству, НДСНалоговыеОбязательстваОбороты.Регистратор.ПоставкаДипПредставительству) = Истина И Регистратор.ТипПричиныНевыдачиПокупателю <= 2
									|                              	     ТОГДА ""400000000000""
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 7
									|                              	     ТОГДА ""300000000000""
									|									  КОГДА ЕстьNULL(ПОДСТРОКА(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИНН,1,1), """") = """" 
									|                              	     ТОГДА ""100000000000""
									|                              	   ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИНН
									|                            	КОНЕЦ
									//===============================================  
									|                         ИНАЧЕ
									// ИНН контрагента определяем по правилам после 01.04.2016, приказ 1307
									|								ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&УслугиОтНерезидента) 
									|                              	   		ТОГДА ""500000000000""
									|									  КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены, Ложь) = Истина
									|										ТОГДА &ИННОрганизации						
									|									  КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ВидОперации В (&ОсобыеВидыОпераций)
									|                              	     	ТОГДА ВЫБОР КОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная.Сводная, НДСНалоговыеОбязательстваОбороты.Регистратор.Сводная) Тогда ""600000000000"" ИНАЧЕ ""400000000000"" КОНЕЦ
									////|                              	    ТОГДА ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.Сводная Тогда ""600000000000"" ИНАЧЕ ""400000000000"" КОНЕЦ
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 1
									|                              	     	ТОГДА ""100000000000""
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 12
									|                              	     	ТОГДА ""200000000000""
									|									  КОГДА Регистратор.ТипПричиныНевыдачиПокупателю = 7
									|                              	     	ТОГДА ""300000000000""
									|									  КОГДА ЕстьNULL(ПОДСТРОКА(НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИНН,1,1), """") = """" 
									|                              	     	ТОГДА ""100000000000""
									|                              	   ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Контрагент.ИНН
									|                            	КОНЕЦ
									//===============================================  
									|                         КОНЕЦ
									|					ИНАЧЕ НДСНалоговыеОбязательстваОбороты.ДоговорКонтрагента.Владелец.ИНН 
									|			 КОНЕЦ) КАК	ИННКонтрагента,			
									|							
									
									|	МАКСИМУМ(ВЫБОР
									|		КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|			ТОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная
									|		ИНАЧЕ NULL
									|	КОНЕЦ) КАК ННизП2,
									
									|	МАКСИМУМ(ВЫБОР
									|		КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.Приложение2КНалоговойНакладной
									|			ТОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.НалоговаяНакладная.Дата, НДСНалоговыеОбязательстваОбороты.Регистратор.Дата)
									|		ИНАЧЕ НДСНалоговыеОбязательстваОбороты.Регистратор.Дата
									|	КОНЕЦ) КАК ДатаННизП2,
									
									|	МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ТОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ЛьготаНДСОписание КОНЕЦ) КАК ОперацияД6,
									|	МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыеОбязательстваОбороты.Регистратор ССЫЛКА Документ.НалоговаяНакладная ТОГДА НДСНалоговыеОбязательстваОбороты.Регистратор.ЛьготаНДС КОНЕЦ) КАК СтатьяД6
									|	
									|ИЗ
									|	РегистрНакопления."+ИмяРегистраНО+" КАК НДСНалоговыеОбязательстваОбороты
									|ГДЕ
									|        НДСНалоговыеОбязательстваОбороты.Организация = &Организация
									|   И    НДСНалоговыеОбязательстваОбороты.Активность
									|   И    НДСНалоговыеОбязательстваОбороты.Период >= &НачДата
									|   И    НДСНалоговыеОбязательстваОбороты.Период <= &КонДата
									|	И НЕ ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.ВключаетсяВУточняющийРасчет, ЛОЖЬ)
									|	И    (   ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.СпецРежимНалогообложения, 0) = &СпецРежим
							  		|		   ИЛИ ВЫБОР КОГДА &СпецРежим = 0 ТОГДА ЕстьNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.СпецРежимНалогообложения, 0) = 7 ИНАЧЕ ЛОЖЬ КОНЕЦ)
									|СГРУППИРОВАТЬ ПО 
									|	НДСНалоговыеОбязательстваОбороты.Регистратор,
									|	НДСНалоговыеОбязательстваОбороты."+ИмяКолонкиНО+",
									|	НДСНалоговыеОбязательстваОбороты.Организация,
									|	НДСНалоговыеОбязательстваОбороты.ДоговорКонтрагента,
									|	НДСНалоговыеОбязательстваОбороты.ПродажаНижеОбычнойЦены,
									|	НДСНалоговыеОбязательстваОбороты.СтавкаНДС
									|";
									
		ТекстЗапросаНалоговыйКредит = "ВЫБРАТЬ
									  |	НДСНалоговыйКредитОбороты.Организация,
									  |	НДСНалоговыйКредитОбороты." + ИмяКолонкиНК + ",
									  |	НДСНалоговыйКредитОбороты.ДоговорКонтрагента,
									  |	НДСНалоговыйКредитОбороты.СтавкаНДС,
									  |	МАКСИМУМ(НАЧАЛОПЕРИОДА(НДСНалоговыйКредитОбороты.Период, ДЕНЬ)) КАК Период,
									  |	НДСНалоговыйКредитОбороты.Регистратор,
									  |	НДСНалоговыйКредитОбороты.Регистратор.ДатаВходящегоДокумента КАК ДатаВходящегоДокумента,
									  |	НДСНалоговыйКредитОбороты.Регистратор.ДатаВходящегоДокумента КАК ПериодСоставленияНН,
									  
									  |	НДСНалоговыйКредитОбороты.Регистратор.Дата КАК Дата,
									  |	СУММА(НДСНалоговыйКредитОбороты.БазаНДС) КАК БазаНДСОборот,
									  |	СУММА(НДСНалоговыйКредитОбороты.НДС) КАК НДСОборот,
									  
									  |	МАКСИМУМ(НДСНалоговыйКредитОбороты.ДоговорКонтрагента.СхемаНалоговогоУчета.МоментОпределенияБазыНДСПоПродажам) КАК МоментОпределенияПервогоСобытия,
									  
									  |	НДСНалоговыйКредитОбороты.ДоговорКонтрагента.Владелец КАК Контрагент,
									  |	МАКСИМУМ(ВЫРАЗИТЬ(НДСНалоговыйКредитОбороты.ДоговорКонтрагента.Владелец.НаименованиеПолное КАК СТРОКА(1000))) КАК ИмяКонтрагента,
									  
									  //|	НДСНалоговыйКредитОбороты.ДоговорКонтрагента.Владелец.ИНН КАК ИННКонтрагента,
									  | МАКСИМУМ(ВЫБОР КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = &ЗКПРаботыОтНерезидента
									  |		ТОГДА ""500000000000""
									  | ИНАЧЕ НДСНалоговыйКредитОбороты.ДоговорКонтрагента.Владелец.ИНН
									  | КОНЕЦ) КАК ИННКонтрагента,
									  
									  | НДСНалоговыйКредитОбороты.Регистратор.ДатаВходящегоДокумента  КАК ДатаНН,
									  |	МАКСИМУМ(ВЫБОР
									  |		КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиВозврат)
									  |				ИЛИ НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиКорректировка)
									  |			ТОГДА ""КорректируемаяНН""
									  |		ИНАЧЕ NULL
									  |	КОНЕЦ) КАК ННизП2,
									  |	МАКСИМУМ(ВЫБОР
									  |		КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиВозврат)
									  |				ИЛИ НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".РасчетКорректировкиКорректировка)
									  |			ТОГДА НДСНалоговыйКредитОбороты.Регистратор.ДатаКорректируемогоВходящегоДокумента
									  |		ИНАЧЕ NULL
									  |	КОНЕЦ) КАК ДатаННизП2,
									  |	МАКСИМУМ(ВЫБОР
									  |		КОГДА НДСНалоговыйКредитОбороты.Регистратор.ВидОперации = ЗНАЧЕНИЕ(Перечисление." + ВидОперацииЗКП + ".ВосстановлениеНалоговогоКредита)
								      |		ТОГДА ИСТИНА
									  |		ИНАЧЕ ЛОЖЬ
									  |	КОНЕЦ) КАК ЭтоВосстановлениеНалоговогоКредита
									  |
									  |ИЗ
									  |РегистрНакопления."+ИмяРегистраНК+" КАК НДСНалоговыйКредитОбороты
									  |ГДЕ
									  |        НДСНалоговыйКредитОбороты.Организация = &Организация
									  |   И    НДСНалоговыйКредитОбороты.Активность
									  |   И    НДСНалоговыйКредитОбороты.Период >= &НачДата
									  |   И    НДСНалоговыйКредитОбороты.Период <= &КонДата
									  |	И НЕ ЕстьNULL(НДСНалоговыйКредитОбороты.Регистратор.ВключаетсяВУточняющийРасчет, ЛОЖЬ)
									  |	И ЕстьNULL(НДСНалоговыйКредитОбороты.Регистратор.СпецРежимНалогообложения, 0) = &СпецРежим
									  |СГРУППИРОВАТЬ ПО 
									  |	НДСНалоговыйКредитОбороты.Организация,
									  |	НДСНалоговыйКредитОбороты." + ИмяКолонкиНК + ",
									  |	НДСНалоговыйКредитОбороты.ДоговорКонтрагента,
									  |	НДСНалоговыйКредитОбороты.СтавкаНДС,
									  |	НАЧАЛОПЕРИОДА(НДСНалоговыйКредитОбороты.Период, ДЕНЬ),
									  |	НДСНалоговыйКредитОбороты.Регистратор
									  |";
									  
  	КонецЕсли;
	Запрос = Новый Запрос;
	
	Запрос.УстановитьПараметр ("НачДата",СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета);
	Запрос.УстановитьПараметр ("СпецРежим",СтруктураРеквизитовФормы.СпецРежим);

	Если СтруктураРеквизитовФормы.ОтчетЗаДваМесяца Тогда
		Запрос.УстановитьПараметр ("НачДата",ДобавитьМесяц(СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета, -1));	
	КонецЕсли;

	Запрос.УстановитьПараметр ("КонДата",СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
	
	Запрос.УстановитьПараметр ("Организация",СтруктураРеквизитовФормы.Организация);
	
	Запрос.УстановитьПараметр("НаименованиеОрганизации", Лев(СокрЛП(СтруктураРеквизитовФормы.Организация.НаименованиеПолное), 200));
	Запрос.УстановитьПараметр("ИННОрганизации",			 СтруктураДанныхДекларация.HNPDV);
	Запрос.УстановитьПараметр("ЗКПРаботыОтНерезидента",  Перечисления[ВидОперацииЗКП].РаботыОтНерезидентаПрошлогоПериода);
	Если РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
		Запрос.УстановитьПараметр("СводнаяУсловнаяПродажа",  Перечисления.ВидыОперацийНалоговыхДокументов.СводнаяУсловнаяПродажа);
	КонецЕсли;
	
	ТекстЗапросаНалоговыеОбва = СтрЗаменить(ТекстЗапросаНалоговыеОбва, "//#ЭтоБП", "");
	Запрос.УстановитьПараметр("ВалютаРеглУчета", Константы.ВалютаРегламентированногоУчета.Получить());
	
	Если РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
		ОсобыеОперации = Новый Массив();
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийНалоговыхДокументов.УсловнаяПродажа);
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийНалоговыхДокументов.СводнаяУсловнаяПродажа);
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийНалоговыхДокументов.РаботыОтНерезидента);
		Запрос.УстановитьПараметр ("ОсобыеВидыОпераций",ОсобыеОперации);
		
		УсловнаяПродажа = Новый Массив();
		УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийНалоговыхДокументов.УсловнаяПродажа);
		УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийНалоговыхДокументов.СводнаяУсловнаяПродажа);
		Запрос.УстановитьПараметр ("УсловнаяПродажа", УсловнаяПродажа);
		
		УслугиОтНерезидента = Новый Массив();
		УслугиОтНерезидента.Добавить(Перечисления.ВидыОперацийНалоговыхДокументов.РаботыОтНерезидента);
		Запрос.УстановитьПараметр ("УслугиОтНерезидента",УслугиОтНерезидента);
			
	Иначе	
		ОсобыеОперации = Новый Массив();
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.УсловнаяПродажа);
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.УсловнаяПродажаСписаниеОС);	  
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.РаботыОтНерезидента);
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийПриложение2КНалоговойНакладной.РаботыОтНерезидентаКорректировка);
		ОсобыеОперации.Добавить(Перечисления.ВидыОперацийПриложение2КНалоговойНакладной.УсловнаяПродажаВозврат);
		Запрос.УстановитьПараметр ("ОсобыеВидыОпераций",ОсобыеОперации);
		
		УсловнаяПродажа = Новый Массив();
		УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.УсловнаяПродажа);
		УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.УсловнаяПродажаСписаниеОС);
		УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийПриложение2КНалоговойНакладной.УсловнаяПродажаВозврат);
		Запрос.УстановитьПараметр ("УсловнаяПродажа", УсловнаяПродажа);
		
		
		УслугиОтНерезидента = Новый Массив();
		УслугиОтНерезидента.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.РаботыОтНерезидента);
		УслугиОтНерезидента.Добавить(Перечисления.ВидыОперацийПриложение2КНалоговойНакладной.РаботыОтНерезидентаКорректировка);
		Запрос.УстановитьПараметр ("УслугиОтНерезидента",УслугиОтНерезидента);
	КонецЕсли;
	
	Запрос.Текст = ТекстЗапросаНалоговыеОбва;
    ТаблицаРезультатов = Запрос.Выполнить().Выгрузить();
	
	//І. Податкові зобов'язання 
	// ст. 1 и 4 и приложение 5 (1-я таблица)
	R11GA = 0;
	R11GB = 0;
	R12GA = 0;
	R12GB = 0;
	
	R41GA = 0;
	R41GB = 0;
	R42GA = 0;
	R42GB = 0;

	// Поставка ОС в приложении 5, табл.  
	R011G4 = 0;
	R011G5 = 0;
	
	// пропорциональные НДС из ГТД должен отражать в 11 строке
	R111GA = 0;
	R111GB = 0;
	R112GA = 0;
	R112GB = 0;
	
	//ИНАГРО ++ 
	R01061GA = 0;
	R01061GB = 0;
	R02061GA = 0;
	R02061GB = 0;
	R03061GA = 0;
	R03061GB = 0;
	
	R01062GA = 0;
	R01062GB = 0;
	R02062GA = 0;
	R02062GB = 0;
	R03062GA = 0;
	R03062GB = 0;
	//ИНАГРО -- 
	
	МассивНужныхСтатей = Новый Массив; 
	МассивНужныхСтатей.Добавить(СтрокиДекларацииНДС.НДС_НОПоСтавке20);
	МассивНужныхСтатей.Добавить(СтрокиДекларацииНДС.НДС_НОПоСтавке20ПоставкаОФ);
	
	ПодготовитьДанныеДляПриложения5ВРазрезеКонтрагентов(ТаблицаРезультатов,МассивНужныхСтатей,ИмяКолонкиНО,СтруктураРеквизитовФормы.мИдГруппы51);
	
	СтруктураДанныхДекларация.R11GA = R11GA;
	СтруктураДанныхДекларация.R12GA = R12GA;
	СтруктураДанныхДекларация.R11GB = R11GB;
	СтруктураДанныхДекларация.R12GB = R12GB;
	
	СтруктураДанныхДекларация.R41GA = R41GA;
	СтруктураДанныхДекларация.R42GA = R42GA;
	СтруктураДанныхДекларация.R41GB = R41GB;
	СтруктураДанныхДекларация.R42GB = R42GB;
	
	СтруктураДанныхПриложение5.R011G4 = R011G4;
	СтруктураДанныхПриложение5.R011G5 = R011G5;
	
	// 2
	//експортні операції							
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НОПоСтавке0Экспорт;
	R20GA = 0;
	РасчетПоСтатье(НужнаяСтатья,R20GA,0,"R20GA","",1);
	
	// 3	
	//інші операції, що оподатковуються за нульовою ставкою:
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НОПоСтавке0Другие;
	R30GA = 0;
	РасчетПоСтатье(НужнаяСтатья,R30GA,0,"R30GA","",1);
	
	// 5 
	//Операції, що не є об'єктом оподаткування и другие без НДС-ные операции
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НОНеОбъектНалог;
	ПодготовитьДанныеДляСправки(ТаблицаРезультатов,ИмяКолонкиНО,НужнаяСтатья,СтруктураРеквизитовФормы.мИдГруппыС1);
	
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НОУслугиВнеУкраины;
	ПодготовитьДанныеДляСправки(ТаблицаРезультатов,ИмяКолонкиНО,НужнаяСтатья,СтруктураРеквизитовФормы.мИдГруппыС2);
	
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НООсвобожден;
	ПодготовитьДанныеДляСправки(ТаблицаРезультатов,ИмяКолонкиНО,НужнаяСтатья,СтруктураРеквизитовФормы.мИдГруппыС3);
	
	//Роботи (послуги), отримані від нерезидента на митній території України
	R60GA = 0;
	R60GB = 0;
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НОНерезидентУслуги;
	РасчетПоСтатье(НужнаяСтатья,R60GA,R60GB,"R60GA","R60GB",1);
	
	// 8 + ПРИЛОЖЕНИЕ 1
	МассивСтатей = Новый Массив;
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НОИзменениеСтоимости);
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НОКорректировкаТрансфЦенообразование);
	ПодготовитьДанныеДляПриложения1ВРазрезеКонтрагентов(ТаблицаРезультатов,ИмяКолонкиНО,МассивСтатей,"НО");
	
	// 8
	//нецільове використання товарів, ввезених у пільговому режимі	
	R80GA = 0;
	R80GB = 0;
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НОКорректировкаНецелевоеИсп;
	РасчетПоСтатье(НужнаяСтатья,R80GA,R80GB,"R80GA","R80GB",1);
	
	
	//////////////////////////////////////////////////////////////////
	//////////////////////////////////////////////////////////////////
	//налоговий кредит
	
	Запрос.Текст = ТекстЗапросаНалоговыйКредит;
	ТаблицаРезультатов = Запрос.Выполнить().Выгрузить();
	
	//10
	R101GA = 0;
	R101GB = 0;
	R102GA = 0;
	R102GB = 0;
	
	R103GA = 0;
	
	R021G4 = 0;
	R021G5 = 0;
	
	//ИНАГРО++
    R01051GA = 0;
	R01051GB = 0;
    R02051GA = 0;
	R02051GB = 0;
    R03051GA = 0;
	R03051GB = 0;

    R01052GA = 0;
	R01052GB = 0;
    R02052GA = 0;
	R02052GB = 0;
    R03052GA = 0;
	R03052GB = 0;
	//ИНАГРО--

	
	МассивНужныхСтатейНК = Новый Массив; 
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаСНДСвВРОблаг);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаСНДСвВРОблагПриобрОФ);
	
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаСНДСвВРНеОблаг);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаСНДСвВРНеОблагУслугВнеУкраины);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаСНДСнеВР_);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПропорциональноНеВклВКредит);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПропорциональноНеВклВКредитПоставкаОФ);
	
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаБезНДСвВРОблаг);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаБезНДСвВРНеОблаг);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаБезНДСвВРНеОблагУслугВнеУкраины);
	
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПокупкаБезНДСнеВР_);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПропорциональноВклВКредит);
	МассивНужныхСтатейНК.Добавить(СтрокиДекларацииНДС.НДС_НКПропорциональноВклВКредитПоставкаОФ);
	
	ПодготовитьДанныеДляПриложения5ВРазрезеКонтрагентов(ТаблицаРезультатов,МассивНужныхСтатейНК,ИмяКолонкиНК,СтруктураРеквизитовФормы.мИдГруппы52);
	
	СтруктураДанныхДекларация.R101GA =  R101GA;
	СтруктураДанныхДекларация.R101GB =  R101GB;
	СтруктураДанныхДекларация.R102GA =  R102GA;
	СтруктураДанныхДекларация.R102GB =  R102GB;
	
	СтруктураДанныхДекларация.R103GA =  R103GA;
	
	СтруктураДанныхПриложение5.R021G4 = R021G4; 
	СтруктураДанныхПриложение5.R021G5 = R021G5; 
	
	//11 ПДВ, сплачений митним органам
	//R111GA = 0;
	//R111GB = 0;
	МассивСтатей = Новый Массив;
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРОблагНДСТамож);
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРОблагБезНДС);
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРНеОблагНеОбъектНДСТамож);
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРНеОблагНеОбъектНДСТаможУслугВнеУкраины);
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРНеОблагНеОбъектБезНДС);
	МассивСтатей.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРНеОблагНеОбъектБезНДСУслугВнеУкраины);
	РасчетПоСтатье(МассивСтатей,R111GA,R111GB,"R111GA","R111GB",0);
	
	//ИНАГРО ++
	РасчетПоСтатьеПриложение10(МассивСтатей,R01061GA,R02061GA,R03061GA,R01061GB, R02061GB,R03061GB,"R01061GA","R02061GA","R03061GA", "R01061GB", "R02061GB", "R03061GB", 0);
	//ИНАГРО --

	
	//R112GA = 0;
	//R112GB = 0;
	ДопСтруктураПоиска = Новый Структура();
	ДопСтруктураПоиска.Вставить("СтавкаНДС", Перечисления.СтавкиНДС.НДС7);
	РасчетПоСтатье(МассивСтатей,R112GA,R112GB,"R112GA","R112GB",0, ДопСтруктураПоиска);
	
	//ИНАГРО ++
	РасчетПоСтатьеПриложение10(МассивСтатей,R01062GA,R02062GA,R03062GA,R01062GB, R02062GB,R03062GB,"R01062GA","R02062GA","R03062GA", "R01062GB", "R02062GB", "R03062GB", 0, ДопСтруктураПоиска);
	//ИНАГРО --

	// учтем операции по 7%
	СтруктураДанныхДекларация["R111GA"] = СтруктураДанныхДекларация["R111GA"] - СтруктураДанныхДекларация["R112GA"];
	СтруктураДанныхДекларация["R111GB"] = СтруктураДанныхДекларация["R111GB"] - СтруктураДанныхДекларация["R112GB"];
	
	//ИНАГРО ++
	СтруктураДанныхПриложение10["R01061GA"] = СтруктураДанныхПриложение10["R01061GA"] - СтруктураДанныхПриложение10["R01062GA"];
	СтруктураДанныхПриложение10["R01061GB"] = СтруктураДанныхПриложение10["R01061GB"] - СтруктураДанныхПриложение10["R01062GB"];
	СтруктураДанныхПриложение10["R02061GA"] = СтруктураДанныхПриложение10["R02061GA"] - СтруктураДанныхПриложение10["R02062GA"];
	СтруктураДанныхПриложение10["R02061GB"] = СтруктураДанныхПриложение10["R02061GB"] - СтруктураДанныхПриложение10["R02062GB"];
	СтруктураДанныхПриложение10["R03061GA"] = СтруктураДанныхПриложение10["R03061GA"] - СтруктураДанныхПриложение10["R03062GA"];
	СтруктураДанныхПриложение10["R03061GB"] = СтруктураДанныхПриложение10["R03061GB"] - СтруктураДанныхПриложение10["R03062GB"];
	//ИНАГРО --		
	
	//11.3	погашені податкові векселі, що дають право на збільшення податкового кредиту в 
	//поточному звітному періоді							
	R113GA = 0;
	R113GB = 0;
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НКИмпортВРОблагВексель;
	РасчетПоСтатье(НужнаяСтатья,R113GA,R113GB,"R113GA","R113GB",0);
	
	//11.4	роботи (послуги), отримані від нерезидента							
	R114GA = 0;
	R114GB = 0;
	
	//ИНАГРО ++
	R01063GA = 0;
	R01063GB = 0;
	R02063GA = 0;
	R02063GB = 0;
	R03063GA = 0;
	R03063GB = 0;
	//ИНАГРО --

	НужнаяСтатья = Новый Массив;
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРОблагУслугиНерезидента);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРНеОблагНеОбъектУслугиНерезидента);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НКИмпортВРНеОблагНеОбъектУслугиНерезидентаУслугВнеУкраины);
	РасчетПоСтатье(НужнаяСтатья,R114GA,R114GB,"R114GA","R114GB",0);
	
	//ИНАГРО ++
	РасчетПоСтатьеПриложение10(НужнаяСтатья,R01063GA,R02063GA,R03063GA, R01063GB, R02063GB, R03063GB,"R01063GA","R02063GA", "R03063GA", "R01063GB","R02063GB","R03063GB", 0);
	//ИНАГРО --

	//12 
	// корректировка налогового кредита
	R021G4 = 0;
	R021G5 = 0;
		
	//ИНАГРО ++
	R0107GA = 0;
	R0107GB = 0;
	R0207GA = 0;
	R0207GB = 0;
	R0307GA = 0;
	R0307GB = 0;
	//ИНАГРО --

	НужнаяСтатья = Новый Массив;
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НКИзменениеСтоимости);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НКИзменениеСтоимостиБезНК);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаБезНК);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаБезНКНеХоз);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаБезНКДляУслугВнеУкраины);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаПропорциональноВклВКредит);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаПропорциональноВклВКредитПоставкаОФ);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаПропорциональноНеВклВКредит);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаПропорциональноНеВклВКредитПоставкаОФ);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаТрансфЦенообразование);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаВосстановлениеКредита);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаВосстановлениеКредитаПропорциональноВклВКредит);
	НужнаяСтатья.Добавить(СтрокиДекларацииНДС.НДС_НККорректировкаВосстановлениеКредитаПропорциональноНеВклВКредит);
	
	ПодготовитьДанныеДляПриложения1ВРазрезеКонтрагентов(ТаблицаРезультатов,ИмяКолонкиНК,НужнаяСтатья,"НК");
	
	СтруктураДанныхПриложение1.R021G4 = R021G4; 
	СтруктураДанныхПриложение1.R021G5 = R021G5; 
	
	//13
	// Коригування податкового кредиту у зв'язку із частковим використанням в СХ
	R130GA = 0;
	R130GB = 0;
	
	//ИНАГРО ++
	R0108GA = 0;
	R0108GB = 0;
	R0208GA = 0;
	R0208GB = 0;
	R0308GA = 0;
	R0308GB = 0;
	//ИНАГРО --
	
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_НККорректировкаЧастИспользВСХ;
	РасчетПоСтатье(НужнаяСтатья,R130GA,R130GB,"R130GA","R130GB",0);
	
	//ИНАГРО ++
	РасчетПоСтатьеПриложение10(НужнаяСтатья,R0108GA,R0208GA,R0308GA,R0108GB,R0208GB, R0308GB ,"R0108GA","R0208GA","R0308GA", "R0108GB", "R0208GB", "R0308GB",0);
	//ИНАГРО --

	//14 переносится вручную из сокращенной декларации
	//R140GB = 0;
	
	//значения по декларациям прошлого периода
	Если СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц Тогда
		ДатПрошлогоПериода1 = НачалоМесяца(ДобавитьМесяц(СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета,-1));
		ДатПрошлогоПериода2 = КонецМесяца(ДатПрошлогоПериода1);
	Иначе
		ДатПрошлогоПериода1 = НачалоКвартала(ДобавитьМесяц(СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета,-3));
		ДатПрошлогоПериода2 = КонецКвартала(ДобавитьМесяц(КонецКвартала(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета),-3));
	КонецЕсли;
	
	ПолучитьДанныеЗаПрошлыйПериодИз1С = Истина;
	Если СтруктураРеквизитовФормы.ПолучениеДанныхДляЗвит1С = Истина Тогда
		Если ЗначениеЗаполнено(СтруктураРеквизитовФормы.Организация.ДатаНачалаИспользованияЗвит1С) Тогда
			ПолучитьданныеЗаПрошлыйПериодИз1С = ДатПрошлогоПериода1 < СтруктураРеквизитовФормы.Организация.ДатаНачалаИспользованияЗвит1С ;
		КонецЕсли;
	КонецЕсли;
	
	Если ПолучитьданныеЗаПрошлыйПериодИз1С Тогда	
		ПоказателиПрошлойДекларацииПоНДС = ПоказателиПредыдущейДекларации(ДатПрошлогоПериода1, ДатПрошлогоПериода2,"РегламентированныйОтчетДекларацияНДС", "РегламентированныйОтчетУточняющийРасчетДекларацияНДС", НСтр("ru = '""Декларация по НДС""'; uk = '""Декларація по ПДВ""'"),"Декларация","ДекларацияПоНДС",НСтр("ru='строки 16';uk='рядка 16'"));
		
		Если НЕ ПоказателиПрошлойДекларацииПоНДС = Неопределено Тогда
			Попытка
				Если    СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Квартал И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 3 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016
				 	ИЛИ СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц   И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 1 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 Тогда
					// из старой декларации
					СтруктураДанныхДекларация.R161GB = ПоказателиПрошлойДекларацииПоНДС.R240GB;
				Иначе	
					СтруктураДанныхДекларация.R161GB = ПоказателиПрошлойДекларацииПоНДС.R210GB;
				КонецЕсли;
			Исключение 
			КонецПопытки
		КонецЕсли;
		Если СтруктураРеквизитовФормы.СпецРежим > 0 Тогда
			ПоказателиПрошлогоПриложения10 = ПоказателиПредыдущейДекларации(ДатПрошлогоПериода1, ДатПрошлогоПериода2,"РегламентированныйОтчетДекларацияНДС", "РегламентированныйОтчетУточняющийРасчетДекларацияНДС", НСтр("ru = '""Декларация по НДС""'; uk = '""Декларація по ПДВ""'"),"Приложение10",,НСтр("ru = 'строк 11.1	Таблиц 1-3 Приложения 10'; uk = 'рядків 11.1	Таблиць 1-3 Додатка 10'"));
			
			Если НЕ ПоказателиПрошлогоПриложения10 = Неопределено Тогда
				Попытка
					СтруктураДанныхПриложение10.Вставить("R01111GB", ПоказателиПрошлогоПриложения10.R0114GB);
					СтруктураДанныхПриложение10.Вставить("R02111GB", ПоказателиПрошлогоПриложения10.R0214GB);
					СтруктураДанныхПриложение10.Вставить("R03111GB", ПоказателиПрошлогоПриложения10.R0314GB);
				Исключение 
				КонецПопытки
			КонецЕсли;
		
		КонецЕсли;
	Иначе
		ИмяПоказателяПредыдущейДекларации = "B2100";
		Если СтруктураРеквизитовФормы.СпецРежим = 0 Тогда
			ПрефиксСхемы = ?(СтруктураРеквизитовФормы.Организация.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо, "J", "F") + "02001";
			Если СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Квартал   И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 9 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 		
			 ИЛИ СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц 	И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 8 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 Тогда		
				ИмяСхемы = ПрефиксСхемы+"17";
			Иначе
				ИмяСхемы = ПрефиксСхемы+"18"
			КонецЕсли;
		ИначеЕсли СтруктураРеквизитовФормы.СпецРежим = 2 Тогда
			ПрефиксСхемы = "J02090";
			Если СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Квартал   И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 9 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 		
			 ИЛИ СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц 	И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 8 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 Тогда		
				ИмяСхемы = ПрефиксСхемы+"09";
			Иначе
				ИмяСхемы = ПрефиксСхемы+"10";
			КонецЕсли;
		ИначеЕсли СтруктураРеквизитовФормы.СпецРежим = 3 Тогда
			ПрефиксСхемы = "J02094";
			Если СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Квартал   И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 9 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 		
			 ИЛИ СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц 	И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 8 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 Тогда		
				ИмяСхемы = ПрефиксСхемы+"08";
			Иначе
				ИмяСхемы = ПрефиксСхемы+"09";
			КонецЕсли;
		КонецЕсли;
		
		Если СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц Тогда
			ТипПериода = 0;
			НомерПериода = Месяц(ДатПрошлогоПериода1);
		Иначе
			ТипПериода = 10;
			НомерПериода = (Месяц(ДатПрошлогоПериода1)+2)/3;
		КонецЕсли;
		ГодПериода = Год(ДатПрошлогоПериода1);
		
		Если НЕ ТипЗнч(ПараметрыЗаполненияЗвит1С) = Тип("Структура") Тогда
			ПараметрыЗаполненияЗвит1С = Новый Структура;
		КонецЕсли;
		ПараметрыЗаполненияЗвит1С.Вставить("ДатПрошлогоПериода1", ДатПрошлогоПериода1);
		ПараметрыЗаполненияЗвит1С.Вставить("ДатПрошлогоПериода2", ДатПрошлогоПериода2);
		
		ПараметрыЗаполненияЗвит1С.Вставить("ПараметрыЗапроса", Новый Структура("ТипПериода, НомерПериода, ГодПериода", ТипПериода, НомерПериода, ГодПериода));
		
		ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.Вставить("ИмяСхемы2", ИмяСхемы);		
		ПараметрыЗаполненияЗвит1С.Вставить("ИмяПоказателяПредыдущейДекларации1", ИмяПоказателяПредыдущейДекларации);
		
		Если СтруктураРеквизитовФормы.СпецРежим > 0 Тогда
		
			Если СтруктураРеквизитовФормы.СпецРежим = 2 Тогда
				ПрефиксСхемы = "J02908";
				Если СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Квартал   И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 9 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 		
				 ИЛИ СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц 	И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 8 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 Тогда		
					ИмяСхемы = ПрефиксСхемы+"01";
				Иначе
					ИмяСхемы = ПрефиксСхемы+"02";
				КонецЕсли;
			ИначеЕсли СтруктураРеквизитовФормы.СпецРежим = 3 Тогда
				ПрефиксСхемы = "J02944";
				Если СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Квартал   И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 9 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 		
				 ИЛИ СтруктураРеквизитовФормы.мПериодичность = Перечисления.Периодичность.Месяц 	И Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 8 И Год(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 2016 Тогда		
					ИмяСхемы = ПрефиксСхемы+"01";
				Иначе
					ИмяСхемы = ПрефиксСхемы+"02";
				КонецЕсли;
			КонецЕсли;
			
			ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.Вставить("ИмяСхемы2", ИмяСхемы);
			ПараметрыЗаполненияЗвит1С.Вставить("ИмяПоказателяПредыдущейДекларации21", "R0114GB");
			ПараметрыЗаполненияЗвит1С.Вставить("ИмяПоказателяПредыдущейДекларации22", "R0214GB");
			ПараметрыЗаполненияЗвит1С.Вставить("ИмяПоказателяПредыдущейДекларации23", "R0314GB");

		КонецЕсли;	
	КонецЕсли;
	
	//16.2
	// корректировка кредита по результатам поданных уточняющих расчетов
	R162GB = 0;
	
	// 16.3
	// корректировка кредита по результатам проверки
	R163GB = 0;
	НужнаяСтатья =  СтрокиДекларацииНДС.НДС_ИзмененОстатокОтрицЗначенияПроверка;
	РасчетПоСтатье(НужнаяСтатья,,R163GB,"","R163GB",0);
	ДT2R[0].ДT2RXXXXG3 = R162GB + R163GB;
	
	//////////////////////////////////////////////
	// Приложение 3

	
	//////////////////////////////////////////////
	// Приложение 4
	СтруктураДанныхПриложение4.R0101G3 = 0;
	СтруктураДанныхПриложение4.R0102G3 = 0;
	СтруктураДанныхПриложение4.R0103G3 = "";
	СтруктураДанныхПриложение4.R0104G3 = "";
	СтруктураДанныхПриложение4.R0105G3 = 0;
	
	СтруктураДанныхПриложение4.R0301G3 = "+";
	
	Если НЕ РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
		//////////////////////////////////////////////
		// Приложение 7
		
		// заполним расчет коэффициента пропорционального отнесения НДС
		// в течение года действует коэффициент, рассчитанный по данным прошлого года (или первого месяца).
		Запрос.УстановитьПараметр ("Период",СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
		Запрос.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
		               |	КоэффициентыПропорциональногоОтнесенияНДСНаКредитСрезПоследних.Регистратор.МесяцРасчета КАК МесяцРасчета,
		               |	КоэффициентыПропорциональногоОтнесенияНДСНаКредитСрезПоследних.Регистратор.ПоДаннымПрошлогоГода КАК ПоДаннымПрошлогоГода,
		               |	КоэффициентыПропорциональногоОтнесенияНДСНаКредитСрезПоследних.Регистратор.СуммаОблагаемыхОпераций КАК СуммаОблагаемыхОпераций,
		               |	КоэффициентыПропорциональногоОтнесенияНДСНаКредитСрезПоследних.Регистратор.СуммаВсехОпераций КАК СуммаВсехОпераций
		               |ИЗ               
		               |	РегистрСведений.КоэффициентыПропорциональногоОтнесенияНДСНаКредит.СрезПоследних(&Период, 
					   |				Организация = &Организация
					   |              И СпецРежимНалогообложения = &СпецРежим
					   |) КАК КоэффициентыПропорциональногоОтнесенияНДСНаКредитСрезПоследних
		               |ГДЕ
		               |	ГОД(КоэффициентыПропорциональногоОтнесенияНДСНаКредитСрезПоследних.Регистратор.Дата) = ГОД(&Период)";
					   
		Выборка = Запрос.Выполнить().Выбрать();
		Если Выборка.Следующий() Тогда
			Если Выборка.ПоДаннымПрошлогоГода = Истина Тогда
				СтруктураДанныхПриложение7.R011G4 = Выборка.СуммаВсехОпераций;
				СтруктураДанныхПриложение7.R011G5 = Выборка.СуммаОблагаемыхОпераций;
			ИначеЕсли Выборка.МесяцРасчета <= Месяц(СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета) Тогда 	
				СтруктураДанныхПриложение7.R012G4 = Выборка.СуммаВсехОпераций;
				СтруктураДанныхПриложение7.R012G5 = Выборка.СуммаОблагаемыхОпераций;
			КонецЕсли;                                   
		КонецЕсли;
		
		//ИНАГРО ++
		//// заполним данные для перерасчета за год/два/три использования ОС. Будем использовать данные из документа ПерерасчетПропорциональногоНДСпоТоварамИОС за 12-й месяц
		//Если Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 12 Тогда
		//	Запрос.Текст = "ВЫБРАТЬ Первые 1
		//	               |	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаВсехОпераций,
		//	               |	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаОблагаемыхОпераций,
		//	               |	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаВсехОпераций2Года КАК СуммаВсехОпераций2Года,
		//	               |	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаОблагаемыхОпераций2Года КАК СуммаОблагаемыхОпераций2Года,
		//	               |	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаВсехОпераций3Года КАК СуммаВсехОпераций3Года,
		//	               |	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаОблагаемыхОпераций3Года КАК СуммаОблагаемыхОпераций3Года,
		//	               |	ПерерасчетПропорциональногоНДСпоТоварамИОС.Дата
		//	               |ИЗ
		//	               |	Документ.ПерерасчетПропорциональногоНДСпоТоварамИОС КАК ПерерасчетПропорциональногоНДСпоТоварамИОС
		//				   |ГДЕ КОНЕЦПЕРИОДА(Дата, ГОД) = КОНЕЦПЕРИОДА(&Период, ГОД)
		//				   |  И Организация = &Организация
		//				   |  И ПерерасчетПропорциональногоНДСпоТоварамИОС.СпецРежимНалогообложения = &СпецРежим
		//				   |УПОРЯДОЧИТЬ ПО Дата Убыв";	
		//	
		//	Выборка = Запрос.Выполнить().Выбрать();
		//	Если Выборка.Следующий() Тогда
		//		
		//		СтруктураДанныхПриложение7.R0131G4 = Выборка.СуммаВсехОпераций;
		//		СтруктураДанныхПриложение7.R0131G5 = Выборка.СуммаОблагаемыхОпераций;
		//		
		//		СтруктураДанныхПриложение7.R0132G4 = Выборка.СуммаВсехОпераций2Года;
		//		СтруктураДанныхПриложение7.R0132G5 = Выборка.СуммаОблагаемыхОпераций2Года;
		//		
		//		СтруктураДанныхПриложение7.R0133G4 = Выборка.СуммаВсехОпераций3Года;
		//		СтруктураДанныхПриложение7.R0133G5 = Выборка.СуммаОблагаемыхОпераций3Года;
		//		
		//	КонецЕсли;
		//ИНАГРО --
		
			//////////////////////////////////
			// Таблица 2 Приложения 7
			//////////////////////////////////
			
			ЗапросП7 = Новый Запрос();
			ЗапросП7.УстановитьПараметр("Организация", СтруктураРеквизитовФормы.Организация);
			ЗапросП7.УстановитьПараметр("НачПериод", СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета);
			ЗапросП7.УстановитьПараметр("КонПериод", СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
			ЗапросП7.УстановитьПараметр("СпецРежимНалогообложения", СтруктураРеквизитовФормы.СпецРежим);
			ЗапросП7.Текст = "ВЫБРАТЬ
			                 |	ПерерасчетПропорциональногоНДСпоТоварамИОС.НН КАК НН,
			                 |	МАКСИМУМ(ПерерасчетПропорциональногоНДСпоТоварамИОС.НН.СпецРежимНалогообложения) КАК ННСпецРежимНалогообложения,
			                 |	МАКСИМУМ(ПерерасчетПропорциональногоНДСпоТоварамИОС.НН.Дата) КАК ННДата,
			                 |	МАКСИМУМ(ПерерасчетПропорциональногоНДСпоТоварамИОС.НН.Номер) КАК НННомер,
			                 |	ПерерасчетПропорциональногоНДСпоТоварамИОС.П2 КАК П2,
			                 |	МАКСИМУМ(ПерерасчетПропорциональногоНДСпоТоварамИОС.П2.СпецРежимНалогообложения) КАК П2СпецРежимНалогообложения,
			                 |	МАКСИМУМ(ПерерасчетПропорциональногоНДСпоТоварамИОС.П2.Дата) КАК П2Дата,
			                 |	МАКСИМУМ(ПерерасчетПропорциональногоНДСпоТоварамИОС.П2.Номер) КАК П2Номер,
			                 |	СУММА(П2Услуги.Сумма - ВЫБОР
			                 |			КОГДА П2Услуги.Ссылка.СуммаВключаетНДС
			                 |				ТОГДА -П2Услуги.СуммаНДС
			                 |			ИНАЧЕ 0
			                 |		КОНЕЦ) КАК База,
			                 |	СУММА(П2Услуги.ИзменениеСуммыНДС) КАК КорректировкаНДС,
			                 |	П2Услуги.СтавкаНДС КАК СтавкаНДС
			                 |ИЗ
			                 |	Документ.ПерерасчетПропорциональногоНДСпоТоварамИОС.НалоговыеДокументы КАК ПерерасчетПропорциональногоНДСпоТоварамИОС
			                 |		ЛЕВОЕ СОЕДИНЕНИЕ Документ.Приложение2КНалоговойНакладной.Услуги КАК П2Услуги
			                 |		ПО (П2Услуги.Ссылка = ПерерасчетПропорциональногоНДСпоТоварамИОС.П2)
			                 |ГДЕ
			                 |	ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Дата >= &НачПериод
			                 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Дата <= &КонПериод
			                 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Проведен
			                 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Организация = &Организация
			                 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.СпецРежимНалогообложения = &СпецРежимНалогообложения
			                 |
			                 |СГРУППИРОВАТЬ ПО
			                 |	ПерерасчетПропорциональногоНДСпоТоварамИОС.НН,
			                 |	ПерерасчетПропорциональногоНДСпоТоварамИОС.П2,
			                 |	П2Услуги.СтавкаНДС
			                 |ИТОГИ ПО
			                 |	НН,
			                 |	П2,
			                 |	СтавкаНДС";
							 
			РезультатЗапросаП7 = ЗапросП7.Выполнить();
			
			ДанныеФормы 	= ЭтаФорма[СтруктураРеквизитовФормы.мИдГруппы7];
			Таблица = ДанныеФормыВЗначение(ДанныеФормы, Тип("ТаблицаЗначений"));
			Таблица.Очистить();
			
			ВыборкаП7НН = РезультатЗапросаП7.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
			Пока ВыборкаП7НН.Следующий() Цикл
				
				ВыборкаП7П2 = ВыборкаП7НН.Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам);
				Пока ВыборкаП7П2.Следующий() Цикл
					
					Строка = Таблица.Добавить();
					
					ВыборкаП7Детали = ВыборкаП7П2.Выбрать(ОбходРезультатаЗапроса.Прямой);
					Пока ВыборкаП7Детали.Следующий() Цикл
						
						Строка.П7T2RXXXXG2D = ВыборкаП7Детали.ННДата;			 
						
						ТекНомерНН = "" + ПрефиксацияОбъектовКлиентСервер.ПолучитьНомерНаПечать(ВыборкаП7Детали.НННомер, Истина, Истина)
									 + ?(ЗначениеЗаполнено(ВыборкаП7Детали.ННСпецРежимНалогообложения), "/" + ВыборкаП7Детали.ННСпецРежимНалогообложения, "");			
						Строка.П7T2RXXXXG3S = ТекНомерНН;
						
						Строка.П7T2RXXXXG4D = ВыборкаП7Детали.П2Дата;			 
						
						ТекНомерП2 = "" + ПрефиксацияОбъектовКлиентСервер.ПолучитьНомерНаПечать(ВыборкаП7Детали.П2Номер, Истина, Истина)
									 + ?(ЗначениеЗаполнено(ВыборкаП7Детали.П2СпецРежимНалогообложения), "/" + ВыборкаП7Детали.П2СпецРежимНалогообложения, "");			
									 
						Строка.П7T2RXXXXG5S = ТекНомерП2;			 
						
						Если ВыборкаП7Детали.СтавкаНДС = Перечисления.СтавкиНДС.НДС20 Тогда
						
							Строка.П7T2RXXXXG6 = ВыборкаП7Детали.База;			 
							Строка.П7T2RXXXXG8 = ВыборкаП7Детали.КорректировкаНДС;			 
							
						Иначе
							
							Строка.П7T2RXXXXG7 = ВыборкаП7Детали.База;			 
							Строка.П7T2RXXXXG9 = ВыборкаП7Детали.КорректировкаНДС;			 
							
						КонецЕсли;

					КонецЦикла;
					
				КонецЦикла;
				
			КонецЦикла;	
		
			Пока Таблица.Количество() < мСтруктураИсхКолвоСтрокРазделов[СтруктураРеквизитовФормы.мИдГруппы7] Цикл
				Таблица.Добавить();
			КонецЦикла;
			ЗначениеВРеквизитФормы(Таблица, СтруктураРеквизитовФормы.мИдГруппы7);
			
			//////////////////////////////////
			// Таблица 3 Приложения 7
			//////////////////////////////////
			
			ЗапросП7.Текст = "ВЫБРАТЬ
							 // ОС
							 |	СУММА(ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаПоставки) КАК СуммаПоставки,
			                 |	СУММА(ПерерасчетПропорциональногоНДСпоТоварамИОС.НДСПоставки) КАК НДСПоставки,
			                 |	СУММА(ПерерасчетПропорциональногоНДСпоТоварамИОС.НДСПропорциональноКредитДоПерерасчета) КАК НДСПропорциональноКредитДоПерерасчета,
			                 |	СУММА(ПерерасчетПропорциональногоНДСпоТоварамИОС.НДСПропорциональноКредит) КАК НДСПропорциональноКредит,
			                 |	ГОД(&НачПериод) - ГОД(ПерерасчетПропорциональногоНДСпоТоварамИОС.ДатаНачалаИспользования) КАК ЛетИспользования
			                 |ИЗ
			                 |	Документ.ПерерасчетПропорциональногоНДСпоТоварамИОС.ПараметрыПерерасчетаОС КАК ПерерасчетПропорциональногоНДСпоТоварамИОС
							 |
							 |ГДЕ
			                 |	ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Дата  >= &НачПериод
							 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Дата <= &КонПериод
			                 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Проведен
			                 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.Организация = &Организация
							 |	И ПерерасчетПропорциональногоНДСпоТоварамИОС.ДатаНачалаИспользования < НАЧАЛОПЕРИОДА(&НачПериод, ГОД)
						     |  И ПерерасчетПропорциональногоНДСпоТоварамИОС.Ссылка.СпецРежимНалогообложения = &СпецРежимНалогообложения
			                 |
			                 |СГРУППИРОВАТЬ ПО
			                 |	ГОД(&НачПериод) - ГОД(ПерерасчетПропорциональногоНДСпоТоварамИОС.ДатаНачалаИспользования)";
							 
			РезультатЗапросаП7 = ЗапросП7.Выполнить();
			ВыборкаП7 = РезультатЗапросаП7.Выбрать();
			Пока ВыборкаП7.Следующий() Цикл
				
				ЛетИспользования = ВыборкаП7.ЛетИспользования;
				Если ЛетИспользования > 3 ИЛИ ЛетИспользования < 1 Тогда
					Продолжить;
				КонецЕсли;
				
				СтруктураДанныхПриложение7["R03" + ЛетИспользования + "G3"] = ВыборкаП7.СуммаПоставки;
				СтруктураДанныхПриложение7["R03" + ЛетИспользования + "G4"] = ВыборкаП7.НДСПоставки;
				СтруктураДанныхПриложение7["R03" + ЛетИспользования + "G5"] = ВыборкаП7.НДСПропорциональноКредитДоПерерасчета;
				СтруктураДанныхПриложение7["R03" + ЛетИспользования + "G6"] = ВыборкаП7.НДСПропорциональноКредит;
			
			КонецЦикла;

		КонецЕсли;
		
		//ИНАГРО ++
		// заполним данные для перерасчета за год/два/три использования ОС. Будем использовать данные из документа ПерерасчетПропорциональногоНДСпоТоварамИОС за 12-й месяц
		Если Месяц(СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета) = 12 Тогда
			Запрос.Текст = "ВЫБРАТЬ Первые 1
			|	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаВсехОпераций,
			|	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаОблагаемыхОпераций,
			|	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаВсехОпераций2Года КАК СуммаВсехОпераций2Года,
			|	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаОблагаемыхОпераций2Года КАК СуммаОблагаемыхОпераций2Года,
			|	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаВсехОпераций3Года КАК СуммаВсехОпераций3Года,
			|	ПерерасчетПропорциональногоНДСпоТоварамИОС.СуммаОблагаемыхОпераций3Года КАК СуммаОблагаемыхОпераций3Года,
			|	ПерерасчетПропорциональногоНДСпоТоварамИОС.Дата
			|ИЗ
			|	Документ.ПерерасчетПропорциональногоНДСпоТоварамИОС КАК ПерерасчетПропорциональногоНДСпоТоварамИОС
			|ГДЕ КОНЕЦПЕРИОДА(Дата, ГОД) = КОНЕЦПЕРИОДА(&Период, ГОД)
			|  И Организация = &Организация
			|  И ПерерасчетПропорциональногоНДСпоТоварамИОС.СпецРежимНалогообложения = &СпецРежим
			|УПОРЯДОЧИТЬ ПО Дата Убыв";	
			
			Выборка = Запрос.Выполнить().Выбрать();
			Если Выборка.Следующий() Тогда
				
				СтруктураДанныхПриложение7.R0131G4 = Выборка.СуммаВсехОпераций;
				СтруктураДанныхПриложение7.R0131G5 = Выборка.СуммаОблагаемыхОпераций;
				
				СтруктураДанныхПриложение7.R0132G4 = Выборка.СуммаВсехОпераций2Года;
				СтруктураДанныхПриложение7.R0132G5 = Выборка.СуммаОблагаемыхОпераций2Года;
				
				СтруктураДанныхПриложение7.R0133G4 = Выборка.СуммаВсехОпераций3Года;
				СтруктураДанныхПриложение7.R0133G5 = Выборка.СуммаОблагаемыхОпераций3Года;
				
			КонецЕсли;
		КонецЕсли;
	//ИНАГРО --
	
	// Приложение 8 (Жалоба);
	Если РегламентированнаяОтчетностьПереопределяемый.ИДКонфигурации() = "ЕРП" Тогда
		ДанныеКонтрагента =  "Контрагент";
		ИННКонтрагента =  "Контрагент.ИННПлательщикаНДС";
	Иначе
		ДанныеКонтрагента = "ДоговорКонтрагента.Владелец";
		ИННКонтрагента =  "Контрагент.ИНН";
	КонецЕсли;	
	ТекстЗапросаПриложение8 = "ВЫБРАТЬ
	                          | ВЫБОР КОГДА ВидОперации В (&ВидыОперацийВозврат) ТОГДА ""Розрахунок коригування"" ИНАЧЕ ""Податкова накладна"" КОНЕЦ КАК ВидДокумента,
							  |	ЗКП.НомерВходящегоДокумента КАК НомерНН,
	                          |	ЗКП.ДатаВходящегоДокумента КАК ДатаНН,
	                          |	ЗКП.Дата КАК Дата,
	                          |	ЗКП.ВключатьВПриложение8Декларации КАК НомерТаблицыПриложения,
	                          |	ЗКП."+ДанныеКонтрагента+".НаименованиеПолное КАК ИмяКонтрагента,
	                          |	ЗКП."+ИННКонтрагента+" КАК ИННКонтрагента,
	                          |	ЗКП.ОписаниеНарушенияПриложение8Декларации КАК Описание,
	                          |	ЗКП.ПараметрыДокОтказаПриложение8Декларации КАК ДокументОтказа,
	                          |	ЗКП.СуммаПриложение8Декларации + ЗКП.Сумма7Приложение8Декларации КАК Сумма,
	                          |	ЗКП.СуммаНДСПриложение8Декларации + ЗКП.СуммаНДС7Приложение8Декларации КАК НДС
	                          |ИЗ
	                          |	Документ."+ИмяДокументаЗКП+" КАК ЗКП
	                          |ГДЕ
	                          |	ЗКП.Дата МЕЖДУ &НачДата И &КонДата
							  |	И ЗКП.Проведен
							  |	И ЗКП.Организация = &Организация
	                          |	И НЕ ЗКП.ВключаетсяВУточняющийРасчет
	                          |	И ЗКП.СпецРежимНалогообложения = &СпецРежим
	                          |	И ЗКП.ВключатьВПриложение8Декларации > 0";
	
	Запрос.Текст = ТекстЗапросаПриложение8;
	
	ВидыОперацийВозврат = Новый Массив;
	ВидыОперацийВозврат.Добавить(Перечисления[ВидОперацииЗКП].РасчетКорректировкиВозврат);
	ВидыОперацийВозврат.Добавить(Перечисления[ВидОперацииЗКП].РасчетКорректировкиКорректировка);
	Запрос.УстановитьПараметр("ВидыОперацийВозврат", ВидыОперацийВозврат);
	
	ВыборкаПриложение8 = Запрос.Выполнить().Выбрать();
	
	СоответствиеПолейТаблица = Новый Структура();
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG2S",  "ВидДокумента");
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG3S",  "ИмяКонтрагента");
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG4",   "ИННКонтрагента");
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG5D",  "ДатаНН");
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG6S",  "НомерНН");
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG7",   "Сумма");
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG8",   "НДС");
	СоответствиеПолейТаблица.Вставить("П8T1RXXXXG9S",  "Описание");
	
	ДанныеФормы 	= ЭтаФорма[СтруктураРеквизитовФормы.мИдГруппы81];
	Таблица = ДанныеФормыВЗначение(ДанныеФормы, Тип("ТаблицаЗначений"));
	Таблица.Очистить();
	
	Пока ВыборкаПриложение8.Следующий() Цикл
		
		Если ВыборкаПриложение8.НомерТаблицыПриложения = 1 ИЛИ ВыборкаПриложение8.НомерТаблицыПриложения = 2 Тогда
		Иначе
			Продолжить;
		КонецЕсли;

		СтрокаТаблицы = Таблица.Добавить();
		
		Для каждого ПолеТаблицы Из СоответствиеПолейТаблица Цикл
		
			СтрокаТаблицы[ПолеТаблицы.Ключ]	= ВыборкаПриложение8[ПолеТаблицы.Значение];
		
		КонецЦикла;

		СтруктураДанныхДекларация.HD8 = "Х";
		
	КонецЦикла;

	Пока Таблица.Количество() < мСтруктураИсхКолвоСтрокРазделов[СтруктураРеквизитовФормы.мИдГруппы81] Цикл
		Таблица.Добавить();
	КонецЦикла;
	ЗначениеВРеквизитФормы(Таблица, СтруктураРеквизитовФормы.мИдГруппы81);

	// заполняем информацию о филиалах
	ЗапросФилиалы = Новый Запрос;
	ЗапросФилиалы.Текст = "ВЫБРАТЬ РАЗРЕШЕННЫЕ
	                      |	ОбособленныеПодразделенияОрганизаций.Префикс	 		КАК Префикс,
						  |	ОбособленныеПодразделенияОрганизаций.КодПоЕДРПОУ 		КАК КодПоЕДРПОУ,
						  |	ОбособленныеПодразделенияОрганизаций.Адрес 		 		КАК Адрес,
						  |	ОбособленныеПодразделенияОрганизаций.НаименованиеПолное КАК Наименование
	                      |ИЗ
	                      |	Справочник.ОбособленныеПодразделенияОрганизаций КАК ОбособленныеПодразделенияОрганизаций
	                      |ГДЕ
	                      |	ОбособленныеПодразделенияОрганизаций.Владелец = &Организация
	                      |	И НЕ ОбособленныеПодразделенияОрганизаций.ПометкаУдаления
	                      |
	                      |УПОРЯДОЧИТЬ ПО
	                      |	ОбособленныеПодразделенияОрганизаций.Префикс
						  |";
	ЗапросФилиалы.УстановитьПараметр("Организация", СтруктураРеквизитовФормы.Организация);
	
	РеквизитыОбособенныхПодразлелений = Метаданные.Справочники.ОбособленныеПодразделенияОрганизаций.Реквизиты;						  
	// для разработчиков: добавьте соответстующие реквизиты в справочник и приложение к декларации начнет их автоматически подтягивать
	Если РеквизитыОбособенныхПодразлелений.Найти("КодПоЕДРПОУ") = Неопределено Тогда
		ЗапросФилиалы.Текст = СтрЗаменить(ЗапросФилиалы.Текст, "ОбособленныеПодразделенияОрганизаций.КодПоЕДРПОУ", "NULL");
	КонецЕсли;
	Если РеквизитыОбособенныхПодразлелений.Найти("Адрес") = Неопределено Тогда
		ЗапросФилиалы.Текст = СтрЗаменить(ЗапросФилиалы.Текст, "ОбособленныеПодразделенияОрганизаций.Адрес", "NULL");
	КонецЕсли;
						  
	СписокФилиалов = ЗапросФилиалы.Выполнить().Выбрать();
	ДанныеФормы 	= ЭтаФорма[СтруктураРеквизитовФормы.мИдГруппыФ1];
	Таблица = ДанныеФормыВЗначение(ДанныеФормы, Тип("ТаблицаЗначений"));
	Таблица.Очистить();
	Пока СписокФилиалов.Следующий() Цикл
		
		СтрокаТаблицы = Таблица.Добавить();
		СтрокаТаблицы.ФT1RXXXXG1  = СписокФилиалов.Префикс;
		СтрокаТаблицы.ФT1RXXXXG2  = СписокФилиалов.КодПоЕДРПОУ;
		СтрокаТаблицы.ФT1RXXXXG3S = СписокФилиалов.Наименование;
		СтрокаТаблицы.ФT1RXXXXG4S = СписокФилиалов.Адрес;
		
	КонецЦикла;
	Пока Таблица.Количество() < мСтруктураИсхКолвоСтрокРазделов[СтруктураРеквизитовФормы.мИдГруппыФ1] Цикл
		Таблица.Добавить();
	КонецЦикла;
	ЗначениеВРеквизитФормы(Таблица, СтруктураРеквизитовФормы.мИдГруппыФ1);
	
	Если НЕ ЗначениеЗаполнено(СтруктураДанныхДекларация.HZG) Тогда
		
		// для сельхоз. декларации перенесем полученные данные из тела декларации в Приложение 10
		// так как в типовых конфигурациях не ведется учет для сельхоз. предприятий
		// мы не можем определить в какие таблицы Приложения 10 вносить данные.
		// вносим все данные в первую таблицу
		
		ТекHZG = СтруктураДанныхДекларация.HZG;
		ТекHSG = СтруктураДанныхДекларация.HSG;
		ТекHLG = СтруктураДанныхДекларация.HLG;
		ТекHRB = СтруктураДанныхДекларация.HRB;
		ТекHNS = СтруктураДанныхДекларация.HNS;
		
		СтруктураДанныхДекларация.HZG = "X";
		СтруктураДанныхДекларация.HSG = "";
		СтруктураДанныхДекларация.HLG = "";
		СтруктураДанныхДекларация.HRB = "";
		СтруктураДанныхДекларация.HNS = "";
		
		СтруктураРеквизитовФормы.мНеВыдаватьСообщенияОбОшибкахВРасчете = Истина;
		ВывестиМакетВТаблДокНаСервере(СтруктураРеквизитовФормы.НаимТекущегоРаздела, 1);
		Расчет(ЭтаФорма);
		СохранитьДанныеРаздела(СтруктураРеквизитовФормы.НаимТекущегоРаздела, Ложь);
		СтруктураРеквизитовФормы.мНеВыдаватьСообщенияОбОшибкахВРасчете = Ложь;
		
		СтруктураДанныхДекларация.HZG = ТекHZG;
		СтруктураДанныхДекларация.HSG = ТекHSG;
		СтруктураДанныхДекларация.HLG = ТекHLG;
		СтруктураДанныхДекларация.HRB = ТекHRB;
		СтруктураДанныхДекларация.HNS = ТекHNS;
		
		//ИНАГРО ++
		//СтруктураДанныхПриложение10.R0101GA = СтруктураДанныхДекларация.R11GA;	
		//СтруктураДанныхПриложение10.R0101GB = СтруктураДанныхДекларация.R11GB;	
		
		//СтруктураДанныхПриложение10.R0102GA = СтруктураДанныхДекларация.R20GA;	
												
		//СтруктураДанныхПриложение10.R0103GA = СтруктураДанныхДекларация.R70GA;	
		//СтруктураДанныхПриложение10.R0103GB = СтруктураДанныхДекларация.R70GB;	
		
		//СтруктураДанныхПриложение10.R01051GA = СтруктураДанныхДекларация.R101GA;	
		//СтруктураДанныхПриложение10.R01051GB = СтруктураДанныхДекларация.R101GB;	
		
		СтруктураДанныхПриложение10.R01051GA = R01051GA;
		СтруктураДанныхПриложение10.R01051GB = R01051GB;
		СтруктураДанныхПриложение10.R02051GA = R02051GA;
		СтруктураДанныхПриложение10.R02051GB = R02051GB;
		СтруктураДанныхПриложение10.R03051GA = R03051GA;
		СтруктураДанныхПриложение10.R03051GB = R03051GB;
		
		СтруктураДанныхПриложение10.R01052GA = R01052GA;
		СтруктураДанныхПриложение10.R01052GB = R01052GB;
		СтруктураДанныхПриложение10.R02052GA = R02052GA;
		СтруктураДанныхПриложение10.R02052GB = R02052GB;
		СтруктураДанныхПриложение10.R03052GA = R03052GA;
		СтруктураДанныхПриложение10.R03052GB = R03052GB;
																									 												 
		//СтруктураДанныхПриложение10.R01052GA = СтруктураДанныхДекларация.R102GA;	
		//СтруктураДанныхПриложение10.R01052GB = СтруктураДанныхДекларация.R102GB;	
		//										 
		//
		//СтруктураДанныхПриложение10.R01061GA = СтруктураДанныхДекларация.R111GA;	
		//СтруктураДанныхПриложение10.R01061GB = СтруктураДанныхДекларация.R111GB;	
		//										 
		//СтруктураДанныхПриложение10.R01062GA = СтруктураДанныхДекларация.R112GA;	
		//СтруктураДанныхПриложение10.R01062GB = СтруктураДанныхДекларация.R112GB;	
		//ИНАГРО --

		СтруктураДанныхПриложение10.R01063GA = СтруктураДанныхДекларация.R114GA;	
		СтруктураДанныхПриложение10.R01063GB = СтруктураДанныхДекларация.R114GB;	
		
		//ИНАГРО ++
		//СтруктураДанныхПриложение10.R0107GA = СтруктураДанныхДекларация.R120GA;	
		//СтруктураДанныхПриложение10.R0107GB = СтруктураДанныхДекларация.R120GB;	
		
		//СтруктураДанныхПриложение10.R0108GA = СтруктураДанныхДекларация.R130GA;	
		//СтруктураДанныхПриложение10.R0108GB = СтруктураДанныхДекларация.R130GB;
		
		СтруктураДанныхПриложение10.R0107GA = R0107GA;	
		СтруктураДанныхПриложение10.R0107GB = R0107GB;
		СтруктураДанныхПриложение10.R0207GA = R0207GA;	
		СтруктураДанныхПриложение10.R0207GB = R0207GB;	
		СтруктураДанныхПриложение10.R0307GA = R0307GA;	
		СтруктураДанныхПриложение10.R0307GB = R0307GB;
		//ИНАГРО --	
		
		СтруктураДанныхПриложение10.R0109GB = СтруктураДанныхДекларация.R140GB;	
												 										 
		СтруктураДанныхПриложение10.R0110GA = СтруктураДанныхДекларация.R150GA;	
		СтруктураДанныхПриложение10.R0110GB = СтруктураДанныхДекларация.R150GB;	
												 
		СтруктураДанныхПриложение10.R01112GB = СтруктураДанныхДекларация.R162GB;	
		
		СтруктураДанныхПриложение10.R01113GB = СтруктураДанныхДекларация.R163GB;	
	
	КонецЕсли;
	
	СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки = ПоместитьВоВременноеХранилище(ТаблицаРасшифровки, УникальныйИдентификатор);
	
	Модифицированность = Истина;
	
КонецПроцедуры

&НаСервере
Функция ПоказателиПредыдущейДекларации(ДатаНачалаПериода,ДатаОкончанияПериода,ИсточникОтчета,ИсточникУточненки,ПредставлениеОтчета,ИмяПоля,
									   ИмяПоля2 = "",
									   ПредставлениеПоказателя)
    перем ПоказателиОтчета;
	перем ПоказателиДекларации;
	перем ЗначениеФлажка;
	
	Перем ГодУточненки, МесяцУточненки, КварталУточненки;
	Перем ТекГодУточненки, ТекМесяцУточненки, ТекКварталУточненки;
	
	ТекстЗапроса = "ВЫБРАТЬ
	               |	2 КАК Порядок1,
	               |	РегламентированныйОтчет.ДатаПодписи КАК Порядок2,
	               |	РегламентированныйОтчет.ИсточникОтчета,
	               |	РегламентированныйОтчет.ДанныеОтчета
	               |ИЗ
	               |	Документ.РегламентированныйОтчет КАК РегламентированныйОтчет
	               |ГДЕ
	               |	РегламентированныйОтчет.ПометкаУдаления  = ЛОЖЬ
	               |	И РегламентированныйОтчет.Организация    = &Организация
	               |	И РегламентированныйОтчет.ИсточникОтчета = &ИсточникОтчетаДекларация
	               |	И РегламентированныйОтчет.ДатаНачала     = &ДатаНачала
	               |	И РегламентированныйОтчет.ДатаОкончания  = &ДатаОкончания
	               |
	               |ОБЪЕДИНИТЬ ВСЕ
	               |
	               |ВЫБРАТЬ
	               |	1,
	               |	РегламентированныйОтчет.ДатаПодписи,
	               |	РегламентированныйОтчет.ИсточникОтчета,
	               |	РегламентированныйОтчет.ДанныеОтчета
	               |ИЗ
	               |	Документ.РегламентированныйОтчет КАК РегламентированныйОтчет
	               |ГДЕ
	               |	РегламентированныйОтчет.ПометкаУдаления  = ЛОЖЬ
	               |	И РегламентированныйОтчет.Организация    = &Организация
	               |	И РегламентированныйОтчет.ИсточникОтчета = &ИсточникОтчетаУточненка
	               |	И РегламентированныйОтчет.ДатаНачала    >= &ДатаНачала
	               |	И РегламентированныйОтчет.ДатаОкончания >= &ДатаОкончания
	               |
	               |УПОРЯДОЧИТЬ ПО
	               |	Порядок1,
	               |	Порядок2 УБЫВ";
	
	
	ЗапросОтчета = Новый Запрос ();
	ЗапросОтчета.УстановитьПараметр ("ДатаНачала",		ДатаНачалаПериода);
	ЗапросОтчета.УстановитьПараметр ("ДатаОкончания",	ДатаОкончанияПериода);
	ЗапросОтчета.УстановитьПараметр ("Организация",		СтруктураРеквизитовФормы.Организация);
    ЗапросОтчета.УстановитьПараметр ("ИсточникОтчетаДекларация", ИсточникОтчета);
	ЗапросОтчета.УстановитьПараметр ("ИсточникОтчетаУточненка",	 ИсточникУточненки);

	ЗапросОтчета.Текст = ТекстЗапроса;
	РезультатЗапроса = ЗапросОтчета.Выполнить().Выгрузить();

	ГодУточненки = Год(ДатаНачалаПериода);
	Если Месяц(ДатаНачалаПериода) = Месяц(ДатаОкончанияПериода) Тогда
		МесяцУточненки   = Месяц(ДатаНачалаПериода);
		КварталУточненки = 0;
	Иначе
		МесяцУточненки   = 0;
		КварталУточненки = Месяц(КонецКвартала(ДатаОкончанияПериода))/3;
	КонецЕсли;
	
	Если  РезультатЗапроса.Количество() = 0 Тогда
		ТекстСообщения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='Сохраненный отчет %3 за %1 не обнаружен! Автоматическое заполнения показателя %2  невозможно!';uk='Звіт %3 за %1 не виявлений! Автоматичне заповнення показника %2 неможливо!'"), ПредставлениеПериода( НачалоМесяца(ДатаНачалаПериода), КонецМесяца(ДатаОкончанияПериода), "Л = ""uk_UA""; ФП = Истина" ), ПредставлениеПоказателя, ПредставлениеОтчета); 
		Если СтруктураРеквизитовФормы.ПолучениеДанныхДляЗвит1С = Ложь Тогда
			Сообщить(ТекстСообщения);
		Иначе
			мСписокСообщенийЗвит1С.Добавить(4,ТекстСообщения)
		КонецЕсли;
		Возврат Неопределено;
	Иначе	
		
		Для каждого СохраненныйОтчет Из РезультатЗапроса Цикл
		
			ДанныеОтчета = СохраненныйОтчет.ДанныеОтчета.Получить();
			ДанныеОтчета.Свойство("ПоказателиОтчета",ПоказателиОтчета);
			
			// проверим уточняемый период для уточненки
			Если СохраненныйОтчет.ИсточникОтчета = ИсточникУточненки Тогда
				
				СлужебныеДанные = Неопределено;
				ПоказателиОтчета.Свойство("ПолеТабличногоДокументаСлужебныеДанные", СлужебныеДанные);
				
				Если  СлужебныеДанные.Свойство("HZYP", ТекГодУточненки)
					И СлужебныеДанные.Свойство("HZKVP",ТекКварталУточненки)
					И СлужебныеДанные.Свойство("HZMP", ТекМесяцУточненки)Тогда
					
					Если НЕ (  ТекГодУточненки 		= ГодУточненки 
					  	     И ТекКварталУточненки 	= КварталУточненки
						     И ТекМесяцУточненки 	= МесяцУточненки) Тогда
						Продолжить;						
					КонецЕсли;
					
				Иначе	
					Продолжить;
				КонецЕсли;
			
			КонецЕсли;
			
			НаименованиеПоля = "ПолеТабличногоДокумента" + ИмяПоля;
			Если НЕ ПоказателиОтчета.Свойство(НаименованиеПоля,ПоказателиДекларации) Тогда
				НаименованиеПоля = "ПолеТабличногоДокумента" + ИмяПоля2;
				Если НЕ ПоказателиОтчета.Свойство(НаименованиеПоля,ПоказателиДекларации) Тогда
					Продолжить;
				КонецЕсли;
			КонецЕсли;
			
			Если СтруктураРеквизитовФормы.СпецРежим = 0 И ПоказателиДекларации.Свойство("HZG", ЗначениеФлажка) И ЗначениеЗаполнено(ЗначениеФлажка) Тогда
				Возврат ПоказателиДекларации;
			ИначеЕсли СтруктураРеквизитовФормы.СпецРежим = 3 И ПоказателиДекларации.Свойство("HNS", ЗначениеФлажка) И ЗначениеЗаполнено(ЗначениеФлажка) Тогда	
				Возврат ПоказателиДекларации;
			ИначеЕсли СтруктураРеквизитовФормы.СпецРежим = 2 Тогда
				Если ПоказателиДекларации.Свойство("HSG", ЗначениеФлажка) И ЗначениеЗаполнено(ЗначениеФлажка) И ЗначениеЗаполнено(СтруктураДанныхДекларация.HSG) Тогда	
					Возврат ПоказателиДекларации;
				ИначеЕсли ПоказателиДекларации.Свойство("HLG", ЗначениеФлажка) И ЗначениеЗаполнено(ЗначениеФлажка) И ЗначениеЗаполнено(СтруктураДанныхДекларация.HLG) Тогда	
					Возврат ПоказателиДекларации;
				ИначеЕсли ПоказателиДекларации.Свойство("HRB", ЗначениеФлажка) И ЗначениеЗаполнено(ЗначениеФлажка) И ЗначениеЗаполнено(СтруктураДанныхДекларация.HRB) Тогда	
					Возврат ПоказателиДекларации;
				КонецЕсли;
			КонецЕсли;
		
		КонецЦикла;
		
		ТекстСообщения = СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(НСтр("ru='Сохраненный отчет %3 за %1 по указанному спец. режиму (поля 0110...0140) не обнаружен! Автоматическое заполнения показателя %2  невозможно!';uk= 'Збереженого звіту %3 за %1 по зазначеному спец. режиму (поля 0110...0140) не виявлено! Автоматичне заповнення показника %2 неможливо!'"), ПредставлениеПериода( НачалоМесяца(ДатаНачалаПериода), КонецМесяца(ДатаОкончанияПериода), "Л = ""uk_UA""; ФП = Истина" ), ПредставлениеПоказателя, ПредставлениеОтчета); 
		Если СтруктураРеквизитовФормы.ПолучениеДанныхДляЗвит1С = Ложь Тогда
			Сообщить(ТекстСообщения);
		Иначе
			мСписокСообщенийЗвит1С.Добавить(4,ТекстСообщения);
		КонецЕсли;
		
		Возврат Неопределено;
		
	КонецЕсли;	
	
КонецФункции

&НаКлиенте
Процедура ДозаполнитьНаКлиенте(ПараметрыЗаполненияЗвит1С)
	
	Если ТипЗнч(ПараметрыЗаполненияЗвит1С) = Тип("Структура") Тогда
	
		Попытка
			
			Данные = глКомпонентаЗвит1С.GetReport(ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы1, 
												  ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ТипПериода, 
												  ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.НомерПериода, 
												  ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ГодПериода);
			Если Данные = Неопределено Тогда
				// При групповом заполнении отчетов сообщение выводим один раз
				// так же не вывподим сообщение при заполнении приложений (там где данные прошлого периода не используются)
				Если глМенеджерЗвит1С.ИмяСхемыЗвит1С = ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы1 Тогда
					ТекстСообщения = "Збереженого звіту ""Декларація по ПДВ"" ("+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы1+") за "+ПредставлениеПериода(ПараметрыЗаполненияЗвит1С.ДатПрошлогоПериода1, ПараметрыЗаполненияЗвит1С.ДатПрошлогоПериода2, "Л=uk_UA")+" не виявлено!
					                 |Автоматичне заповнення показника рядка 16!";
					глМенеджерЗвит1С.ПредупреждениеЗвит1С(ТекстСообщения, "Завантаження даних з ""FREDO Звіт""");
				КонецЕсли;
			Иначе
				
				R161GB = Данные.GetValue("MAIN", ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяПоказателяПредыдущейДекларации1);
				ЗаполнитьПоказательНаСервере("R161GB", R161GB, ЭтаФорма, "Декларация");
				
			КонецЕсли;
			
		Исключение
			
			Если глМенеджерЗвит1С.ФлагОтладки Тогда
				Сообщить("FREDO Звіт. Исключение при получении данных из ""FREDO Звіт"" ("+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы1+", "+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ТипПериода+", "+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.НомерПериода+", " +ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ГодПериода+")", СтатусСообщения.Важное);
				Сообщить(ОписаниеОшибки(), СтатусСообщения.Информация);
			КонецЕсли;
			
		КонецПопытки;
		
		Попытка
			
			Данные = глКомпонентаЗвит1С.GetReport(ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы2, 
												  ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ТипПериода, 
												  ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.НомерПериода, 
												  ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ГодПериода);
			Если Данные = Неопределено Тогда
				// При групповом заполнении отчетов сообщение выводим один раз
				// так же не вывподим сообщение при заполнении приложений (там где данные прошлого периода не используются)
				Если глМенеджерЗвит1С.ИмяСхемыЗвит1С = ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы2 Тогда
					ТекстСообщения = "Збереженого звіту ""Декларація по ПДВ"" ("+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы2+") за "+ПредставлениеПериода(ПараметрыЗаполненияЗвит1С.ДатПрошлогоПериода1, ПараметрыЗаполненияЗвит1С.ДатПрошлогоПериода2, "Л=uk_UA")+" не виявлено!
					                 |Автоматичне заповнення показників рядків 11.1 Додатка 10!";
					глМенеджерЗвит1С.ПредупреждениеЗвит1С(ТекстСообщения, "Завантаження даних з ""FREDO Звіт""");
				КонецЕсли;
			Иначе
				
				R01111GB = Данные.GetValue("MAIN", ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяПоказателяПредыдущейДекларации21);
				ЗаполнитьПоказательНаСервере("R01111GB", R01111GB, ЭтаФорма, "Приложение10");
				
				R02111GB = Данные.GetValue("MAIN", ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяПоказателяПредыдущейДекларации22);
				ЗаполнитьПоказательНаСервере("R02111GB", R02111GB, ЭтаФорма, "Приложение10");
				
				R03111GB = Данные.GetValue("MAIN", ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяПоказателяПредыдущейДекларации23);
				ЗаполнитьПоказательНаСервере("R03111GB", R03111GB, ЭтаФорма, "Приложение10");
				
			КонецЕсли;
			
		Исключение
			
			Если глМенеджерЗвит1С.ФлагОтладки Тогда
				Сообщить("FREDO Звіт. Исключение при получении данных из ""FREDO Звіт"" ("+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ИмяСхемы3+", "+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ТипПериода+", "+ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.НомерПериода+", " +ПараметрыЗаполненияЗвит1С.ПараметрыЗапроса.ГодПериода+")", СтатусСообщения.Важное);
				Сообщить(ОписаниеОшибки(), СтатусСообщения.Информация);
			КонецЕсли;
			
		КонецПопытки;
		
		
		РасчетНаКлиенте();
		
	КонецЕсли;
	
КонецПроцедуры

&НаСервере
Функция ЗаполнитьСтруктурыКолонокМногострочныхЧастей()
	
	Если СтруктураРеквизитовФормы.КолонкиМногострочныхРазделов = Неопределено Тогда
		СтруктураРеквизитовФормы.КолонкиМногострочныхРазделов = Новый Структура;	
	КонецЕсли;
	
	Для каждого Многострочка Из мСтруктураМногострочныхРазделов Цикл
		
		ИмяМногострочки = Многострочка.Ключ;
		
		ДанныеФормы 	= ЭтаФорма[Многострочка.Значение];
		Таблица 		= ДанныеФормыВЗначение(ДанныеФормы, Тип("ТаблицаЗначений"));		
		
		СтруктураКолонок = Новый Массив;
		Для каждого Колонка Из Таблица.Колонки Цикл
			СтруктураКолонок.Добавить(Колонка.Имя);
		КонецЦикла;
		
		СтруктураРеквизитовФормы.КолонкиМногострочныхРазделов.Вставить(ИмяМногострочки, СтруктураКолонок);
		
	КонецЦикла;

КонецФункции

&НаКлиенте
Процедура ПоддержкаДуплекса(Команда)
	
	// инвертируем пометку и значение
	ЕстьДуплекс = СтруктураРеквизитовФормы.ЕстьДуплекс;
	
	СтруктураРеквизитовФормы.Вставить("ЕстьДуплекс", НЕ ЕстьДуплекс);
	Элементы.ЕстьДуплекс.Пометка = НЕ ЕстьДуплекс;
		
КонецПроцедуры

&НаСервере
Функция ПолучитьДанныеФормыНаСервере();
	
	// формируем список сохранения
	СписокСохранения = Новый Структура();
	
	СохранитьДанныеРаздела(СтруктураРеквизитовФормы.НаимТекущегоРаздела, Ложь);
	
	// расшифровка для Звит1С
	Если  СтруктураРеквизитовФормы.Свойство("АдресВременногоХранилищаРасшифровки")
		И ЗначениеЗаполнено(СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки) 
		И СтруктураРеквизитовФормы.Свойство("АдресВременногоХранилищаРасшифровкиОтчетаДляЗвит1С") Тогда
		
		ПоместитьВоВременноеХранилище(ПолучитьИзВременногоХранилища(СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки),
									  СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровкиОтчетаДляЗвит1С); 
		
	КонецЕсли;
	
	ПоказателиОтчета = Новый Структура();
	
	РеквизитыФормы = ПолучитьРеквизиты();
	Для каждого Реквизит Из РеквизитыФормы Цикл
		Если Лев(ВРЕГ(Реквизит.Имя), 15)  = ВРЕГ("СтруктураДанных") Тогда
			ПоказателиОтчета.Вставить(Сред(Реквизит.Имя, 16), ЭтаФорма[Реквизит.Имя]);		
		КонецЕсли;
	КонецЦикла;
	
	Для каждого ИдМногострочногоРаздела Из мСтруктураМногострочныхРазделов Цикл
		
		СтруктураДанных = Новый Структура;
		
		Таблица = РеквизитФормыВЗначение(ИдМногострочногоРаздела.Значение, Тип("ТаблицаЗначений"));
		КолонкиТаблицы = Таблица.Колонки;
		
		Для каждого Строка Из Таблица Цикл
			
			Для каждого Колонка Из КолонкиТаблицы Цикл
				СтруктураДанных.Вставить(Колонка.Имя + "_" + Формат(Таблица.Индекс(Строка) + 1, "ЧГ=0"), Строка[Колонка.Имя]);
			КонецЦикла;
			
		КонецЦикла;
		
		ПоказателиОтчета.Вставить(ИдМногострочногоРаздела.Значение, СтруктураДанных);		
		
	КонецЦикла;	
	
	//ПоказателиОтчета.СлужебныеДанные.Вставить("HNAME",   ПоказателиОтчета.Декларация.HNAME);
	ПоказателиОтчета.СлужебныеДанные.Вставить("HBOS",    ПоказателиОтчета.Декларация.HBOS);
	ПоказателиОтчета.СлужебныеДанные.Вставить("HBUH",    ПоказателиОтчета.Декларация.HBUH);
	//ПоказателиОтчета.СлужебныеДанные.Вставить("HNPDV",   ПоказателиОтчета.Декларация.HNPDV);
	//ПоказателиОтчета.СлужебныеДанные.Вставить("HDDGVIN", ПоказателиОтчета.Декларация.HDDGVIN);
	//ПоказателиОтчета.СлужебныеДанные.Вставить("HNDGVIN", ПоказателиОтчета.Декларация.HNDGVIN);
	
	ПоказателиОтчета.Вставить("ДопПоказателиОтчета", СтруктураРеквизитовФормы.ДопПоказателиОтчетаЗвит1С);
		
	// показатели
	СписокСохранения.Вставить("ДанныеОтчета", ПоказателиОтчета);
	
	Возврат СписокСохранения;
	
КонецФункции

&НаКлиенте
Функция СоздатьДанныеОтчетаДляВыгрузки() Экспорт
	
	АдресВХранилище = СоздатьДанныеОтчетаДляВыгрузкиНаСервере();
	Возврат АдресВХранилище;

КонецФункции

&НаСервере
Функция СоздатьДанныеОтчетаДляВыгрузкиНаСервере()
	
	ДанныеОтчета = ПолучитьДанныеФормыНаСервере();
	Возврат ПоместитьВоВременноеХранилище(ДанныеОтчета, Новый УникальныйИдентификатор);
	
КонецФункции

&НаКлиенте
Функция СоздатьТаблицуВыгружаемыхОтчетныхФорм() Экспорт

	АдресВХранилище = СоздатьТаблицуВыгружаемыхОтчетныхФормНаСервере();
	Возврат АдресВХранилище;

КонецФункции


&НаСервере
Функция СоздатьТаблицуВыгружаемыхОтчетныхФормНаСервере()

	ТаблицаСхемXML = ЗаполнитьТаблицуСоСхемамиВыгрузки();
	ОпределитьСписокВыгружаемыхСхем(ТаблицаСхемXML);

	Возврат ПоместитьВоВременноеХранилище(ТаблицаСхемXML, Новый УникальныйИдентификатор);

КонецФункции

&НаКлиенте
Функция СоздатьСтруктуруСоСхемамиВыгрузки() Экспорт

	АдресВХранилище = СоздатьСтруктуруСоСхемамиВыгрузкиНаСервере();
	Возврат АдресВХранилище;

КонецФункции

&НаСервере
Функция СоздатьСтруктуруСоСхемамиВыгрузкиНаСервере()

	ТипМакетаСхемыXSD = Метаданные.СвойстваОбъектов.ТипМакета.ДвоичныеДанные;

	СтруктураXSD = Новый Структура;
	Объект = ОбъектОтчета(ЭтаФорма.ИмяФормы);

	МетаданныеМактов = Объект.Метаданные().Макеты;

	Для Каждого Макет Из МетаданныеМактов Цикл
		
		Если ВРЕГ(Макет.Имя) = ВРЕГ("АрхивСхемXSD") Тогда
			
			АрхивСхемXSD = Объект.ПолучитьМакет("АрхивСхемXSD");
			
			ВременноеИмяZIP      = ПолучитьИмяВременногоФайла(".zip");
			ВременноеИмяКаталога = ПолучитьИмяВременногоФайла();
			
			АрхивСхемXSD.Записать(ВременноеИмяZIP);
			ЧтениеZIP = Новый ЧтениеZipФайла(ВременноеИмяZIP);
			
			Для каждого Схема Из ЧтениеZIP.Элементы Цикл
				
				ЧтениеZIP.Извлечь(Схема, ВременноеИмяКаталога);
				
				СтруктураXSD.Вставить(Схема.ИмяБезРасширения , Новый ДвоичныеДанные(ВременноеИмяКаталога + "\" + Схема.Имя));
			
			КонецЦикла;
			
			Попытка
				УдалитьФайлы(ВременноеИмяZIP);
			Исключение КонецПопытки;
			
			Попытка
				УдалитьФайлы(ВременноеИмяКаталога);
			Исключение КонецПопытки;
		
		КонецЕсли;
		
		Если Макет.ТипМакета = ТипМакетаСхемыXSD  Тогда
		
			СтруктураXSD.Вставить(Макет.Имя, Объект.ПолучитьМакет(Макет));		
		
		КонецЕсли;	
		
	КонецЦикла;

	Возврат ПоместитьВоВременноеХранилище(СтруктураXSD, Новый УникальныйИдентификатор);

КонецФункции

&НаСервере
Процедура  ОпределитьСписокВыгружаемыхСхем(тбСхемыXML);

	Для Каждого стр Из  тбСхемыXML Цикл
		
		Если стр.НазваниеСтраницыПанели = "Заявление" Тогда
			стр.фВыгрузка = 0;
		ИначеЕсли стр.НазваниеСтраницыПанели = "Филиалы" Тогда	
			Если СтруктураРеквизитовФормы.ОтчетЗаДваМесяца Тогда
				// подается при первом отчете или при изменении состава...
				стр.фВыгрузка = 1;
			иначе	
				стр.фВыгрузка = 0;
			КонецЕсли;
		Иначе	
			//по-умолчанию выгружаем все приложения
			стр.фВыгрузка = 1;
		КонецЕсли;

	КонецЦикла;

КонецПроцедуры	

&НаСервере
Функция ЗаполнитьТаблицуСоСхемамиВыгрузки()

	//для возможности выгрузки в XML файл	
	тбСхемыXML = Новый ТаблицаЗначений;
	ТипКолИмяСхемы = СоздатьОписанияТипов("Строка",8);
	тбСхемыXML.Колонки.Добавить("ИмяСхемы",ТипКолИмяСхемы,НСтр("ru='Имя файла-схемы';uk=""Ім'я файлу-схеми"""));
	ТипКолПредставлениеСхемы = СоздатьОписанияТипов("Строка",80);
	тбСхемыXML.Колонки.Добавить("ПредставлениеСхемы",ТипКолПредставлениеСхемы,НСтр("ru='Наименование регл.отчета';uk='Найменування регл.звіту'"));
	ТипКолНазваниеСтраницыПанели = СоздатьОписанияТипов("Строка",60);
	тбСхемыXML.Колонки.Добавить("НазваниеСтраницыПанели",ТипКолНазваниеСтраницыПанели,НСтр("ru='Наименование страницы панели';uk='Найменування сторінки панелі'"));

	ТипКолфВыгрузка = СоздатьОписанияТипов("Число",1,0);
	тбСхемыXML.Колонки.Добавить("фВыгрузка",ТипКолфВыгрузка,НСтр("ru='Выгружать?';uk='Вивантажувати?'"));
	ТипКолНазваниеСтраницыПанели = СоздатьОписанияТипов("Строка",60);
	ТипПрефикса = СоздатьОписанияТипов("Строка",10);
	тбСхемыXML.Колонки.Добавить("Префикс",ТипПрефикса,НСтр("ru='Префикс';uk='Префікс'"));

	тбСхемыXML.Колонки.Добавить("Тип", ,НСтр("ru='Тип';uk='Тип'"));

	ЮрЛицо = (СтруктураРеквизитовФормы.ОрганизацияЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо);

	Если ЮрЛицо Тогда
		
		Если ЗначениеЗаполнено(ПолучитьПоказательНаСервере("HZG",ЭтаФорма,"Декларация")) Тогда
			// 0110 - общая
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0200118"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Декларация о НДС';uk='Декларація про ПДВ'");
			НовСтрока.НазваниеСтраницыПанели ="Декларация";
	        НовСтрока.Префикс = "Д";

			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0200516"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 1 (Расчет корректировки сумм НДС)';uk='Додаток 1 (Розрахунок коригування сум ПДВ)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение1";
			
			НовСтрока= тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0215209"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 2 (Справка про остаток сум прошлых периодов)';uk='Додаток 2 (Довідка щодо залишку суми попередніх періодів)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение2";
			НовСтрока.Префикс = "П2";

			НовСтрока= тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0200614"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 3 (Расчет суммы бюджетного возмещения)';uk='Додаток 3 (Розрахунок суми бюджетного відшкодування)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение3";
			НовСтрока.Префикс = "П3";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0299810";
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 4 (Заявление про возврат суммы бюджетного возмещения)';uk='Додаток 4(Заява про повернення сумми бюджетного відшкодування)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение4";
			НовСтрока.Префикс ="П4";

			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0215109";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 5 (Расшифровка налоговых обязательств)';uk='Додаток 5(Розшифровка податкових забов''язань)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение5";
			НовСтрока.Префикс ="П5";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0299309";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 6 (Справка)';uk='Додаток 6 (Довідка)'");
			НовСтрока.НазваниеСтраницыПанели ="Справка";
			НовСтрока.Префикс ="С1";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0215709"; 
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 7 ';uk='Додаток 7 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение7";
			НовСтрока.Префикс ="П7";
			                                    
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0215808";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 8 ';uk='Додаток 8 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение8";
			НовСтрока.Префикс ="П8";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0299708";
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Заявление о выборе квартального отчетного (налогового) периода';uk='Заява про вибір квартального звітного (податкового) періоду'");
			НовСтрока.НазваниеСтраницыПанели ="Заявление";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0215607";
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Сообщение о делегировании филиалам права выписки налоговых накладных';uk= 'Повідомлення про делегування філіям права виписки податкових накладних'");
			НовСтрока.НазваниеСтраницыПанели ="Филиалы";
			НовСтрока.Префикс ="Ф";
			
		ИначеЕсли (ЗначениеЗаполнено(ПолучитьПоказательНаСервере("HSG",ЭтаФорма,"Декларация")))
		      ИЛИ (ЗначениеЗаполнено(ПолучитьПоказательНаСервере("HLG",ЭтаФорма,"Декларация")))
			  ИЛИ (ЗначениеЗаполнено(ПолучитьПоказательНаСервере("HRB",ЭтаФорма,"Декларация"))) Тогда
				  
			// 012* - бывшая сокращенная
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0209010"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Декларация о НДС';uk='Декларація про ПДВ'");
			НовСтрока.НазваниеСтраницыПанели ="Декларация";
	        НовСтрока.Префикс = "Д";

			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0209110"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 1 (Расчет корректировки сумм НДС)';uk='Додаток 1 (Розрахунок коригування сум ПДВ)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение1";
				
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0209209";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 5 (Расшифровка налоговых обязательств)';uk='Додаток 5(Розшифровка податкових забов''язань)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение5";
			НовСтрока.Префикс ="П5";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0299009";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 6 (Справка)';uk='Додаток 6 (Довідка)'");
			НовСтрока.НазваниеСтраницыПанели ="Справка";
			НовСтрока.Префикс ="С1";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0290706"; 
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 7 ';uk='Додаток 7 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение7";
			НовСтрока.Префикс ="П7";
			                                    
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0290508";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 8 ';uk='Додаток 8 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение8";
			НовСтрока.Префикс ="П8";

			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0209309";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение ДС9 ';uk='Додаток ДС9 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение9";
			НовСтрока.Префикс ="П9";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0290802";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение ДС10 ';uk='Додаток ДС10 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение10";
			НовСтрока.Префикс ="П10";
		
		ИначеЕсли (ЗначениеЗаполнено(ПолучитьПоказательНаСервере("HNS",ЭтаФорма,"Декларация"))) Тогда
				  
			// 0130 - бывшая специальная
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0209409"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Декларация о НДС';uk='Декларація про ПДВ'");
			НовСтрока.НазваниеСтраницыПанели ="Декларация";
	        НовСтрока.Префикс = "Д";

			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0294109"; 
			НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 1 (Расчет корректировки сумм НДС)';uk='Додаток 1 (Розрахунок коригування сум ПДВ)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение1";
				
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0294209";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 5 (Расшифровка налоговых обязательств)';uk='Додаток 5(Розшифровка податкових забов''язань)'");
			НовСтрока.НазваниеСтраницыПанели ="Приложение5";
			НовСтрока.Префикс ="П5";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0294009";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 6 (Справка)';uk='Додаток 6 (Довідка)'");
			НовСтрока.НазваниеСтраницыПанели ="Справка";
			НовСтрока.Префикс ="С1";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0294606"; 
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 7 ';uk='Додаток 7 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение7";
			НовСтрока.Префикс ="П7";
			                                    
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0294508";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 8 ';uk='Додаток 8 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение8";
			НовСтрока.Префикс ="П8";

			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0294309";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение ДС9 ';uk='Додаток ДС9 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение9";
			НовСтрока.Префикс ="П9";
			
			НовСтрока = тбСхемыXML.Добавить();
			НовСтрока.ИмяСхемы = "J0294402";
			НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение ДС10 ';uk='Додаток ДС10 '");
			НовСтрока.НазваниеСтраницыПанели ="Приложение10";
			НовСтрока.Префикс ="П10";
			
		КонецЕсли;
		
	Иначе // физ. лицо	
		
		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0200118"; 
		НовСтрока.ПредставлениеСхемы =НСтр("ru='Декларация о НДС';uk='Декларація про ПДВ'");
		НовСтрока.НазваниеСтраницыПанели ="Декларация";
		НовСтрока.Префикс = "Д";
		
		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0200416"; 
		НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 1 (Расчет корректировки сумм НДС)';uk='Додаток 1 (Розрахунок коригування сум ПДВ)'");
		НовСтрока.НазваниеСтраницыПанели ="Приложение1";
		
		НовСтрока= тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0215209"; 
		НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 2 (Расчет суммы. подлежащей уплате в бюджет)';uk='Додаток 2 (Розрахунок суми, що підлягає сплаті в бюджет)'");
		НовСтрока.НазваниеСтраницыПанели ="Приложение2";
		НовСтрока.Префикс = "П2";

		НовСтрока= тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0200514"; 
		НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 3 (Расчет суммы бюджетного возмещения)';uk='Додаток 3 (Розрахунок суми бюджетного відшкодування)'");
		НовСтрока.НазваниеСтраницыПанели ="Приложение3";
		НовСтрока.Префикс = "П3";

		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0299810";
		НовСтрока.ПредставлениеСхемы =НСтр("ru='Приложение 4 (Заявление про возврат суммы бюджетного возмещения)';uk='Додаток 4(Заява про повернення сумми бюджетного відшкодування)'");
		НовСтрока.НазваниеСтраницыПанели ="Приложение4";
		НовСтрока.Префикс ="П4";
		
		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0215109";
		НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 5 (Расшифровка налоговых обязательств)';uk='Додаток 5(Розшифровка податкових забов''язань)'");
		НовСтрока.НазваниеСтраницыПанели ="Приложение5";
		НовСтрока.Префикс ="П5";
		
		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0299309";
		НовСтрока.ПредставлениеСхемы = НСтр("ru='Справка ""Необлагаемые и освобожденные операции от НДС "" ';uk='Довідка ""Операції, що не є об''єктом оподаткування  і звільненні від сплати НДС"" '");
		НовСтрока.НазваниеСтраницыПанели ="Справка";
		НовСтрока.Префикс ="С1";

		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0215709"; 
		НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 7 ';uk='Додаток 7 '");
		НовСтрока.НазваниеСтраницыПанели ="Приложение7";
		НовСтрока.Префикс ="П7";
		                                    
		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0215808";
		НовСтрока.ПредставлениеСхемы = НСтр("ru='Приложение 8 ';uk='Додаток 8 '");
		НовСтрока.НазваниеСтраницыПанели ="Приложение8";
		НовСтрока.Префикс ="П8";
		
		НовСтрока = тбСхемыXML.Добавить();
		НовСтрока.ИмяСхемы = "F0299708";
		НовСтрока.ПредставлениеСхемы =НСтр("ru='Заявление о выборе квартального отчетного (налогового) периода';uk='Заява про вибір квартального звітного (податкового) періоду'");
		НовСтрока.НазваниеСтраницыПанели ="Заявление";
		
	Конецесли;
	
	тбСхемыXML.ЗаполнитьЗначения(Перечисления.ВерсииФорматовВыгрузки.ГНСУ_XML, "Тип");

	Возврат  тбСхемыXML

КонецФункции

&НаКлиенте
Процедура Расшифровать(Команда)
	
	ПараметрыОтчета = Новый Структура();
	ПараметрыОтчета.Вставить("Организация", 			СтруктураРеквизитовФормы.Организация);
	ПараметрыОтчета.Вставить("мДатаНачалаПериодаОтчета", СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета);
	ПараметрыОтчета.Вставить("мДатаКонцаПериодаОтчета",  СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
	ПараметрыОтчета.Вставить("АдресВременногоХранилищаРасшифровки", СтруктураРеквизитовФормы.АдресВременногоХранилищаРасшифровки);
	ПараметрыОтчета.Вставить("НаимТекущегоРаздела", СтруктураРеквизитовФормы.НаимТекущегоРаздела);
	
	ИДИменПоказателей = Новый Массив();
	ИДИменПоказателей.Добавить(Элементы.ТабличныйДокумент.ТекущаяОбласть.Имя);
	
	РегламентированнаяОтчетностьКлиент.ОткрытьРасшифровкуОтчета(Сред(Лев(ЭтаФорма.ИмяФормы, Найти(ЭтаФорма.ИмяФормы, ".Форма.") - 1), 7), Сред(ЭтаФорма.ИмяФормы, Найти(ЭтаФорма.ИмяФормы, ".Форма.") + 7), ИДИменПоказателей, ПараметрыОтчета);
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьФормуПараметровДляЗвит1С(ОписаниеОповещения) Экспорт
	
	глКомпонентаЗвит1С.Bring1CToFront();
	СтруктураРеквизитовФормы.Вставить("ОповещениеНастройкиПараметровЗвит1С", ОписаниеОповещения);
	
	Если глМенеджерЗвит1С.ФлагОтладки Тогда

		ФормаСохраненныхРеглОтчетов = ПолучитьФорму("Документ.РегламентированныйОтчет.Форма.ФормаВыбораТестЗвит1С",,ЭтаФорма);
		
		ФормаСохраненныхРеглОтчетов.ОписаниеОповещенияОЗакрытии =  Новый ОписаниеОповещения("РежимТестированияЗвит1СЗавершениеВыбораОтчета", ЭтотОбъект);
		ФормаСохраненныхРеглОтчетов.Параметры.РежимВыбора        = Истина; 
		ФормаСохраненныхРеглОтчетов.РежимОткрытияОкна = РежимОткрытияОкнаФормы.БлокироватьОкноВладельца;
		ФормаСохраненныхРеглОтчетов.Открыть();
		
	Иначе
		
		ОткрытьФормуПараметров(Неопределено);	
		
	КонецЕсли;

КонецПроцедуры

&НаКлиенте
Процедура РежимТестированияЗвит1СЗавершениеВыбораОтчета(Результат, ДопПараметры) Экспорт
	
	Если НЕ Результат = Неопределено Тогда
		
		ТекОповещение = СтруктураРеквизитовФормы.ОповещениеНастройкиПараметровЗвит1С;
		СтруктураРеквизитовФормы.Удалить("ОповещениеНастройкиПараметровЗвит1С");
			
		СтруктураРеквизитовФормы.мСохраненныйДок = Результат;	
		ВосстановитьСохраненныеДанные();	
			
		СтруктураРеквизитовФормы.Вставить("ОповещениеНастройкиПараметровЗвит1С", ТекОповещение);
		
		ВыполнитьОбработкуОповещения(СтруктураРеквизитовФормы.ОповещениеНастройкиПараметровЗвит1С, Неопределено);
		
	Иначе
		
		ОткрытьФормуПараметров(Неопределено);	
		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура ОткрытьФормуПараметровЗавершение(ПараметрыВозврата, ДополнительныеПараметры) Экспорт
	
	Если СтруктураРеквизитовФормы.Свойство("ОповещениеНастройкиПараметровЗвит1С") Тогда
		ВыполнитьОбработкуОповещения(СтруктураРеквизитовФормы.ОповещениеНастройкиПараметровЗвит1С, Неопределено);
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Функция СформироватьДанныеДляЗвит1С(ОтчетЗвит1С = Неопределено) Экспорт 
	
	мСписокСообщенийЗвит1С 	= Новый СписокЗначений;
	
	// Настроим модуль объекта на получене данных для Звита
	СтруктураРеквизитовФормы.ПолучениеДанныхДляЗвит1С = Истина;
	Если СтруктураРеквизитовФормы.Свойство("ОповещениеНастройкиПараметровЗвит1С") Тогда
		СтруктураРеквизитовФормы.Удалить("ОповещениеНастройкиПараметровЗвит1С")	
	КонецЕсли;
	
	////Модифицированность = Ложь;
	////Комментарий = "Звіт створений для збереження параметрів заповнення ""FREDO Звіт""";
	////мСохраненныйДок = Неопределено;
	////Если СтруктураРеквизитовФормы.Свойство("ХранилищеПараметровДляЗвит1С", мСохраненныйДок) Тогда
	////	СтруктураРеквизитовФормы.мСохраненныйДок = мСохраненныйДок;
	////КонецЕсли;
	////
	////Сохранить(Ложь, "Декларация");

	УстановитьФлажкиНаСервереДляЗаполнения(глМенеджерЗвит1С.ИмяСхемыЗвит1С);
	
	Если НЕ глМенеджерЗвит1С.ФлагОтладки Тогда
		ПараметрыЗаполненияЗвит1С = Неопределено;
		ЗаполнитьАвтоНаСервере(ПараметрыЗаполненияЗвит1С);
		ДозаполнитьНаКлиенте(ПараметрыЗаполненияЗвит1С);
	КонецЕсли;
	
	Результат = ПолучитьДанныеФормыНаСервере();
	
	Для каждого Сообщение Из мСписокСообщенийЗвит1С Цикл
		глМенеджерЗвит1С.ПредупреждениеЗвит1С(Сообщение.Представление, ,Сообщение.Значение);
	КонецЦикла;
	
	мСписокСообщенийЗвит1С.Очистить();
	
	Возврат Результат;
	
КонецФункции

&НаСервере	
Процедура УстановитьФлажкиНаСервереДляЗаполнения(ИмяСхемы)	
	
	// установим требуем спец.режим по виду схемы
	ЗаполнитьПоказательНаСервере("HZG", "", ЭтаФорма, "Декларация");
	ЗаполнитьПоказательНаСервере("HSG", "", ЭтаФорма, "Декларация");
	ЗаполнитьПоказательНаСервере("HLG", "", ЭтаФорма, "Декларация");
	ЗаполнитьПоказательНаСервере("HRB", "", ЭтаФорма, "Декларация");
	ЗаполнитьПоказательНаСервере("HNS", "", ЭтаФорма, "Декларация");
	
	Если ВРЕГ(Лев(ИмяСхемы, 1)) = "F" Тогда
		// общая (физ. лица)
		ЗаполнитьПоказательНаСервере("HLG", "Х", ЭтаФорма, "Декларация");
		СтруктураРеквизитовФормы.СпецРежим = 0;
	Иначе	
		
		// специальная
		ЗаполнитьПоказательНаСервере("HNS", "Х", ЭтаФорма, "Декларация");
		тбСхемыXML = ЗаполнитьТаблицуСоСхемамиВыгрузки();
		Если тбСхемыXML.Найти(ИмяСхемы, "ИмяСхемы") = Неопределено Тогда	
			ЗаполнитьПоказательНаСервере("HNS", "", ЭтаФорма, "Декларация");
			// сокращенная
			ЗаполнитьПоказательНаСервере("HSG", "X", ЭтаФорма, "Декларация");
			тбСхемыXML = ЗаполнитьТаблицуСоСхемамиВыгрузки();
			Если тбСхемыXML.Найти(ИмяСхемы, "ИмяСхемы") = Неопределено Тогда	
				ЗаполнитьПоказательНаСервере("HNS", "", ЭтаФорма, "Декларация");
				// общая
				ЗаполнитьПоказательНаСервере("HZG", "X", ЭтаФорма, "Декларация");
				// общая
				СтруктураРеквизитовФормы.СпецРежим = 0;
			Иначе
				// сокращенная
				СтруктураРеквизитовФормы.СпецРежим = 2;	
			КонецЕсли;
			
		Иначе	
			// специальная
			СтруктураРеквизитовФормы.СпецРежим = 3;
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры	

&НаСервере
Процедура _ДобавитьСтрокуРасшифровки(Форма, ИмяЯчейки, ИмяПоказателя, ЗнакОперации, ИмяСлагаемого, Сумма, Счет = Неопределено, КорСчет = Неопределено, Сдвиг = Неопределено, ПраваяГраница = Неопределено, ИмяРаздела = Неопределено, НомерЛиста = Неопределено, МнЧ = Неопределено, НомерСтроки = Неопределено, Субконто1 = Неопределено, Субконто2 = Неопределено, Субконто3 = Неопределено)
	
	
	ТребуемыеОбщиеПараметры =  ОбщиеПараметрыРасшифровки;
	
	Если Лев(ИмяСлагаемого, 1) = "#" Тогда
		
		ДополнительныеПараметры = Новый Структура;
		ДополнительныеПараметры.Вставить("Организация", Форма.СтруктураРеквизитовФормы.Организация);

	КонецЕсли;
	
	
	Представление = ИмяСлагаемого + " " + Счет + ?(ЗначениеЗаполнено(КорСчет)," " + КорСчет, "");
	
	//ЗаполнениеРасшифровкаРегламентированнойОтчетности.ДобавитьСтрокуРасшифровки(ТаблицаРасшифровки, ИмяЯчейки, ИмяПоказателя, ЗнакОперации, Представление, Сумма, "ДекларацияНДС", ДополнительныеПараметры);
	ЗаполнениеРасшифровкаРегламентированнойОтчетности.ДобавитьСтрокуРасшифровки(ТаблицаРасшифровки, ИмяЯчейки, ИмяПоказателя, ЗнакОперации, Представление, Сумма, ИмяРаздела, ДополнительныеПараметры);
	

КонецПроцедуры

&НаСервере
Функция СоздатьОписанияТипов(НазваниеТипа, Длина,Точность="")
	
	мас = Новый Массив;
	мас.Добавить(Тип(НазваниеТипа));
	Если Точность = "" Тогда
		КвалифСтроки = Новый КвалификаторыСтроки(Длина,ДопустимаяДлина.Переменная); 
	Иначе
		КвалифЧисла = Новый КвалификаторыЧисла(Длина,Точность,ДопустимыйЗнак.Неотрицательный); 
	КонецЕсли;	   
	Возврат Новый ОписаниеТипов(мас,КвалифСтроки,КвалифЧисла);
  
КонецФункции	

&НаСервере
Функция ОбъектОтчета(ЭтаФормаИмя)
	
	Если мОбъектОтчета = Неопределено Тогда 
		мОбъектОтчета = РегламентированнаяОтчетностьВызовСервера.ОбъектОтчета(ЭтаФормаИмя);
	КонецЕсли;
	
	Возврат мОбъектОтчета;
	
КонецФункции

&НаКлиенте
Процедура ОткрытьФормуПараметров(Команда)

	мПараметрыФормы = Новый Структура;
	мПараметрыФормы.Вставить("мДатаНачалаПериодаОтчета", 	СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета);
	мПараметрыФормы.Вставить("мДатаКонцаПериодаОтчета", 	СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
	
	мПараметрыФормы.Вставить("ОтчетЗаДваМесяца", 				СтруктураРеквизитовФормы.ОтчетЗаДваМесяца);
	мПараметрыФормы.Вставить("НеВыдаватьСообщенияОбОшибкахВРасчете", СтруктураРеквизитовФормы.НеВыдаватьСообщенияОбОшибкахВРасчете);
	
	мПараметрыФормы.Вставить("К1", СтруктураРеквизитовФормы.К1);
	мПараметрыФормы.Вставить("К2", СтруктураРеквизитовФормы.К2);
	мПараметрыФормы.Вставить("К3", СтруктураРеквизитовФормы.К3);
	
	мПараметрыФормы.Вставить("Организация", 			СтруктураРеквизитовФормы.Организация);
	
	ИмяФормыПараметровНастройки = СтрЗаменить(ЭтаФорма.ИмяФормы, "ФормаОтчета", "ПараметрыОтчета");
	
	ФормаНастройкиОтчета = ПолучитьФорму(ИмяФормыПараметровНастройки, мПараметрыФормы, ЭтаФорма);
	
	
	ОписаниеОповещения = Новый ОписаниеОповещения("ОткрытьФормуПараметровЗавершение", ЭтотОбъект);
	ФормаНастройкиОтчета.ОписаниеОповещенияОЗакрытии = ОписаниеОповещения;
	
	ФормаНастройкиОтчета.РежимОткрытияОкна = РежимОткрытияОкнаФормы.БлокироватьОкноВладельца;
	ФормаНастройкиОтчета.Открыть();
	
КонецПроцедуры	

//ИНАГРО ++
&НаСервере
Процедура ВнестиИнфоВПриложение9()
	
	Запрос = Новый Запрос;
	Запрос.Текст =  "ВЫБРАТЬ
	                |	НДСНалоговыеОбязательстваОбороты.Регистратор КАК Регистратор
	                |ПОМЕСТИТЬ НДСНалоговыеОбязательстваОбороты
	                |ИЗ
	                |	РегистрНакопления.НДСНалоговыеОбязательства КАК НДСНалоговыеОбязательстваОбороты
	                |ГДЕ
	                |	НДСНалоговыеОбязательстваОбороты.Организация = &Организация
	                |	И НДСНалоговыеОбязательстваОбороты.Активность
	                |	И НДСНалоговыеОбязательстваОбороты.Период >= НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&НачДата, МЕСЯЦ, -12), МЕСЯЦ)
	                |	И НДСНалоговыеОбязательстваОбороты.Период <= &КонДата
	                |	И НЕ ЕСТЬNULL(НДСНалоговыеОбязательстваОбороты.Регистратор.ВключаетсяВУточняющийРасчет, ЛОЖЬ)
	                |;
	                |
	                |////////////////////////////////////////////////////////////////////////////////
	                |ВЫБРАТЬ
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НалоговаяНакладнаяТовары.Ссылка.Дата, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ) КАК Период,
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяТовары.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ НалоговаяНакладнаяТовары.СтавкаНДС
	                |	КОНЕЦ КАК СтавкаНДС,
	                |	НалоговаяНакладнаяТовары.СтатьяДекларацииНДСНалоговыеОбязательства КАК СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	НалоговаяНакладнаяТовары.Номенклатура.ИНАГРО_ВидПродукции КАК НоменклатураИНАГРО_ВидПродукции,
	                |	СУММА(ВЫРАЗИТЬ(НалоговаяНакладнаяТовары.СуммаНДС * ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяТовары.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяТовары.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяТовары.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяТовары.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))) КАК СуммаНДС,
	                |	СУММА(ВЫРАЗИТЬ(ВЫБОР
	                |				КОГДА НалоговаяНакладнаяТовары.Ссылка.СуммаВключаетНДС
	                |					ТОГДА НалоговаяНакладнаяТовары.Сумма - НалоговаяНакладнаяТовары.СуммаНДС
	                |				ИНАЧЕ НалоговаяНакладнаяТовары.Сумма
	                |			КОНЕЦ * ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяТовары.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяТовары.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяТовары.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяТовары.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))) КАК Сумма,
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяТовары.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ КАК ЭтоУсловнаяПродажа,
	                |	НалоговаяНакладнаяТовары.Ссылка.СпецРежимНалогообложения,
	                |	НалоговаяНакладнаяТовары.Ссылка.Дата
	                |ИЗ
	                |	Документ.НалоговаяНакладная.Товары КАК НалоговаяНакладнаяТовары
	                |ГДЕ
	                |	НалоговаяНакладнаяТовары.Ссылка В
	                |			(ВЫБРАТЬ
	                |				НДСНалоговыеОбязательстваОбороты.Регистратор
	                |			ИЗ
	                |				НДСНалоговыеОбязательстваОбороты КАК НДСНалоговыеОбязательстваОбороты)
	                |
	                |СГРУППИРОВАТЬ ПО
	                |	НалоговаяНакладнаяТовары.Номенклатура.ИНАГРО_ВидПродукции,
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяТовары.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ,
	                |	НалоговаяНакладнаяТовары.СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	НалоговаяНакладнаяТовары.Ссылка.СпецРежимНалогообложения,
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НалоговаяНакладнаяТовары.Ссылка.Дата, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ),
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяТовары.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ НалоговаяНакладнаяТовары.СтавкаНДС
	                |	КОНЕЦ,
	                |	НалоговаяНакладнаяТовары.Ссылка.Дата
	                |
	                |ОБЪЕДИНИТЬ ВСЕ
	                |
	                |ВЫБРАТЬ
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НалоговаяНакладнаяУслуги.Ссылка.Дата, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ),
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяУслуги.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ НалоговаяНакладнаяУслуги.СтавкаНДС
	                |	КОНЕЦ,
	                |	НалоговаяНакладнаяУслуги.СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	НалоговаяНакладнаяУслуги.Номенклатура.ИНАГРО_ВидПродукции,
	                |	СУММА(ВЫРАЗИТЬ(НалоговаяНакладнаяУслуги.СуммаНДС * ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяУслуги.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяУслуги.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяУслуги.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяУслуги.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))),
	                |	СУММА(ВЫРАЗИТЬ(ВЫБОР
	                |				КОГДА НалоговаяНакладнаяУслуги.Ссылка.СуммаВключаетНДС
	                |					ТОГДА НалоговаяНакладнаяУслуги.Сумма - НалоговаяНакладнаяУслуги.СуммаНДС
	                |				ИНАЧЕ НалоговаяНакладнаяУслуги.Сумма
	                |			КОНЕЦ * ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяУслуги.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяУслуги.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(НалоговаяНакладнаяУслуги.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ НалоговаяНакладнаяУслуги.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))),
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяУслуги.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ,
	                |	НалоговаяНакладнаяУслуги.Ссылка.СпецРежимНалогообложения,
	                |	НалоговаяНакладнаяУслуги.Ссылка.Дата
	                |ИЗ
	                |	Документ.НалоговаяНакладная.Услуги КАК НалоговаяНакладнаяУслуги
	                |ГДЕ
	                |	НалоговаяНакладнаяУслуги.Ссылка В
	                |			(ВЫБРАТЬ
	                |				НДСНалоговыеОбязательстваОбороты.Регистратор
	                |			ИЗ
	                |				НДСНалоговыеОбязательстваОбороты КАК НДСНалоговыеОбязательстваОбороты)
	                |
	                |СГРУППИРОВАТЬ ПО
	                |	НалоговаяНакладнаяУслуги.Номенклатура.ИНАГРО_ВидПродукции,
	                |	НалоговаяНакладнаяУслуги.СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяУслуги.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ,
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(НалоговаяНакладнаяУслуги.Ссылка.Дата, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ),
	                |	НалоговаяНакладнаяУслуги.Ссылка.СпецРежимНалогообложения,
	                |	ВЫБОР
	                |		КОГДА НалоговаяНакладнаяУслуги.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ НалоговаяНакладнаяУслуги.СтавкаНДС
	                |	КОНЕЦ,
	                |	НалоговаяНакладнаяУслуги.Ссылка.Дата
	                |
	                |ОБЪЕДИНИТЬ ВСЕ
	                |
	                |ВЫБРАТЬ
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
	                |				КОГДА Приложение2КНалоговойНакладнойТовары.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	                |					ТОГДА Приложение2КНалоговойНакладнойТовары.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойТовары.Ссылка.Дата
	                |			КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ),
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойТовары.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ Приложение2КНалоговойНакладнойТовары.СтавкаНДС
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойТовары.СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	Приложение2КНалоговойНакладнойТовары.Номенклатура.ИНАГРО_ВидПродукции,
	                |	СУММА(ВЫРАЗИТЬ(Приложение2КНалоговойНакладнойТовары.ИзменениеСуммыНДС * ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойТовары.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойТовары.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойТовары.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойТовары.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))),
	                |	СУММА(ВЫРАЗИТЬ(ВЫБОР
	                |				КОГДА Приложение2КНалоговойНакладнойТовары.Ссылка.СуммаВключаетНДС
	                |					ТОГДА Приложение2КНалоговойНакладнойТовары.ИзменениеСуммы - Приложение2КНалоговойНакладнойТовары.ИзменениеСуммыНДС
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойТовары.ИзменениеСуммы
	                |			КОНЕЦ * ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойТовары.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойТовары.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойТовары.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойТовары.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))),
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойТовары.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойТовары.Ссылка.СпецРежимНалогообложения,
	                |	Приложение2КНалоговойНакладнойТовары.Ссылка.Дата
	                |ИЗ
	                |	Документ.Приложение2КНалоговойНакладной.Товары КАК Приложение2КНалоговойНакладнойТовары
	                |ГДЕ
	                |	Приложение2КНалоговойНакладнойТовары.Ссылка В
	                |			(ВЫБРАТЬ
	                |				НДСНалоговыеОбязательстваОбороты.Регистратор
	                |			ИЗ
	                |				НДСНалоговыеОбязательстваОбороты КАК НДСНалоговыеОбязательстваОбороты)
	                |
	                |СГРУППИРОВАТЬ ПО
	                |	Приложение2КНалоговойНакладнойТовары.Номенклатура.ИНАГРО_ВидПродукции,
	                |	Приложение2КНалоговойНакладнойТовары.СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойТовары.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойТовары.Ссылка.СпецРежимНалогообложения,
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойТовары.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ Приложение2КНалоговойНакладнойТовары.СтавкаНДС
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойТовары.Ссылка.Дата,
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
	                |				КОГДА Приложение2КНалоговойНакладнойТовары.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	                |					ТОГДА Приложение2КНалоговойНакладнойТовары.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойТовары.Ссылка.Дата
	                |			КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ)
	                |
	                |ОБЪЕДИНИТЬ ВСЕ
	                |
	                |ВЫБРАТЬ
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
	                |				КОГДА Приложение2КНалоговойНакладнойУслуги.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	                |					ТОГДА Приложение2КНалоговойНакладнойУслуги.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.Ссылка.Дата
	                |			КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ),
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойУслуги.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.СтавкаНДС
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойУслуги.СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	Приложение2КНалоговойНакладнойУслуги.Номенклатура.ИНАГРО_ВидПродукции,
	                |	СУММА(ВЫРАЗИТЬ(Приложение2КНалоговойНакладнойУслуги.ИзменениеСуммыНДС * ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойУслуги.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойУслуги.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))),
	                |	СУММА(ВЫРАЗИТЬ(ВЫБОР
	                |				КОГДА Приложение2КНалоговойНакладнойУслуги.Ссылка.СуммаВключаетНДС
	                |					ТОГДА Приложение2КНалоговойНакладнойУслуги.ИзменениеСуммы - Приложение2КНалоговойНакладнойУслуги.ИзменениеСуммыНДС
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.ИзменениеСуммы
	                |			КОНЕЦ * ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойУслуги.Ссылка.КурсВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.Ссылка.КурсВзаиморасчетов
	                |			КОНЕЦ / ВЫБОР
	                |				КОГДА ЕСТЬNULL(Приложение2КНалоговойНакладнойУслуги.Ссылка.КратностьВзаиморасчетов, 0) = 0
	                |					ТОГДА 1
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.Ссылка.КратностьВзаиморасчетов
	                |			КОНЕЦ КАК ЧИСЛО(15, 2))),
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойУслуги.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойУслуги.Ссылка.СпецРежимНалогообложения,
	                |	Приложение2КНалоговойНакладнойУслуги.Ссылка.Дата
	                |ИЗ
	                |	Документ.Приложение2КНалоговойНакладной.Услуги КАК Приложение2КНалоговойНакладнойУслуги
	                |ГДЕ
	                |	Приложение2КНалоговойНакладнойУслуги.Ссылка В
	                |			(ВЫБРАТЬ
	                |				НДСНалоговыеОбязательстваОбороты.Регистратор
	                |			ИЗ
	                |				НДСНалоговыеОбязательстваОбороты КАК НДСНалоговыеОбязательстваОбороты)
	                |
	                |СГРУППИРОВАТЬ ПО
	                |	Приложение2КНалоговойНакладнойУслуги.Номенклатура.ИНАГРО_ВидПродукции,
	                |	Приложение2КНалоговойНакладнойУслуги.СтатьяДекларацииНДСНалоговыеОбязательства,
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойУслуги.Ссылка.ВидОперации В (&УсловнаяПродажа)
	                |			ТОГДА ИСТИНА
	                |		ИНАЧЕ ЛОЖЬ
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойУслуги.Ссылка.СпецРежимНалогообложения,
	                |	ВЫБОР
	                |		КОГДА Приложение2КНалоговойНакладнойУслуги.СтавкаНДС = ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.СпецСт8)
	                |			ТОГДА ЗНАЧЕНИЕ(Перечисление.СтавкиНДС.НДС20)
	                |		ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.СтавкаНДС
	                |	КОНЕЦ,
	                |	Приложение2КНалоговойНакладнойУслуги.Ссылка.Дата,
	                |	13 - РАЗНОСТЬДАТ(НАЧАЛОПЕРИОДА(ВЫБОР
	                |				КОГДА Приложение2КНалоговойНакладнойУслуги.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных <> ДАТАВРЕМЯ(1, 1, 1, 0, 0, 0)
	                |					ТОГДА Приложение2КНалоговойНакладнойУслуги.Ссылка.ДатаВключенияВЕдиныйРеестрНалоговыхНакладных
	                |				ИНАЧЕ Приложение2КНалоговойНакладнойУслуги.Ссылка.Дата
	                |			КОНЕЦ, МЕСЯЦ), НАЧАЛОПЕРИОДА(&КонДата, МЕСЯЦ), МЕСЯЦ)
	                |ИТОГИ ПО
	                |	Период";
	
	Запрос.УстановитьПараметр ("НачДата",   СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета);
	Запрос.УстановитьПараметр ("СпецРежим", СтруктураРеквизитовФормы.СпецРежим);
	
	УсловнаяПродажа = Новый Массив();
	УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.УсловнаяПродажа);
	УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийНалоговаяНакладная.УсловнаяПродажаСписаниеОС);
	УсловнаяПродажа.Добавить(Перечисления.ВидыОперацийПриложение2КНалоговойНакладной.УсловнаяПродажаВозврат);
	
	Запрос.УстановитьПараметр ("УсловнаяПродажа", УсловнаяПродажа);
	
	Если СтруктураРеквизитовФормы.ОтчетЗаДваМесяца Тогда
		Запрос.УстановитьПараметр ("НачДата", ДобавитьМесяц(СтруктураРеквизитовФормы.мДатаНачалаПериодаОтчета, -1));	
	КонецЕсли;
	
	Запрос.УстановитьПараметр ("КонДата", СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
	Запрос.УстановитьПараметр ("Организация", СтруктураРеквизитовФормы.Организация);
	
	СтрокиДекларацииНДС = Справочники.СтатьиНалоговыхДеклараций;
	
	РезультатПериод = Запрос.Выполнить().Выбрать(ОбходРезультатаЗапроса.ПоГруппировкам,"Период");
	Пока РезультатПериод.Следующий() Цикл
		НомерСтроки = Формат(РезультатПериод.Период,"ЧЦ=2; ЧВН=");
		РезультатВидПродукции = РезультатПериод.Выбрать(ОбходРезультатаЗапроса.Прямой);
		Пока РезультатВидПродукции.Следующий() Цикл
			Если РезультатВидПродукции.СпецРежимНалогообложения = 2 или РезультатВидПродукции.СпецРежимНалогообложения = 3 или РезультатВидПродукции.СпецРежимНалогообложения = 4 Тогда
				Если РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОПоСтавке0Экспорт  Тогда
					Если РезультатВидПродукции.ЭтоУсловнаяПродажа = Истина Тогда
					Иначе
						Если РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.ЗерновыеТехнические ИЛИ РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.ПустаяСсылка() ТОгда
							Если НомерСтроки = "13" Тогда
								СтруктураДанныхПриложение10.R0102GA = СтруктураДанныхПриложение10.R0102GA + РезультатВидПродукции.Сумма;
							Иначе
								СтруктураДанныхПриложение9["R0"+НомерСтроки+"G3"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G3"] + РезультатВидПродукции.Сумма;
							КонецЕсли;
						ИначеЕсли РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.Животноводство Тогда
							Если НомерСтроки = "13" Тогда
								СтруктураДанныхПриложение10.R0202GA = СтруктураДанныхПриложение10.R0202GA + РезультатВидПродукции.Сумма;
							Иначе	
								СтруктураДанныхПриложение9["R0"+НомерСтроки+"G4"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G4"] + РезультатВидПродукции.Сумма;
							КонецЕСли;
						ИначеЕсли РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.Другое Тогда
							Если НомерСтроки = "13" Тогда
								СтруктураДанныхПриложение10.R0302GA = СтруктураДанныхПриложение10.R0302GA + РезультатВидПродукции.Сумма;	
							Иначе
								СтруктураДанныхПриложение9["R0"+НомерСтроки+"G5"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G5"] + РезультатВидПродукции.Сумма;
							КонецЕСли;
						КонецЕсли;
					КонецЕСли;
				ИначеЕсли РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОПоСтавке20 ИЛИ
					РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОПоСтавке20ПоставкаОФ Тогда
					Если РезультатВидПродукции.ЭтоУсловнаяПродажа = Истина Тогда
					Иначе
						Если РезультатВидПродукции.СтавкаНДС = Перечисления.СтавкиНДС.НДС20 ИЛИ РезультатВидПродукции.СтавкаНДС = Перечисления.СтавкиНДС.СпецСт8 Тогда
							Если РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.ЗерновыеТехнические ИЛИ РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.ПустаяСсылка() ТОгда
								Если НомерСтроки = "13" Тогда
									СтруктураДанныхПриложение10.R0101GA = СтруктураДанныхПриложение10.R0101GA + РезультатВидПродукции.Сумма;	
									СтруктураДанныхПриложение10.R0101GB = СтруктураДанныхПриложение10.R0101GB + РезультатВидПродукции.СуммаНДС;	
								Иначе
									СтруктураДанныхПриложение9["R0"+НомерСтроки+"G3"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G3"] + РезультатВидПродукции.Сумма;
								КонецЕСли;
							ИначеЕсли РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.Животноводство ТОгда
								Если НомерСтроки = "13" Тогда
									СтруктураДанныхПриложение10.R0201GA = СтруктураДанныхПриложение10.R0201GA + РезультатВидПродукции.Сумма;	
									СтруктураДанныхПриложение10.R0201GB = СтруктураДанныхПриложение10.R0201GB + РезультатВидПродукции.СуммаНДС;	
								Иначе
									СтруктураДанныхПриложение9["R0"+НомерСтроки+"G4"] =СтруктураДанныхПриложение9["R0"+НомерСтроки+"G4"] + РезультатВидПродукции.Сумма;
								КонецЕСли;
							ИначеЕсли РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.Другое ТОгда
								Если НомерСтроки = "13" Тогда
									СтруктураДанныхПриложение10.R0301GA = СтруктураДанныхПриложение10.R0301GA + РезультатВидПродукции.Сумма;	
									СтруктураДанныхПриложение10.R0301GB = СтруктураДанныхПриложение10.R0301GB + РезультатВидПродукции.СуммаНДС;	
								Иначе
									СтруктураДанныхПриложение9["R0"+НомерСтроки+"G5"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G5"] + РезультатВидПродукции.Сумма;
								КонецЕСли;
							КонецЕсли;
						КонецЕСли;
					КонецЕсли;
				ИначеЕсли 	РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства =СтрокиДекларацииНДС.НДС_НОИзменениеСтоимости или
					РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства =СтрокиДекларацииНДС.НДС_НОКорректировкаТрансфЦенообразование ТОГДА
					Если РезультатВидПродукции.ЭтоУсловнаяПродажа = Истина ТОГДА
					Иначе
						Если РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.ЗерновыеТехнические ИЛИ РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.ПустаяСсылка() ТОгда
							Если НомерСтроки = "13" Тогда
								СтруктураДанныхПриложение10.R0103GA = СтруктураДанныхПриложение10.R0103GA + РезультатВидПродукции.Сумма;	
								СтруктураДанныхПриложение10.R0103GB = СтруктураДанныхПриложение10.R0103GB + РезультатВидПродукции.СуммаНДС;
							Иначе
								СтруктураДанныхПриложение9["R0"+НомерСтроки+"G3"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G3"] + РезультатВидПродукции.Сумма;
							КонецЕСли;
						ИначеЕсли РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.Животноводство ТОгда
							Если НомерСтроки = "13" Тогда
								СтруктураДанныхПриложение10.R0203GA = СтруктураДанныхПриложение10.R0203GA + РезультатВидПродукции.Сумма;	
								СтруктураДанныхПриложение10.R0203GB = СтруктураДанныхПриложение10.R0203GB + РезультатВидПродукции.СуммаНДС;
							Иначе
								СтруктураДанныхПриложение9["R0"+НомерСтроки+"G4"] =СтруктураДанныхПриложение9["R0"+НомерСтроки+"G4"] + РезультатВидПродукции.Сумма;
							КонецЕсли;
						ИначеЕсли РезультатВидПродукции.НоменклатураИНАГРО_ВидПродукции = Перечисления.ИНАГРО_ВидыСХПродукции.Другое ТОгда
							Если НомерСтроки = "13" Тогда
								СтруктураДанныхПриложение10.R0303GA = СтруктураДанныхПриложение10.R0303GA + РезультатВидПродукции.Сумма;	
								СтруктураДанныхПриложение10.R0303GB = СтруктураДанныхПриложение10.R0303GB + РезультатВидПродукции.СуммаНДС;	
							Иначе
								СтруктураДанныхПриложение9["R0"+НомерСтроки+"G5"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G5"] +РезультатВидПродукции.Сумма;
							КонецЕсли;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли;
			ИначеЕсли РезультатВидПродукции.СпецРежимНалогообложения = 0 Тогда
				Если РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОПоСтавке0Другие  
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОНеОбъектНалог
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОУслугиВнеУкраины
					ИЛИ	РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НООсвобожден          
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОПоСтавке0Экспорт
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОПоСтавке20 
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОПоСтавке20ПоставкаОФ
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОИзменениеСтоимости 
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОКорректировкаТрансфЦенообразование
					ИЛИ РезультатВидПродукции.СтатьяДекларацииНДСНалоговыеОбязательства = СтрокиДекларацииНДС.НДС_НОКорректировкаНецелевоеИсп Тогда
					Если НЕ РезультатВидПродукции.ЭтоУсловнаяПродажа = Истина И НомерСтроки <> "13" ТОГДА
						СтруктураДанныхПриложение9["R0"+НомерСтроки+"G7"] = СтруктураДанныхПриложение9["R0"+НомерСтроки+"G7"] + РезультатВидПродукции.Сумма;
					КонецЕСли;
				КонецЕСли;
			КонецЕсли;
			
			
		КонецЦикла;
	КонецЦикла;
КонецПроцедуры

//ИНАГРО ++
&НаСервере                                                 
Процедура РасчетПоСтатьеПриложение10(СтатьяПоискаИлиМассив,ПоказательГрафыАТаб1, ПоказательГрафыАТаб2, ПоказательГрафыАТаб3 ,ПоказательГрафыБТаб1, ПоказательГрафыБТаб2, ПоказательГрафыБТаб3,ИмяПоказателяГрафыАТаб1="",ИмяПоказателяГрафыАТаб2="",ИмяПоказателяГрафыАТаб3="", ИмяПоказателяГрафыБТаб1="", ИмяПоказателяГрафыБТаб2="",ИмяПоказателяГрафыБТаб3="",ПрПоляПоиска,ДопСтруктураПоиска = Неопределено)
	
	Перем НайденнаяСтрока;
	Перем БазаНДСОборот, НДСОборот;
	Перем БазаНДСОборотТаб1, НДСОборотТаб1;
	Перем БазаНДСОборотТаб2, НДСОборотТаб2;
	Перем БазаНДСОборотТаб3, НДСОборотТаб3;
	
	Если  ТипЗнч(СтатьяПоискаИлиМассив) = Тип("Массив") Тогда	
		МассивСтатей = СтатьяПоискаИлиМассив; 	
	Иначе	
		МассивСтатей = Новый Массив;
		МассивСтатей.Добавить(СтатьяПоискаИлиМассив);
	КонецЕсли;
	
		
	БазаНДСОборот = 0;
	НДСОборот = 0;
	
	БазаНДСОборотТаб1 = 0;
	НДСОборотТаб1 = 0;
	
	БазаНДСОборотТаб2 = 0;
	НДСОборотТаб2 = 0;
	
	БазаНДСОборотТаб3 = 0;
	НДСОборотТаб3 = 0;
	
	Для каждого СтатьяПоиска Из МассивСтатей Цикл
		
		СтруктураПоиска = Новый Структура(?(ПрПоляПоиска = 1, ИмяКолонкиНО, ИмяКолонкиНК), СтатьяПоиска);
		Если ТипЗнч(ДопСтруктураПоиска) = Тип("Структура") Тогда
			Для каждого ЭлементДопСтруктуры Из ДопСтруктураПоиска Цикл
				СтруктураПоиска.Вставить(ЭлементДопСтруктуры.Ключ, ЭлементДопСтруктуры.Значение);
			КонецЦикла;
		КонецЕсли;
		
		НайденныеСтроки = ТаблицаРезультатов.НайтиСтроки(СтруктураПоиска);
		
		Для каждого Строка Из НайденныеСтроки Цикл
			
			Если (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 1 Тогда
				БазаНДСОборотТаб1 = БазаНДСОборотТаб1 +  строка.БазаНДСОборот;
		   		НДСОборотТаб1 	 = НДСОборотТаб1 	 + Строка.НДСОборот;
			ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 2 Тогда
				БазаНДСОборотТаб2 = БазаНДСОборотТаб2 +  строка.БазаНДСОборот;
		   		НДСОборотТаб2 	 = НДСОборотТаб2 	 + Строка.НДСОборот;
			ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 3 Тогда
				БазаНДСОборотТаб3 = БазаНДСОборотТаб3 +  строка.БазаНДСОборот;
		   		НДСОборотТаб3 	 = НДСОборотТаб3 	 + Строка.НДСОборот;
				
			//Сумму НДС необходимо распределить по 3-м таблицам согласно коэффициентам
			ИначеЕсли (Строка.Регистратор.СпецРежимНалогообложения = 2 ИЛИ Строка.Регистратор.СпецРежимНалогообложения = 3) И Строка.Регистратор.ИНАГРО_НаправлениеОперации = 0 Тогда
				ОсталосьРаспределитьБазаНДСОборот = Строка.БазаНДСОборот;
				ОсталосьРаспределитьНДСОборот = Строка.НДСОборот;
				ОсталосьРаспределитьПроцентов = 100;
				//Таблица 1
				ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К1;
				Если ОсталосьРаспределитьПроцентов <=0 Тогда
					БазаНДСОборотТаб1 = БазаНДСОборотТаб1 + ОсталосьРаспределитьБазаНДСОборот;
					НДСОборотТаб1 = НДСОборотТаб1 + ОсталосьРаспределитьНДСОборот;
					ОсталосьРаспределитьБазаНДСОборот = 0;
					ОсталосьРаспределитьНДСОборот = 0;
				Иначе
					БазаНДСОборотТаб1 = БазаНДСОборотТаб1 + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
					НДСОборотТаб1 = НДСОборотТаб1 + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
					ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
					ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К1 / 100,2);
				КонецЕсли;
				//Таблица 2
				ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К2;
				Если ОсталосьРаспределитьПроцентов <=0 Тогда
					БазаНДСОборотТаб2 = БазаНДСОборотТаб2 + ОсталосьРаспределитьБазаНДСОборот;
					НДСОборотТаб2 = НДСОборотТаб2 + ОсталосьРаспределитьНДСОборот;
					ОсталосьРаспределитьБазаНДСОборот = 0;
					ОсталосьРаспределитьНДСОборот = 0;
				Иначе
					БазаНДСОборотТаб2 = БазаНДСОборотТаб2 + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
					НДСОборотТаб2 = НДСОборотТаб2 + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
					ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
					ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К2 / 100,2);
				КонецЕсли;
				//Таблица 3
				ОсталосьРаспределитьПроцентов = ОсталосьРаспределитьПроцентов - СтруктураРеквизитовФормы.К3;
				Если ОсталосьРаспределитьПроцентов <=0 Тогда
					БазаНДСОборотТаб3 = БазаНДСОборотТаб3 + ОсталосьРаспределитьБазаНДСОборот;
					НДСОборотТаб3 = НДСОборотТаб3 + ОсталосьРаспределитьНДСОборот;
					ОсталосьРаспределитьБазаНДСОборот = 0;
					ОсталосьРаспределитьНДСОборот = 0;
				Иначе
					БазаНДСОборотТаб3 = БазаНДСОборотТаб3 + Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
					НДСОборотТаб3 = НДСОборотТаб3 + Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
					ОсталосьРаспределитьБазаНДСОборот = ОсталосьРаспределитьБазаНДСОборот - Окр(Строка.БазаНДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);
					ОсталосьРаспределитьНДСОборот = ОсталосьРаспределитьНДСОборот - Окр(Строка.НДСОборот * СтруктураРеквизитовФормы.К3 / 100,2);				
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
	
	КонецЦикла;
	
	Если СтрДлина (ИмяПоказателяГрафыАТаб1) > 0 Тогда
		ПоказательГрафыАТаб1 = ПоказательГрафыАТаб1 + БазаНДСОборотТаб1;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыАТаб2) > 0 Тогда
		ПоказательГрафыАТаб2 = ПоказательГрафыАТаб2 + БазаНДСОборотТаб2;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыАТаб3) > 0 Тогда
		ПоказательГрафыАТаб3 = ПоказательГрафыАТаб3 + БазаНДСОборотТаб3;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыБТаб1) > 0 Тогда
		ПоказательГрафыБТаб1 = ПоказательГрафыБТаб1 + НДСОборотТаб1;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыБТаб2) > 0 Тогда
		ПоказательГрафыБТаб2 = ПоказательГрафыБТаб2 + НДСОборотТаб2;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыБТаб3) > 0 Тогда
		ПоказательГрафыБТаб3 = ПоказательГрафыБТаб3 + НДСОборотТаб3;
	КонецЕсли;
	
	Если СтрДлина (ИмяПоказателяГрафыАТаб1) > 0 Тогда
		СтруктураДанныхПриложение10[ИмяПоказателяГрафыАТаб1] = ПоказательГрафыАТаб1;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыАТаб2) > 0 Тогда
		СтруктураДанныхПриложение10[ИмяПоказателяГрафыАТаб2] = ПоказательГрафыАТаб2;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыАТаб3) > 0 Тогда
		СтруктураДанныхПриложение10[ИмяПоказателяГрафыАТаб3] = ПоказательГрафыАТаб3;
	КонецЕсли;
	Если СтрДлина (ИмяПоказателяГрафыБТаб1) > 0 Тогда
		СтруктураДанныхПриложение10[ИмяПоказателяГрафыБТаб1] = ПоказательГрафыБТаб1;
	КонецЕсли;	
	Если СтрДлина (ИмяПоказателяГрафыБТаб2) > 0 Тогда
		СтруктураДанныхПриложение10[ИмяПоказателяГрафыБТаб2] = ПоказательГрафыБТаб2;
	КонецЕсли;	
	Если СтрДлина (ИмяПоказателяГрафыБТаб3) > 0 Тогда
		СтруктураДанныхПриложение10[ИмяПоказателяГрафыБТаб3] = ПоказательГрафыБТаб3;
	КонецЕсли;	
	
КонецПроцедуры

//&НаСервере
//Процедура ЗаполнитьНастраиваемыеПараметрыЗаполнения()
//	
//	ЗапросДеклПрошл = Новый Запрос ("
//	|ВЫБРАТЬ ПЕРВЫЕ 1
//	| РегламентированныйОтчет.ДанныеОтчета,
//	| РегламентированныйОтчет.Ссылка
//	|ИЗ
//	|	Документ.РегламентированныйОтчет КАК РегламентированныйОтчет
//	|
//	|ГДЕ
//	|	НЕ РегламентированныйОтчет.ПометкаУдаления И
//	|	РегламентированныйОтчет.Организация = &Организация И
//	|	РегламентированныйОтчет.ИсточникОтчета = &ИсточникОтчета И
//	|	РегламентированныйОтчет.ДатаОкончания <= &ДатаОкончания
//	|УПОРЯДОЧИТЬ ПО ДатаОкончания УБЫВ"
//	);
//	
//	ЗапросДеклПрошл.УстановитьПараметр ("ПометкаУдаления",ЛОЖЬ);
//	ЗапросДеклПрошл.УстановитьПараметр ("ДатаОкончания",СтруктураРеквизитовФормы.мДатаКонцаПериодаОтчета);
//	ЗапросДеклПрошл.УстановитьПараметр ("Организация",	СтруктураРеквизитовФормы.Организация);
//	ЗапросДеклПрошл.УстановитьПараметр ("ИсточникОтчета","РегламентированныйОтчетЕдиныйСоциальныйВзнос");						   
//	
//	Выборка = ЗапросДеклПрошл.Выполнить().Выбрать();
//	Если Выборка.Следующий() Тогда
//		
//		ДанныеОтчета = Выборка.ДанныеОтчета.Получить();
//		
//		ТекДанные = Неопределено;
//		ДанныеОтчета.Свойство("ТаблицаВРБольничныеПредприятие", ТекДанные);
//		Если НЕ ТекДанные = Неопределено Тогда
//			СтруктураРеквизитовФормы.ТаблицаВРБольничныеПредприятие = ТекДанные.Получить();
//		КонецЕсли;
//		
//		Если ДанныеОтчета.Свойство("СозданКакХранилищеПараметровДляЗвит1С") Тогда
//			// чтобы не плодить отчеты при повторном заполнении из Звита
//			// будем записывать параметры в один и тот же отчет
//			СтруктураРеквизитовФормы.Вставить("ХранилищеПараметровДляЗвит1С", Выборка.Ссылка);
//		КонецЕсли;
//		
//	КонецЕсли;
//	
//КонецПроцедуры
